define("router",[],function(){var e="gotoHome",t="gotoLogin",n="gotoRole",r="gotoStudent",i="gotoTeacher",s="gotoSign",o=Backbone.Router.extend({routes:{"":"gotoSign",role:"gotoRole",student:"gotoStudent",teacher:"gotoTeacher"},initialize:function(){},gotoHome:function(){this.trigger(e)},gotoSign:function(){this.trigger(s)},gotoRole:function(){this.trigger(n)},gotoStudent:function(){this.trigger(r)},gotoTeacher:function(){this.trigger(i)}});return o}),define("moduleManager",[],function(){var e={_modules:[],add:function(e){return this._modules.push(e),e},clear:function(){$.each(this._modules,function(e,t){try{t.reset()}catch(n){}})}};return _.extend(e,Backbone.Events),e}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!root-tpl/main.tpl",[],function(){return'<div class="g-header">\r\n	<div class="ui-content">\r\n		<div class="">\r\n			<div class="logo-youyang">\r\n				<img src="images/logo-login.png" class="youyang-img" >\r\n			</div>\r\n			<div class="logo">\r\n				<img src="images/english_log.png" class="logo-img" >\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>\r\n\r\n<div class="ui-banner">\r\n    <ul>\r\n    	<li><div class="banner banner1"></div></li>\r\n    	<li><div class="banner banner2"></div></li>\r\n    </ul>\r\n</div>\r\n\r\n<div class="p-index">\r\n	<ul class="p-container">\r\n		<li>\r\n			<span class="num">1</span>\r\n			<span class="empt">&emsp;</span>注册<span class="empt">&emsp;</span>\r\n		</li>\r\n		<li>\r\n			<span class="empt">-&emsp;</span>\r\n			<span class="num">2</span>\r\n			<span class="empt">&emsp;</span>登录<span class="empt">&emsp;</span>\r\n		</li>\r\n		<li>\r\n			<span class="empt">-&emsp;</span>\r\n			<span class="num">3</span>\r\n			<span class="empt">&emsp;</span>绑定身份<span class="empt">&emsp;</span>\r\n		</li>\r\n		<li>\r\n			<span class="empt">-&emsp;</span>\r\n			<span class="num">4</span>\r\n			<span class="empt">&emsp;</span>进入有氧英语写作系统\r\n		</li>\r\n	</ul>\r\n</div>'}),define("root-common/module/slider",[],function(){$.Unslider=function(e,t){var n=this;return n._="unslider",n.defaults={autoplay:!1,delay:3e3,speed:750,easing:"swing",keys:{prev:37,next:39},nav:!0,arrows:{prev:'<a class="'+n._+'-arrow prev">Prev</a>',next:'<a class="'+n._+'-arrow next">Next</a>'},animation:"horizontal",selectors:{container:"ul:first",slides:"li"},animateHeight:!1,activeClass:n._+"-active",swipe:!0},n.$context=e,n.options={},n.$parent=null,n.$container=null,n.$slides=null,n.$nav=null,n.$arrows=[],n.total=0,n.current=0,n.prefix=n._+"-",n.eventSuffix="."+n.prefix+~~(Math.random()*2e3),n.interval=null,n.init=function(e){return n.options=$.extend({},n.defaults,e),n.$container=n.$context.find(n.options.selectors.container).addClass(n.prefix+"wrap"),n.$slides=n.$container.children(n.options.selectors.slides),n.setup(),$.each(["nav","arrows","keys","infinite"],function(e,t){n.options[t]&&n["init"+$._ucfirst(t)]()}),jQuery.event.special.swipe&&n.options.swipe&&n.initSwipe(),n.options.autoplay&&n.start(),n.calculateSlides(),n.$context.trigger(n._+".ready"),n.animate(n.options.index||n.current,"init")},n.setup=function(){n.$context.addClass(n.prefix+n.options.animation).wrap('<div class="'+n._+'" />'),n.$parent=n.$context.parent("."+n._);var e=n.$context.css("position");e==="static"&&n.$context.css("position","relative"),n.$context.css("overflow","hidden")},n.calculateSlides=function(){n.total=n.$slides.length;if(n.options.animation!=="fade"){var e="width";n.options.animation==="vertical"&&(e="height"),n.$container.css(e,n.total*100+"%").addClass(n.prefix+"carousel"),n.$slides.css(e,100/n.total+"%")}},n.start=function(){return n.interval=setTimeout(function(){n.next()},n.options.delay),n},n.stop=function(){return clearTimeout(n.interval),n},n.initNav=function(){var e=$('<div class="'+n.prefix+'nav"><ol /></div>');n.$slides.each(function(t){var r=this.getAttribute("data-nav")||t+1;$.isFunction(n.options.nav)&&(r=n.options.nav.call(n.$slides.eq(t),t,r)),e.children("ol").append('<li data-slide="'+t+'">'+r+"</li>")}),n.$nav=e.insertAfter(n.$context),n.$nav.find("li").on("click"+n.eventSuffix,function(){var e=$(this).addClass(n.options.activeClass);e.siblings().removeClass(n.options.activeClass),n.animate(e.attr("data-slide"))})},n.initArrows=function(){n.options.arrows===!0&&(n.options.arrows=n.defaults.arrows),$.each(n.options.arrows,function(e,t){n.$arrows.push($(t).insertAfter(n.$context).on("click"+n.eventSuffix,n[e]))})},n.initKeys=function(){n.options.keys===!0&&(n.options.keys=n.defaults.keys),$(document).on("keyup"+n.eventSuffix,function(e){$.each(n.options.keys,function(t,r){e.which===r&&$.isFunction(n[t])&&n[t].call(n)})})},n.initSwipe=function(){var e=n.$slides.width();n.options.animation!=="fade"&&n.$container.on({movestart:function(e){if(e.distX>e.distY&&e.distX<-e.distY||e.distX<e.distY&&e.distX>-e.distY)return!!e.preventDefault();n.$container.css("position","relative")},move:function(t){n.$container.css("left",-(100*n.current)+100*t.distX/e+"%")},moveend:function(t){Math.abs(t.distX)/e<$.event.special.swipe.settings.threshold&&n[t.distX<0?"next":"prev"]()}})},n.initInfinite=function(){var e=["first","last"];$.each(e,function(t,r){n.$slides.push.apply(n.$slides,n.$slides.filter(':not(".'+n._+'-clone")')[r]().clone().addClass(n._+"-clone")["insert"+(t===0?"After":"Before")](n.$slides[e[~~!t]]()))})},n.destroyArrows=function(){$.each(n.$arrows,function(e,t){t.remove()})},n.destroySwipe=function(){n.$container.off("movestart move moveend")},n.destroyKeys=function(){$(document).off("keyup"+n.eventSuffix)},n.setIndex=function(e){return e<0&&(e=n.total-1),n.current=Math.min(Math.max(0,e),n.total-1),n.options.nav&&n.$nav.find('[data-slide="'+n.current+'"]')._active(n.options.activeClass),n.$slides.eq(n.current)._active(n.options.activeClass),n},n.animate=function(e,t){e==="first"&&(e=0),e==="last"&&(e=n.total);if(isNaN(e))return n;n.options.autoplay&&n.stop().start(),n.setIndex(e),n.$context.trigger(n._+".change",[e,n.$slides.eq(e)]);var r="animate"+$._ucfirst(n.options.animation);return $.isFunction(n[r])&&n[r](n.current,t),n},n.next=function(){var e=n.current+1;return e>=n.total&&(e=0),n.animate(e,"next")},n.prev=function(){return n.animate(n.current-1,"prev")},n.animateHorizontal=function(e){var t="left";return n.$context.attr("dir")==="rtl"&&(t="right"),n.options.infinite&&n.$container.css("margin-"+t,"-100%"),n.slide(t,e)},n.animateVertical=function(e){return n.options.animateHeight=!0,n.options.infinite&&n.$container.css("margin-top",-n.$slides.outerHeight()),n.slide("top",e)},n.slide=function(e,t){n.options.animateHeight&&n._move(n.$context,{height:n.$slides.eq(t).outerHeight()},!1);if(n.options.infinite){var r;t===n.total-1&&(r=n.total-3,t=-1),t===n.total-2&&(r=0,t=n.total-2),typeof r=="number"&&(n.setIndex(r),n.$context.on(n._+".moved",function(){n.current===r&&n.$container.css(e,-(100*r)+"%").off(n._+".moved")}))}var i={};return i[e]=-(100*t)+"%",n._move(n.$container,i)},n.animateFade=function(e){var t=n.$slides.eq(e).addClass(n.options.activeClass);n._move(t.siblings().removeClass(n.options.activeClass),{opacity:0}),n._move(t,{opacity:1},!1)},n._move=function(e,t,r,i){return r!==!1&&(r=function(){n.$context.trigger(n._+".moved")}),e._move(t,i||n.options.speed,n.options.easing,r)},n.init(t)},$.fn._active=function(e){return this.addClass(e).siblings().removeClass(e)},$._ucfirst=function(e){return(e+"").toLowerCase().replace(/^./,function(e){return e.toUpperCase()})},$.fn._move=function(){return this.stop(!0,!0),$.fn[$.fn.velocity?"velocity":"animate"].apply(this,arguments)},$.fn.unslider=function(e){return this.each(function(){var t=$(this);if(typeof e=="string"&&t.data("unslider")){e=e.split(":");var n=t.data("unslider")[e[0]];if($.isFunction(n))return n.apply(t,e[1]?e[1].split(","):null)}return t.data("unslider",new $.Unslider(t,e))})}}),define("index",["text!root-tpl/main.tpl","root-common/module/slider"],function(e){var t=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e)},events:{},init:function(){var e=this;e.render()},render:function(){var e=this;e.$el.html(e._tpl({})),e.go(1),$(".ui-banner").unslider({autoplay:!0,delay:5e3})},go:function(e){$(".p-index .choce").removeClass("choce"),$(".p-index li").eq(e).addClass("choce")}});return t}),define("text!root-tpl/sign.tpl",[],function(){return'<div class="pop-sign">\r\n	<ul class="nav-sign">\r\n		<li class="nav-item">账号登录</li>\r\n		<li class="nav-item">账号注册</li>\r\n	</ul>\r\n	<div class="panel-sign">\r\n		<div class="panel-item panel-signin"></div>\r\n		<div class="panel-item panel-signup"></div>\r\n	</div>\r\n</div>'}),define("text!root-tpl/signin.tpl",[],function(){return'<div class="ui-signin">\r\n	<form class="form signin-form" action="">\r\n		<div class="form-control clearfix">\r\n	        <label class="label" for="loginName">用户账号</label>\r\n	        <input type="text" class="form-input" name="loginName" id="loginName" placeholder="请输入账号" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="pw">登录密码</label>\r\n	        <input type="password" class="form-input input-pw" name="pw" id="pw" placeholder="请输入密码" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	       <input class="btn btn-confirm" type="submit" value="登&nbsp;&nbsp;&nbsp;&nbsp;录" />\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	       <a href="/LoginAction.action?method=findPwd" class="forget-pw">忘记密码？</a>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	       <a class="btn btn-default btn-go-signup" href="javascript:;">还没账号，马上注册</a>\r\n	    </div>\r\n	</form>\r\n</div>'}),define("text!root-tpl/signup.tpl",[],function(){return'<div class="ui-signup">\r\n	<form class="form signup-form" action="">\r\n		<div class="form-control clearfix">\r\n	        <label class="label" for="loginName">创建用户</label>\r\n	        <input type="text" class="form-input" name="loginName" id="loginName" placeholder="请输入账号" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="pw">输入密码</label>\r\n	        <input type="password" class="form-input input-pw" name="pw" id="pw" placeholder="请输入密码" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="cpw">确认密码</label>\r\n	        <input type="password" class="form-input" name="cpw" id="cpw" placeholder="确认密码" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="inputCode">验证码</label>\r\n	        <input type="text" class="form-input form-input-code" name="inputCode" id="inputCode" />\r\n	        <img src="" class="validate-code" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	       <input class="btn btn-confirm" type="submit" value="确&nbsp;&nbsp;&nbsp;&nbsp;认" />\r\n	    </div>\r\n	</form>\r\n</div>'}),define("text!root-common/module/popup.tpl",[],function(){return'<div class="ui-pop\r\n{{ if(it.className){ }} {{=it.className}}{{ } }}\r\n{{ if(it.tip){ }} ui-pop-tip{{ } }}\r\n" id="ui-pop-{{=it.id}}" name="{{=it.name}}" style="z-index:{{=it.zIndex}}">\r\n    <div class="ui-popbox">\r\n        <div class="ui-popwrap">\r\n            {{ if(it.tip){ }}\r\n            <a class="ui-popclose ui-popaction" href="javascript:;"></a>\r\n            {{ }else{ }}\r\n                {{ if(it.hasHd){ }}\r\n                <div class="ui-pophd\r\n                {{ if(!it.isMove){ }}\r\n                nomove\r\n                {{ } }}\r\n                ">\r\n                    <span class="ui-poptitle"></span>\r\n                    <a class="ui-popclose ui-popaction" href="javascript:;"></a>\r\n                    {{ if(it.isMax){ }}\r\n                    <a class="ui-popmax ui-popaction" href="javascript:;"></a>\r\n                    <a class="ui-popdefault ui-popaction" href="javascript:;"></a>\r\n                    {{ } }}\r\n                </div>\r\n                {{ } }}\r\n            {{ } }}\r\n            \r\n            <div class="ui-popmain"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("root-common/module/popup",["text!./popup.tpl"],function(e,t,n){var r="close",i=/msie 6/i.test(window.navigator.userAgent),s={data:[],zIndex:100,number:0,config:{title:"",custom:null,fade:!1,delay:3e3,ajax:!1,url:"",iframe:null,name:"",isMax:!1,mask:!1,tip:!1,className:"",isMove:!0,hasHd:!0,containerBoderWidth:1},close:function(e){var t;if(this.data.length>0){$.each(this.data,function(n,r){r.id===e&&(t=n)});var n=this.data[t];n.container.remove(),n.opts.mask&&n.mask.remove(),this.data.splice(t,1)}return e}},o=Backbone.View.extend({initialize:function(t,n){var r=this;r._tpl=doT.template(e),r.build(t,n)},events:{"click .ui-popclose":"close","click .ui-popmax":"maximize","click .ui-popdefault":"defaultsize","mousedown .ui-pophd":"move"},build:function(e,t){var n=this;this.opts=$.extend({},s.config,e),this.id=t,this.name=this.opts.name,this.container=$(this._tpl({id:this.id,zIndex:++s.zIndex,name:this.name,isMax:this.opts.isMax,tip:this.opts.tip,className:this.opts.className,isMove:this.opts.isMove,hasHd:this.opts.hasHd})).appendTo("body"),this.opts.mask&&(this.mask=$('<div class="ui-mask" id="ui-mask-'+this.id+'"></div>').appendTo("body").css({height:$(document).height()})),this.setElement(this.container),this.iframe=null,this.wrap=$(".ui-popmain",this.container),this.closeBtn=$(".ui-popclose",this.container),this.maxBtn=$(".ui-popmax",this.container),this.defaultBtn=$(".ui-popdefault",this.container),this.iframeMask=$('<div class="ui-iframe-mask" />'),this.wrapMargin=0,this.containerBoderWidth=this.opts.containerBoderWidth,this.opts.hasHd?this.titleHeight=$(".ui-pophd",n.$el).outerHeight():this.titleHeight=0,this.show()},show:function(){var e=this;i&&this.container.css({position:"absolute"}),this.container.find(".ui-poptitle").html(this.opts.title),this._show()},_show:function(){this.opts.fade&&setTimeout($.proxy(this,"close"),this.opts.delay),this.opts.custom&&this.getCustom(),this.opts.ajax&&this.ajax(),this.opts.iframe&&this.getIframe(),this.setDefaultSize(),this.reposition(),this.container.bind("mousedown",$.proxy(this,"addZIndex"))},ajax:function(){var e=this;$.ajax({url:this.opts.url,cache:!1}).done(function(t){e.wrap.html(t),e.setDefaultSize(),e.reposition()}).error(function(){alert("error")})},setDefaultSize:function(){this.defaultWidth=this.wrap.outerWidth()+this.wrapMargin*2,this.defaultHeight=this.wrap.outerHeight()+this.wrapMargin*2},resize:function(){this.wrap.css({width:this.wrap.find(">*").outerWidth()}),this.setDefaultSize(),this.reposition()},getIframe:function(){var e=this;$(".iframe").clone().appendTo(this.wrap),this.iframe=this.wrap.find("iframe"),this.iframe.show().removeClass("iframe").attr("src",this.opts.iframe.url),this.iframe.load($.proxy(this,"iframeOnload"))},getCustom:function(){this.wrap.html(this.opts.custom)},close:function(e){e&&e.preventDefault(),s.close(this.id),this.trigger(r)},reposition:function(){var e=this.defaultHeight+this.containerBoderWidth*2;this.opts.tip||(e+=this.titleHeight),this.container.css({width:this.defaultWidth+this.containerBoderWidth*2,height:e,top:Math.max(($(window).height()-this.defaultHeight-this.titleHeight-this.containerBoderWidth*2)/2,0),left:($(window).width()-this.defaultWidth-this.containerBoderWidth*2)/2})},maximize:function(){this.container.css({top:0,left:0,width:$(window).width(),height:$(window).height()}),this.wrap.css({width:$(window).width()-this.containerBoderWidth*2-this.wrapMargin*2,height:$(window).height()-this.titleHeight-this.containerBoderWidth*2-this.wrapMargin*2}),this.opts.iframe||this.wrap.find(">*").css({width:$(window).width()-this.containerBoderWidth*2-this.wrapMargin*2,height:$(window).height()-this.titleHeight-this.containerBoderWidth*2-this.wrapMargin*2}),this.maxBtn.addClass("ui-popmax-hide"),this.defaultBtn.show()},defaultsize:function(){this.container.css({width:this.defaultWidth+this.containerBoderWidth*2,height:this.defaultHeight+this.titleHeight+this.containerBoderWidth*2}),this.wrap.css({width:this.defaultWidth-this.wrapMargin*2,height:this.defaultHeight-this.wrapMargin*2}),this.opts.iframe||this.wrap.find(">*").css({width:this.defaultWidth-this.wrapMargin*2,height:this.defaultHeight-this.wrapMargin*2}),this.reposition(),this.maxBtn.removeClass("ui-popmax-hide"),this.defaultBtn.hide()},addZIndex:function(e){$(this.container).css("z-index",++s.zIndex)},move:function(e){if(!this.opts.isMove)return;var t=this,n=e.clientY-this.container.position().top,r=e.clientX-this.container.position().left,i=$(window).width()-this.container.outerWidth(),s=$(window).height()-this.container.outerHeight(),o,u;$(document).bind("mousemove",function(e){o=e.clientY-n,u=e.clientX-r,t.container.css({left:Math.min(i,Math.max(0,u)),top:Math.min(s,Math.max(0,o))}),t._showIframeMask()}).bind("mouseup",function(){t._hideIframeMask(),$(this).unbind("mousemove")})},iframeOnload:function(){this.wrap.css({width:this.opts.iframe.width,height:this.opts.iframe.height}),this.iframe.show(),this.iframeMask.appendTo(this.wrap),this.setDefaultSize(),this.reposition(),this.iframeMask.bind("mousedown",$.proxy(this,"_hideIframeMask"))},_hideIframeMask:function(e){this.iframeMask.hide()},_showIframeMask:function(e){this.iframeMask.show()}});return{create:function(e){var t=new o(e,++s.number);return s.data.push(t),t}}}),define("root-common/util",["./module/popup","require","exports"],function(e,t,n){function r(e,t){if(!$.browser.msie)t?window.open(e,t):location.href=e;else{var n=$('<a href="'+e+'" target="'+(t||"_self")+'"> </a>')[0];document.body.appendChild(n),n.click()}}function i(e,t){return t===undefined?t=new Date:$.isNumeric(t)&&(t=new Date(parseInt(t,10))),e.replace(/([YMDhsm])\1*/g,function(e){switch(e.charAt()){case"Y":return f(t.getFullYear(),e);case"M":return f(t.getMonth()+1,e);case"D":return f(t.getDate(),e);case"w":return t.getDay()+1;case"h":return f(t.getHours(),e);case"m":return f(t.getMinutes(),e);case"s":return f(t.getSeconds(),e)}})}function s(e,t,n){$.type(t)=="date"?t=t.getTime():t=parseInt(t);var r=new Date(t),i=r.getHours();return r>432e5&&(i+=Math.floor(r/432e5)),n&&(e=e.replace(/(\w)\1+/g,"$1")),e.replace(/([hms])\1*/g,function(t){switch(t.charAt()){case"h":return f(i-8,t);case"m":var n=(/h+/.test(e)?0:i-8)*60+r.getMinutes();return f(n,t);case"s":return f(r.getSeconds(),t)}})}function u(e,t,n){$.isNumeric(e)&&(e=new Date(parseInt(e,10))),$.isNumeric(t)&&(t=new Date(parseInt(t,10))),e===undefined&&(e=new Date),t===undefined&&(t=new Date),n||(n="YYYY年MM月DD日");var r=new Date(t.toDateString()),s=(+t- +e)/1e3,u=(+t- +r)/1e3;return s<=60?"刚刚":s<=3600?Math.floor(s/60)+"分钟前":s<=u?Math.floor(s/3600)+"小时前":s<=u+o?"昨天":s<=u+o*2?"前天":s<=u+o*25?Math.floor(s/o)+"天前":i(n,e)}function a(e,t){return e<36e5?s("mm分ss秒",e,t):s("hh小时mm分ss秒",e,t)}function f(e,t){return t=t.length,e=e||0,t==1?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function l(e){var t=/[\?\&]([^&]+=[^&#]+)/g,n,r=[],i="",s=window.location.href;while(n=t.exec(s))r.push(n[1]);return e?($.each(r,function(t,n){if(n.indexOf(e)!==-1){var r=n.indexOf("=");return i=n.slice(r+1),!1}}),i):r}function c(t,n){return e.create({title:"提示",custom:'<i class="icon icon-error"></i>'+t,tip:!0,fade:n})}function h(t){return e.create({title:"提示",custom:'<i class="icon icon-success"></i>'+t,tip:!0,fade:!0})}function p(t,n){var r={title:"提示",custom:t,tip:!0,fade:n};return e.create(r)}function d(e,t,n){var t=t||{};try{if($.isEmptyObject(t)){if(n){var r=n.responseText,i="状态："+n.status+"， 异常信息："+n.statusText;if(r)try{r=$.parseJSON(r),i="请求地址："+r.path+"， "+i}catch(s){}c(i)}}else t.resCode=="0000"?e&&e():(e&&e(!0),t&&$.type(t)=="object"&&t[1]=="timeout"?c("网络请求慢，连接超时，请重试",!0):c(t.resMsg,!0))}catch(s){throw"ajax data error:"+s}}function v(e,t,n){var t=t||{};try{t.resCode=="0000"?e&&e():e&&e(!0)}catch(r){throw"ajax data error:"+r}}function m(e,t){var n=[],r={};return $.each(e,function(e,i){var s=t?i[t]:i;r[s]||(n.push(i),r[s]=1)}),n}function g(e,t,n){return e.slice(0,n)+t+e.slice(n)}function y(e,t,n){var r=this,i=$.extend({dataType:"json",success:function(i){r.trigger(t,i,null,e.data,n)},error:function(e,n,i){r.trigger(t,null,e)}},e);$.ajax(i)}function b(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=_utf8_encode(e);while(f<e.length)n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=e.charCodeAt(f++),s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+_keyStr.charAt(s)+_keyStr.charAt(o)+_keyStr.charAt(u)+_keyStr.charAt(a);return t},this.decode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)s=_keyStr.indexOf(e.charAt(f++)),o=_keyStr.indexOf(e.charAt(f++)),u=_keyStr.indexOf(e.charAt(f++)),a=_keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i));return t=_utf8_decode(t),t},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode=function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}}var o=86400;n.openURL=r,n.formatDate=i,n.formatTime=s,n.formatNumber=f,n.formatTime=s,n.formatTimeE=a,n.release=u,n.queryString=l,n.errorTip=c,n.successTip=h,n.tip=p,n.dealAjax=d,n.insertStr=g,n.unique=m,n.request=y,n.mDealAjax=v,n.Base64=b}),define("model",["root-common/util"],function(e){var t="findProvince",n="findRegister",r="findUuid",i="findCity",s="findArea",o="findSchool",u="findGrade",a="findClass",f="bindUser",l="getUserInfo",c="auto.layout",h=Backbone.Model.extend({initialize:function(){},findUuid:function(t){t=$.extend({type:"get",url:window.serviceBase+"/uuid"},t),e.request.call(this,t,r)},findRegister:function(t){t=$.extend({type:"post",url:window.serviceBase+"/register"},t),e.request.call(this,t,n)},findProvince:function(n){n=$.extend({type:"get",url:window.serviceBase+"/city"},n),e.request.call(this,n,t)},findCity:function(t){t=$.extend({type:"get",url:window.serviceBase+"/city"},t),e.request.call(this,t,i)},findArea:function(t){t=$.extend({type:"get",url:window.serviceBase+"/city"},t),e.request.call(this,t,s)},findSchool:function(t){t=$.extend({type:"get",url:window.serviceBase+"/school"},t),e.request.call(this,t,o)},findGrade:function(t){t=$.extend({type:"get",url:window.serviceBase+"/grade"},t),e.request.call(this,t,u)},findClass:function(t){t=$.extend({type:"get",url:window.serviceBase+"/class"},t),e.request.call(this,t,a)},bindUser:function(e,t){var n=this;$.ajax({type:"post",url:window.serviceBase+"/bindUser",headers:{token:t.token},data:e,dataType:"json",success:function(r){n.trigger(f,r,null,e.data,t)},error:function(e,t,r){n.trigger(f,null,e)}})},getUserInfo:function(t,n){var r=this;$.ajax({type:"get",url:window.serviceBase+"/userInfo",headers:{authorization:"Basic "+(new e.Base64).encode(t.username+":"+t.pw)},dataType:"json",success:function(e){r.trigger(l,e,null,t.data,n)},error:function(e,t,n){r.trigger(l,null,e)}})},autoLayout:function(t){t=$.extend({type:"post",url:window.oldServiceBase+"/service/competition/auto/assign"},t),e.request.call(this,t,c)}});return h}),define("root-common/module/tab",[],function(){var e="switch",t={btns:"",panels:"",type:"click",index:0},n="active",r="select",i=Backbone.View.extend({initialize:function(e){var n=this,e=n.config=$.extend({},t,e);n.index=n.config.index,n.$nav=$(e.btns).bind(e.type,$.proxy(n.change,n)),n.$main=$(e.panels),n.init()},init:function(){var e=this;e.show(e.config.index)},_index:function(e){var t=this,n=$(e.target),r=n.closest("li"),i=t.$nav.index(r);return i},change:function(t){t.preventDefault();var n=this,r=n._index(t);n.show(r),n.trigger(e,r)},show:function(e){var t=this,i=t.$nav.eq(e);t.index=e,setTimeout(function(){t.trigger(r,e)},0),t.$nav.removeClass(n),i.addClass(n),t.$main.hide().eq(e).show()},getIndex:function(){return this.index}});return i}),define("root-common/module/cookie",[],function(){return function(e,t,n,r){typeof e=="string"&&(r=n,n=t,t=e,e=window);if(n===undefined)return n=e.document.cookie.match(new RegExp("(?:\\s|^)"+t+"\\=([^;]*)")),n?decodeURIComponent(n[1]):null;r=r||{};var i,s="";r.expires&&(r.expires.constructor==Date?i=r.expires:(i=new Date,i.setTime(i.getTime()+r.expires*24*60*60*1e3)),s="; expires="+i.toGMTString());var o=r.path?"; path="+r.path:"",u=r.domain?"; domain="+r.domain:"",a=r.secure?"; secure":"";e.document.cookie=[t,"=",encodeURIComponent(n),s,o,u,a].join("")}}),define("sign",["text!root-tpl/sign.tpl","text!root-tpl/signin.tpl","text!root-tpl/signup.tpl","./model","root-common/module/popup","root-common/module/tab","root-common/util","root-common/module/cookie"],function(e,t,n,r,i,s,o,u){var a="signin",f="signup",l="after.signin",c='<i class="icon-solid">&#xe901;</i>',h=Backbone.View.extend({initialize:function(){var i=this;i._tpl=doT.template(e),i._signinTpl=doT.template(t),i._signupTpl=doT.template(n),i._model=new r,i._tab=null,i._pop=null,i.uuid="",i._username="",i._model.bind({findRegister:$.proxy(i.findRegister,i),findUuid:$.proxy(i.findUuid,i),getUserInfo:$.proxy(i.getUserInfo,i)}),$(window).resize(function(){i._pop&&i._pop.resize()})},events:{"click .btn-go-signup":"renderSignup"},render:function(){var e=this,t=e._pop=i.create({title:"",custom:e._tpl({}),hasHd:!1,isMove:!1,containerBoderWidth:0,className:"pop-youyang"});e.setElement(t.$el),e._tab=new s({btns:$(".nav-item",e.$el),panels:$(".panel-item",e.$el)}),e._tab.bind({"switch":function(t){t==0&&e.renderSignin(),t==1&&e.renderSignup()}}),e.renderSignin()},renderSignin:function(){var e=this;e._tab.show(0),$(".panel-signin",e.$el).html(e._signinTpl({})),$(".panel-signup",e.$el).html(""),e._pop.resize(),$(".signin-form",e.$el).submit($.proxy(e._validateSignin,e)),e.trigger(a)},renderSignup:function(){var e=this;e._tab.show(1),$(".panel-signup",e.$el).html(e._signupTpl({})),$(".panel-signin",e.$el).html(""),e._pop.resize(),e._model.findUuid(),$(".signup-form",e.$el).submit($.proxy(e._validate,e)).submit(),$(".validate-code").click(function(){$(".validate-code").attr("src",window.serviceBase+"/getSecurityCode?uuid="+e.uuid+"&t="+ +(new Date))}),e.trigger(f)},init:function(e){this.render()},reset:function(){var e=this;e._pop.close(),e._pop=null,e.$el.html("")},_validate:function(e){var t=this,n=this.validate($(e.currentTarget)).form();return e.preventDefault(),n&&t.findRegister(),!1},validate:function(e){var t=this;return e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.parent().find(".form-error"))},rules:{loginName:{required:!0,isUsername:!0,remote:{url:window.serviceBase+"/checkLoginName",data:{loginName:function(){return $("#loginName").val()}},dataType:"json"}},pw:{required:!0,ispw:!0},cpw:{required:!0,isCpw:!0},inputCode:{required:!0,remote:{url:window.serviceBase+"/checkSecurityCode",data:{uuid:function(){return t.uuid},inputCode:function(){return $("#inputCode").val()}},dataType:"json"}}},messages:{loginName:{required:"用户名不能为空",isUsername:'英文字母开头的2~20个小写英文、数字或"_"的组合',remote:"用户已经存在"},pw:{required:"密码不能为空",ispw:'6~20位小写英文、数字或"_"的组合'},cpw:{required:"确认密码不能为空",isCpw:"两次输入不一致"},inputCode:{required:"验证码不能为空",remote:"验证码不正确"}}})},_validateSignin:function(e){var t=this;return e.preventDefault(),t._model.getUserInfo({username:$('input[name="loginName"]',t.$el).val(),pw:$('input[name="pw"]',t.$el).val()}),!1},validateSignin:function(e){var t=this;return e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.parent().find(".form-error"))},rules:{loginName:{required:!0,isUsername:!0},pw:{required:!0,ispw:!0}},messages:{loginName:{required:"用户名不能为空",isUsername:'英文字母开头的2~20个小写英文、数字或"_"的组合'},pw:{required:"密码不能为空",ispw:'6~20位小写英文、数字或"_"的组合'}}})},findRegister:function(e,t,n,r){var i=this,e={loginName:$("#loginName").val(),password:$("#pw").val(),inputCode:$("#inputCode").val(),uuid:i.uuid,agentCode:10002};$.ajax({url:window.serviceBase+"/register?uuid="+i.uuid+"&t="+ +(new Date),type:"post",data:e,success:function(e){o.tip("注册成功，即将为您跳转到登录页",!0),setTimeout(function(){i.renderSignin()},2e3)}})},_findRegister:function(e){this._model.findRegister({data:e})},findUuid:function(e,t,n,r){var i=this;$.ajax({url:window.serviceBase+"/uuid",type:"get",success:function(e){i.uuid=e,$(".validate-code").attr("src",window.serviceBase+"/getSecurityCode?uuid="+i.uuid+"&t="+ +(new Date))}})},getUserInfo:function(e,t,n,r){var i=this;o.dealAjax(function(t){var n=e.data;t||(u("hzw_token",n.token),u("hzw_userid",n.userBasic.id),u("hzw_username",n.userBasic.loginName),i._username=n.userBasic.loginName,n.bindStatus?i.goProduct():(o.tip("登录成功，请绑定角色",!0),window.location.href="#role"),i.trigger(l,i._username))},e,t)},goProduct:function(e){var t=$('<form method="post" action="'+window.oldServiceBase+'/LoginAction.action?method=loginFromLyMis"><input type="hidden" value="'+this._username+'" name="username"></form>').appendTo("body");t.submit()}});return h}),define("text!root-tpl/role.tpl",[],function(){return'<div class="pop-role">\r\n	<div class="role-list fix">\r\n		<a class="role-item role-teacher" href="#teacher" >\r\n			<button class="btn btn-role btn-role-teacher">我是老师</button>\r\n		</a>\r\n		<a class="role-item role-student" href="#student">\r\n			<button class="btn btn-role btn-role-student">我是学生</button>\r\n		</a>\r\n	</div>\r\n</div>'}),define("text!root-tpl/student.tpl",[],function(){return'<div class="pop-student">\r\n	<form class="form student-form" action="">\r\n		<div class="form-control clearfix">\r\n	        <label class="label" for="realname"><i>*</i>真实姓名</label>\r\n	        <input type="text" class="form-input" name="realname" id="realname" placeholder="请填写真实姓名" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="region-area">\r\n	    	\r\n	    </div>\r\n	    \r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="teacher"><i>*</i>教师姓名</label>\r\n	        <input type="text" class="form-input" name="teacher" id="teacher" placeholder="请填写教师姓名" />\r\n	        <div class="form-error"></div>\r\n	        <div class="tip-msg">请填入老师告诉你的名字</div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="telephone"><i>*</i>手机号码</label>\r\n	        <input type="text" class="form-input" name="telephone" id="telephone" placeholder="请填写手机号码" />\r\n	        <div class="form-error"></div>\r\n	        <div class="tip-msg">仅用于找回密码时使用</div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="email">邮箱</label>\r\n	        <input type="text" class="form-input" name="email" id="email" placeholder="请填写邮箱" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	       <input class="btn btn-confirm" type="submit" value="保&nbsp;&nbsp;&nbsp;&nbsp;存" />\r\n	    </div>\r\n	</form>\r\n</div>'}),define("text!root-tpl/teacher.tpl",[],function(){return'<div class="pop-teacher">\r\n	<form class="form teacher-form" action="">\r\n		<div class="form-control clearfix">\r\n	        <label class="label" for="realname"><i>*</i>真实姓名</label>\r\n	        <input type="text" class="form-input" name="realname" id="realname" placeholder="请填写真实姓名" />\r\n	        <div class="form-error"></div>\r\n	        <div class="tip-msg">请将该姓名告知学生，便于学生找到您</div>\r\n	    </div>\r\n	    <div class="region-area">\r\n	    	\r\n	    </div>\r\n	    \r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="code"><i>*</i>学校码</label>\r\n	        <input type="text" class="form-input" name="code" id="code" placeholder="请填写验证码" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="telephone"><i>*</i>手机号码</label>\r\n	        <input type="text" class="form-input" name="telephone" id="telephone" placeholder="请填写手机号码" />\r\n	        <div class="form-error"></div>\r\n	        <div class="tip-msg">仅用于找回密码时使用</div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label">是否班主任？</label>\r\n	        <label class="radio"><input type="radio" name="owner" value="0" />是</label>\r\n	        <label class="radio"><input type="radio" name="owner" value="1" />否</label>\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	        <label class="label" for="email">邮箱</label>\r\n	        <input type="text" class="form-input" name="email" id="email" placeholder="请填写邮箱" />\r\n	        <div class="form-error"></div>\r\n	    </div>\r\n	    <div class="form-control clearfix">\r\n	       <input class="btn btn-confirm" type="submit" value="保&nbsp;&nbsp;&nbsp;&nbsp;存" />\r\n	    </div>\r\n	</form>\r\n</div>'}),define("text!root-tpl/region.tpl",[],function(){return'<div class="form-control clearfix">\r\n    <label class="label" for="province"><i>*</i>省份</label>\r\n    <select class="form-select" name="province" id="province">\r\n    	<option disabled selected>请选择省份</option>\r\n    	{{~it.provinceList :v:i}}\r\n    	<option value="{{=v.code}}" \r\n        {{ if(v.code == it.province){ }}\r\n        selected\r\n        {{ } }}\r\n        >{{=v.name}}</option>\r\n    	{{~}}\r\n    </select>\r\n    <div class="form-error"></div>\r\n</div>\r\n<div class="form-control clearfix">\r\n    <label class="label" for="city"><i>*</i>城市</label>\r\n    <select class="form-select" name="city" id="city">\r\n    	<option disabled selected>请选择城市</option>\r\n        {{~it.cityList :v:i}}\r\n        <option value="{{=v.code}}" \r\n        {{ if(v.code == it.city){ }}\r\n        selected\r\n        {{ } }}\r\n        >{{=v.name}}</option>\r\n        {{~}}\r\n    </select>\r\n    <div class="form-error"></div>\r\n</div>\r\n<div class="form-control clearfix">\r\n    <label class="label" for="area"><i>*</i>区</label>\r\n    <select class="form-select" name="area" id="area">\r\n        <option disabled selected>请选择区</option>\r\n        {{~it.areaList :v:i}}\r\n        <option value="{{=v.code}}" \r\n        {{ if(v.code == it.area){ }}\r\n        selected\r\n        {{ } }}\r\n        >{{=v.name}}</option>\r\n        {{~}}\r\n    </select>\r\n    <div class="form-error"></div>\r\n</div>\r\n<div class="form-control clearfix">\r\n    <label class="label" for="school"><i>*</i>学校</label>\r\n    <select class="form-select" name="school" id="school">\r\n        <option disabled selected>请选择学校</option>\r\n        {{~it.schoolList :v:i}}\r\n        <option value="{{=v.id}}" \r\n        {{ if(v.id == it.school){ }}\r\n        selected\r\n        {{ } }}\r\n        >{{=v.name}}</option>\r\n        {{~}}\r\n    </select>\r\n    <div class="form-error"></div>\r\n    {{ if(!it.isStudent){ }}\r\n    <div class="tip-msg">\r\n        如果找不到学校，请<a href="javascript:;" class="show-school-tip">点击</a>\r\n        <div class="panel-school-tip">\r\n            <i class="icon-solid btn-close">&#xe901;</i>\r\n            各位老师，如果找不到您所在的学校。请\r\n            联系 <i class="highlight">13482268004</i> 穆老师，并将自己的\r\n            学校名称告知穆老师。穆老师会在一个工\r\n            作日内为您增加学校，并反馈到您。\r\n        </div>\r\n    </div>\r\n    {{ } }}\r\n</div>\r\n<div class="form-control clearfix">\r\n    <label class="label" for="grade"><i>*</i>年级</label>\r\n    <select class="form-select" name="grade" id="grade">\r\n        <option disabled selected>请选择年级</option>\r\n        {{~it.gradeList :v:i}}\r\n        <option value="{{=v.code}}" \r\n        {{ if(v.code == it.grade){ }}\r\n        selected\r\n        {{ } }}\r\n        >{{=v.name}}</option>\r\n        {{~}}\r\n    </select>\r\n    <div class="form-error"></div>\r\n</div>\r\n<div class="form-control clearfix">\r\n    <label class="label" for="classroom"><i>*</i>班级</label>\r\n    {{ if(it.isStudent){ }}\r\n    <select class="form-select" name="classroom" id="classroom">\r\n        <option disabled selected>请选择班级</option>\r\n        {{~it.classList :v:i}}\r\n        <option value="{{=v.id}}">{{=v.name}}</option>\r\n        {{~}}\r\n    </select>\r\n    {{ }else{ }}\r\n    <input type="text" name="classroom" value="{{=it.classId ? it.classId : \'\'}}" class="hidden-classroom" /> \r\n    <span class="choose-class">\r\n        {{=it.classroom ? it.classroom : \'请选择班级\'}}\r\n    </span>\r\n    {{ } }}\r\n    \r\n    <div class="form-error"></div>\r\n</div>\r\n'}),define("text!root-tpl/classroom.tpl",[],function(){return'<div class="pop-class">\r\n	<div class="fix">\r\n		{{~it.list :v:i}}\r\n		<span class="item-class {{=it.setClassActive(v.id, it.chosen)}}" data-id="{{=v.id}}">{{=v.name}}</span>\r\n		{{~}}\r\n	</div>\r\n	<div class="fix">\r\n		<a class="btn btn-confirm" href="javascript:;">确认</a>\r\n	</div>\r\n</div>'}),define("role",["text!root-tpl/role.tpl","text!root-tpl/student.tpl","text!root-tpl/teacher.tpl","text!root-tpl/region.tpl","text!root-tpl/classroom.tpl","./model","root-common/module/popup","root-common/util","root-common/module/cookie"],function(e,t,n,r,i,s,o,u,a){var f="role",l=Backbone.View.extend({initialize:function(){var o=this;o._tpl=doT.template(e),o._studentTpl=doT.template(t),o._teacherTpl=doT.template(n),o._regionTpl=doT.template(r),o._classroomTpl=doT.template(i),o._model=new s,o._model.bind({findProvince:$.proxy(o.findProvince,o),findCity:$.proxy(o.findCity,o),findArea:$.proxy(o.findArea,o),findSchool:$.proxy(o.findSchool,o),findGrade:$.proxy(o.findGrade,o),findClass:$.proxy(o.findClass,o),getUserInfo:$.proxy(o.getUserInfo,o),bindUser:$.proxy(o.bindUser,o)}),o._token=a("hzw_token")||null,o._userid=null,o.username="",o._chosenClass=[],o._classPop=null,$(window).resize(function(){o._pop&&o._pop.resize()})},events:{},init:function(){var e=this;e.render()},render:function(){var e=this;e.$el.html(e._tpl({}))},setName:function(e){this.username=e},bindRole:function(e){var t=this;t._pop=o.create({title:"老师or学生?",custom:t._tpl({}),isMove:!1,className:"pop-youyang"}),t.trigger(f),t._pop&&t._pop.resize()},updateStudent:function(){var e=this;e._pop=o.create({title:"我是学生",custom:e._studentTpl({}),isMove:!1,className:"pop-youyang"}),e._isStudent=!0,e._model.findProvince(),e.renderRegion(),e.bindRegion(),$(".form",e._pop.$el).submit($.proxy(e._validate,e)),e.trigger(f)},reset:function(){var e=this;e._pop.close(),e._pop=null,e.$el.html("")},updateTeacher:function(){var e=this,t=e._pop=o.create({title:"我是老师",custom:e._teacherTpl({}),isMove:!1,className:"pop-youyang"});e._isStudent=!1,e._model.findProvince(),e.renderRegion(),e.bindRegion(),$(".form",e._pop.$el).submit($.proxy(e._validate,e)),t.$el.on("click",".choose-class",$.proxy(e._showClass,e)),t.$el.on("click",".show-school-tip",$.proxy(e._showSchoolTip,e)),t.$el.on("click",".panel-school-tip .btn-close",$.proxy(e._hideSchoolTip,e)),e.trigger(f)},bindRegion:function(){var e=this;e._pop.$el.on("change",'select[name="province"]',$.proxy(e._changeProvince,e)),e._pop.$el.on("change",'select[name="city"]',$.proxy(e._changeCity,e)),e._pop.$el.on("change",'select[name="area"]',$.proxy(e._changeArea,e)),e._pop.$el.on("change",'select[name="school"]',$.proxy(e._changeSchool,e)),e._pop.$el.on("change",'select[name="grade"]',$.proxy(e._changeGrade,e))},renderRegion:function(){var e=this;try{e._schoolList.sort(function(e,t){return e.name.localeCompare(t.name)})}catch(t){}$(".region-area",e._pop.$el).html(e._regionTpl({provinceList:e._provinceList,province:e._province,cityList:e._cityList,city:e._city,areaList:e._areaList,area:e._area,schoolList:e._schoolList,school:e._school,gradeList:e._gradeList,grade:e._grade,classList:e._classList,classroom:e._class,classId:e._classId,isStudent:e._isStudent})),e._pop&&e._pop.resize()},findProvince:function(e,t,n,r){var i=this;u.dealAjax(function(t){i._provinceList=e.data.list,i.renderRegion()},e,t)},findCity:function(e,t,n,r){var i=this;u.dealAjax(function(t){i._cityList=e.data.list,i.renderRegion()},e,t)},findArea:function(e,t,n,r){var i=this;u.dealAjax(function(t){i._areaList=e.data.list,i.renderRegion()},e,t)},findSchool:function(e,t,n,r){var i=this;u.dealAjax(function(t){i._schoolList=e.data.list,i.renderRegion()},e,t)},findGrade:function(e,t,n,r){var i=this;u.dealAjax(function(t){i._gradeList=e.data.list,i.renderRegion()},e,t)},findClass:function(e,t,n,r){var i=this;u.dealAjax(function(t){i._classList=e.data.list,i.renderRegion()},e,t)},_resetClass:function(){this._class="",this._classId=""},_changeProvince:function(e){e.preventDefault();var t=this,n=$(e.currentTarget).val();t._province=n,t._cityList=[],t._city="",t._schoolList=[],t._school="",t._gradeList=[],t._grade="",t._classList=[],t._resetClass(),t._chosenClass=[],t._model.findCity({data:{code:n}})},_changeCity:function(e){e.preventDefault();var t=this,n=$(e.currentTarget).val();t._city=n,t._areaList=[],t._area="",t._schoolList=[],t._school="",t._gradeList=[],t._grade="",t._classList=[],t._resetClass(),t._chosenClass=[],t._model.findArea({data:{code:n}})},_changeArea:function(e){e.preventDefault();var t=this,n=$(e.currentTarget).val();t._area=n,t._schoolList=[],t._school="",t._gradeList=[],t._grade="",t._classList=[],t._resetClass(),t._chosenClass=[],t._model.findSchool({data:{cityCode:n}})},_changeSchool:function(e){e.preventDefault();var t=this,n=$(e.currentTarget).val();t._school=n,t._gradeList=[],t._grade="",t._classList=[],t._resetClass(),t._chosenClass=[],t._model.findGrade({data:{schoolId:n}})},_changeGrade:function(e){e.preventDefault();var t=this,n=$(e.currentTarget).val();t._grade=n,t._classList=[],t._resetClass(),t._chosenClass=[],t._model.findClass({data:{schoolId:t._school,grade:n}})},_validate:function(e){var t=this,n=t.validate($(e.currentTarget)).form();t._token=a("hzw_token"),t._userid=a("hzw_userid"),t.setName(a("hzw_username"));if(n){var r=$('input[name="email"]',t._pop.$el).val();if(r&&!/^([\w-]+)@([\w-]+).([\w-]+)$/.test(r))return u.errorTip("邮箱格式不正确"),!1;var i={schoolId:t._school,classId:$('[name="classroom"]',t._pop.$el).val(),realname:$('input[name="realname"]',t._pop.$el).val(),studentOrTeacher:t._isStudent?"student":"teacher",mobile:$('input[name="telephone"]',t._pop.$el).val(),email:r};t._isStudent?i.teacherName=$('input[name="teacher"]',t._pop.$el).val():(i.isMaster=!!parseInt($('input[name="owner"]',t._pop.$el).val()),i.inputCheckClassCode=$('input[name="code"]',t._pop.$el).val()),t._model.bindUser(i,{token:t._token})}return!1},validate:function(e){var t=this;return e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.parent().find(".form-error"))},rules:{province:{required:!0},city:{required:!0},area:{required:!0},school:{required:!0},grade:{required:!0},classroom:{required:!0},realname:{required:!0,maxlength:30},teacher:{required:!0},telephone:{required:!0,isTelephone:!0}},messages:{province:{required:"请选择省份"},city:{required:"请选择城市"},area:{required:"请选择区"},school:{required:"请选择学校"},grade:{required:"请选择年级"},classroom:{required:"请选择班级"},realname:{required:"姓名不能为空",maxlength:"最大不能超过30个字符"},teacher:{required:"教师姓名不能为空"},telephone:{required:"手机不能为空",isTelephone:"手机格式不对"}}})},bindUser:function(e,t,n,r){var i=this;u.dealAjax(function(e){if(!e){var t=i._userid;i._model.autoLayout({data:{user_name:i.username}}),u.tip("正在为您跳转",!0),setTimeout(function(){i.goProduct()},2e3)}},e,t)},goProduct:function(){var e=$('<form method="post" action="'+window.oldServiceBase+'/LoginAction.action?method=loginFromLyMis"><input type="hidden" value="'+this.username+'" name="username"><input type="hidden" value="3" name="source"></form>').appendTo("body");e.submit()},_showClass:function(){var e=this;e._classList&&$.type(e._classList)&&e._classList.length>0?(e._classPop=o.create({title:"选择班级",custom:e._classroomTpl({list:e._classList,chosen:e._chosenClass||[],setClassActive:e._setClassActive}),mask:!0,isMove:!1}),e._classPop.$el.on("click",".item-class",$.proxy(e._selectClass,e)),e._classPop.$el.on("click",".btn-confirm",$.proxy(e._confirmSelect,e))):u.tip("班级为空",!0)},_selectClass:function(e){var t=this;e.preventDefault();var n=$(e.currentTarget).toggleClass("active"),r=n.data("id"),i=n.text(),s;$.each(t._chosenClass,function(e,t){if(t.id==r)return s=e,!1}),s!==undefined?t._chosenClass.splice(s,1):t._chosenClass.push({id:r,name:i})},_confirmSelect:function(e){var t=this;e.preventDefault();var n=t._chosenClass,r="",i=[];$.each(n,function(e,t){r+=" "+t.name,i.push(t.id)}),t._class=r,t._classId=i.join(","),t._classPop.close(),t.renderRegion()},_setClassActive:function(e,t){var n="";return $.each(t,function(t,r){if(r.id==e)return n="active",!1}),n},_showSchoolTip:function(e){e.preventDefault();var t=this;$(".panel-school-tip",t._pop.$el).show()},_hideSchoolTip:function(e){e.preventDefault();var t=this;$(".panel-school-tip",t._pop.$el).hide()}});return l}),define("auto-domain",[],function(){var e="online",t=location.hostname,n="192.168.12.250",r="8088",i="http://",s=/192.168|localhost|debug.|127.0/;s.test(t)&&(e="test");try{e=="test"?(window.serviceBase=i+n+":"+r,window.oldServiceBase=i+n+":8080"):(window.serviceBase=i+t+"/taoshiwanApi/taoshiwan",window.oldServiceBase=i+t)}catch(o){alert("自适应域名脚本执行错误!\n")}}),require(["./router","./moduleManager","./index","./sign","role","./auto-domain"],function(e,t,n,r,i){function s(){var e=$(window).width();if(e>700)var t=28.125;else var t=e*14/320;$("html").css("font-size",t+"px")}function l(){t.clear()}s(),$(window).resize(s),$.validator.addMethod("isCpw",function(e,t,n){var r=$(t).closest("form"),i=$(t).val(),s=$(".input-pw",r).val();return i===s}),$.validator.addMethod("isUsername",function(e,t,n){var r=/^[a-z]{1}[a-z0-9_]{1,19}$/g;return r.test($(t).val())}),$.validator.addMethod("ispw",function(e,t,n){var r=/^[a-z0-9_]{6,20}$/g;return r.test($(t).val())}),$.validator.addMethod("isEmail",function(e,t,n){var r=/^([\w-]+)@([\w-]+).([\w-]+)$/,i=$(t).val();return r.test(i)}),$.validator.addMethod("isTelephone",function(e,t,n){var r=/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,i=$(t).val();return r.test(i)});var o=new e,u=new n({el:"#IndexPage"});u.init();var a=t.add(new r),f=t.add(new i);o.bind({gotoSign:function(){l(),a.init()},gotoRole:function(e){l(),f.bindRole(e)},gotoStudent:function(){l(),f.updateStudent()},gotoTeacher:function(){l(),f.updateTeacher()}}),a.bind({signin:function(){u.go(1)},signup:function(){u.go(0)},"after.signin":function(e){}}),f.bind({role:function(){u.go(2)}}),$("body").click(function(){$(".panel-tip").hide()}),Backbone.history.start()}),define("main",function(){});