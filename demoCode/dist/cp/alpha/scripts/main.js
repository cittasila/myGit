define("router",[],function(){var e="gotoSign",t="gotoPhone",n="gotoProduct",r="gotoReading",i="gotoBookList",s="gotoReadOver",o="gotoInformation",u="gotoPassword",a="gotoFindpw",f="gotoPrivacy",l="gotoTerm",c="gotoSignUp",h="gotoPhoneFind",p="gotoBookNav",d="gotoTestResult",v="gotoExercise",m="gotoGrade",g=Backbone.Router.extend({routes:{"":"gotoSign",phone:"gotoPhone",product:"gotoProduct","reading/:id":"gotoReading",booklist:"gotoBookList","readover/:id":"gotoReadOver",information:"gotoInformation",findpw:"gotoFindpw",privacy:"gotoPrivacy",term:"gotoTerm",signup:"gotoSignUp",phonefind:"gotoPhoneFind","bookNav/:id":"gotoBookNav","testResult/:id/:id":"gotoTestResult","exercise/:id/:id":"gotoExercise",grade:"gotoGrade"},initialize:function(){},gotoSign:function(){this.trigger(e)},gotoPhone:function(){this.trigger(t)},gotoProduct:function(){this.trigger(n)},gotoReading:function(e){this.trigger(r,e)},gotoBookList:function(){this.trigger(i)},gotoReadOver:function(e){this.trigger(s,e)},gotoInformation:function(){this.trigger(o)},gotoFindpw:function(){this.trigger(a)},gotoPrivacy:function(){this.trigger(f)},gotoTerm:function(){this.trigger(l)},gotoSignUp:function(){this.trigger(c)},gotoPhoneFind:function(){this.trigger(h)},gotoBookNav:function(e){this.trigger(p,e)},gotoTestResult:function(e,t){this.trigger(d,e,t)},gotoExercise:function(e,t){this.trigger(v,e,t)},gotoGrade:function(){this.trigger(m)}});return g}),define("module-manager",[],function(){var e={_modules:[],add:function(e){return this._modules.push(e),e},clear:function(){$.each(this._modules,function(e,t){try{t.reset()}catch(n){}})}};return _.extend(e,Backbone.Events),e}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!root-tpl/main.tpl",[],function(){return'<div class="ui-signin default-skin">\n	<div class="ui-image">\n		<div class="ui-bg"></div>\n		<ul class="fix change">\n			<li class="img-btn img-choice"></li>\n			<li class="img-btn"></li>\n		</ul>\n		<form class="form signin-forms" action="">\n			<div class="form-control fix">\n		        <div class="clearfix bshadow0 pbs">\n					<span class="icon-user icon-solid icon">\n	                	&#xe90d;\n	                </span>\n	            </div>\n		        <input type="text" class="form-input" name="loginName" placeholder="请输入账号" />\n		        <!-- <div class="form-error"></div> -->\n		    </div>\n		    <div class="form-control fix">\n		        <div class="clearfix bshadow0 pbs">\n					<span class="icon-lock icon-solid icon">\n	            		&#xe90b;\n	                </span>\n	            </div>\n		        <input type="password" class="form-input input-pw" name="pw" placeholder="请输入密码" />\n		        <!-- <div class="form-error"></div> -->\n		    </div>\n		    <div class="form-control fix"> \n		       	<a href="#findpw">忘记密码?</a>\n		    </div>\n		    <div class="form-control fix"> \n		       <input class="btn btn-confirm" type="submit" value="登&nbsp;&nbsp;&nbsp;&nbsp;录" />\n		    </div>\n		    <div class="form-control term fix"> \n		       点击“登录”，即表示您同意并愿意遵守朗鹰 <a href="#term" target="_blank">用户协议</a> 和 <a href="#privacy" target="_blank">隐私政策</a>。\n		    </div>\n		    <div class="form-control gosign">\n		    	<a href="#signup">立即注册</a>\n		    </div>\n		</form>\n	</div>\n</div>'}),define("text!root-common/module/popup.tpl",[],function(){return'<div class="ui-pop\r\n{{ if(it.className){ }} {{=it.className}}{{ } }}\r\n{{ if(it.tip){ }} ui-pop-tip{{ } }}\r\n" id="ui-pop-{{=it.id}}" name="{{=it.name}}" style="z-index:{{=it.zIndex}}">\r\n    <div class="ui-popbox">\r\n        <div class="ui-popwrap">\r\n            {{ if(it.tip){ }}\r\n            <a class="ui-popclose ui-popaction" href="javascript:;"></a>\r\n            {{ }else{ }}\r\n                {{ if(it.hasHd){ }}\r\n                <div class="ui-pophd\r\n                {{ if(!it.isMove){ }}\r\n                nomove\r\n                {{ } }}\r\n                ">\r\n                    <span class="ui-poptitle"></span>\r\n                    <a class="ui-popclose ui-popaction" href="javascript:;"></a>\r\n                    {{ if(it.isMax){ }}\r\n                    <a class="ui-popmax ui-popaction" href="javascript:;"></a>\r\n                    <a class="ui-popdefault ui-popaction" href="javascript:;"></a>\r\n                    {{ } }}\r\n                </div>\r\n                {{ } }}\r\n            {{ } }}\r\n            \r\n            <div class="ui-popmain"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("root-common/module/popup",["text!./popup.tpl"],function(e,t,n){var r="close",i=/msie 6/i.test(window.navigator.userAgent),s={data:[],zIndex:100,number:0,config:{title:"",custom:null,fade:!1,delay:3e3,ajax:!1,url:"",iframe:null,name:"",isMax:!1,mask:!1,tip:!1,className:"",isMove:!0,hasHd:!0,containerBoderWidth:1},close:function(e){var t;if(this.data.length>0){$.each(this.data,function(n,r){r.id===e&&(t=n)});var n=this.data[t];n.container.remove(),n.opts.mask&&n.mask.remove(),this.data.splice(t,1)}return e}},o=Backbone.View.extend({initialize:function(t,n){var r=this;r._tpl=doT.template(e),r.build(t,n)},events:{"click .ui-popclose":"close","click .ui-popmax":"maximize","click .ui-popdefault":"defaultsize","mousedown .ui-pophd":"move"},build:function(e,t){var n=this;this.opts=$.extend({},s.config,e),this.id=t,this.name=this.opts.name,this.container=$(this._tpl({id:this.id,zIndex:++s.zIndex,name:this.name,isMax:this.opts.isMax,tip:this.opts.tip,className:this.opts.className,isMove:this.opts.isMove,hasHd:this.opts.hasHd})).appendTo("body"),this.opts.mask&&(this.mask=$('<div class="ui-mask" id="ui-mask-'+this.id+'"></div>').appendTo("body").css({height:$(document).height()})),this.setElement(this.container),this.iframe=null,this.wrap=$(".ui-popmain",this.container),this.closeBtn=$(".ui-popclose",this.container),this.maxBtn=$(".ui-popmax",this.container),this.defaultBtn=$(".ui-popdefault",this.container),this.iframeMask=$('<div class="ui-iframe-mask" />'),this.wrapMargin=0,this.containerBoderWidth=this.opts.containerBoderWidth,this.opts.hasHd?this.titleHeight=$(".ui-pophd",n.$el).outerHeight():this.titleHeight=0,this.show()},show:function(){var e=this;i&&this.container.css({position:"absolute"}),this.container.find(".ui-poptitle").html(this.opts.title),this._show()},_show:function(){this.opts.fade&&setTimeout($.proxy(this,"close"),this.opts.delay),this.opts.custom&&this.getCustom(),this.opts.ajax&&this.ajax(),this.opts.iframe&&this.getIframe(),this.setDefaultSize(),this.reposition(),this.container.bind("mousedown",$.proxy(this,"addZIndex"))},ajax:function(){var e=this;$.ajax({url:this.opts.url,cache:!1}).done(function(t){e.wrap.html(t),e.setDefaultSize(),e.reposition()}).error(function(){alert("error")})},setDefaultSize:function(){this.defaultWidth=this.wrap.outerWidth()+this.wrapMargin*2,this.defaultHeight=this.wrap.outerHeight()+this.wrapMargin*2},resize:function(){this.wrap.css({width:this.wrap.find(">*").outerWidth()}),this.setDefaultSize(),this.reposition()},getIframe:function(){var e=this;$(".iframe").clone().appendTo(this.wrap),this.iframe=this.wrap.find("iframe"),this.iframe.show().removeClass("iframe").attr("src",this.opts.iframe.url),this.iframe.load($.proxy(this,"iframeOnload"))},getCustom:function(){this.wrap.html(this.opts.custom)},close:function(e){e&&e.preventDefault(),s.close(this.id),this.trigger(r)},reposition:function(){var e=this.defaultHeight+this.containerBoderWidth*2;this.opts.tip||(e+=this.titleHeight),this.container.css({width:this.defaultWidth+this.containerBoderWidth*2,height:e,top:Math.max(($(window).height()-this.defaultHeight-this.titleHeight-this.containerBoderWidth*2)/2,0),left:($(window).width()-this.defaultWidth-this.containerBoderWidth*2)/2})},maximize:function(){this.container.css({top:0,left:0,width:$(window).width(),height:$(window).height()}),this.wrap.css({width:$(window).width()-this.containerBoderWidth*2-this.wrapMargin*2,height:$(window).height()-this.titleHeight-this.containerBoderWidth*2-this.wrapMargin*2}),this.opts.iframe||this.wrap.find(">*").css({width:$(window).width()-this.containerBoderWidth*2-this.wrapMargin*2,height:$(window).height()-this.titleHeight-this.containerBoderWidth*2-this.wrapMargin*2}),this.maxBtn.addClass("ui-popmax-hide"),this.defaultBtn.show()},defaultsize:function(){this.container.css({width:this.defaultWidth+this.containerBoderWidth*2,height:this.defaultHeight+this.titleHeight+this.containerBoderWidth*2}),this.wrap.css({width:this.defaultWidth-this.wrapMargin*2,height:this.defaultHeight-this.wrapMargin*2}),this.opts.iframe||this.wrap.find(">*").css({width:this.defaultWidth-this.wrapMargin*2,height:this.defaultHeight-this.wrapMargin*2}),this.reposition(),this.maxBtn.removeClass("ui-popmax-hide"),this.defaultBtn.hide()},addZIndex:function(e){$(this.container).css("z-index",++s.zIndex)},move:function(e){if(!this.opts.isMove)return;var t=this,n=e.clientY-this.container.position().top,r=e.clientX-this.container.position().left,i=$(window).width()-this.container.outerWidth(),s=$(window).height()-this.container.outerHeight(),o,u;$(document).bind("mousemove",function(e){o=e.clientY-n,u=e.clientX-r,t.container.css({left:Math.min(i,Math.max(0,u)),top:Math.min(s,Math.max(0,o))}),t._showIframeMask()}).bind("mouseup",function(){t._hideIframeMask(),$(this).unbind("mousemove")})},iframeOnload:function(){this.wrap.css({width:this.opts.iframe.width,height:this.opts.iframe.height}),this.iframe.show(),this.iframeMask.appendTo(this.wrap),this.setDefaultSize(),this.reposition(),this.iframeMask.bind("mousedown",$.proxy(this,"_hideIframeMask"))},_hideIframeMask:function(e){this.iframeMask.hide()},_showIframeMask:function(e){this.iframeMask.show()}});return{create:function(e){var t=new o(e,++s.number);return s.data.push(t),t}}}),define("root-common/util",["./module/popup","require","exports"],function(e,t,n){function r(e,t){if(!$.browser.msie)t?window.open(e,t):location.href=e;else{var n=$('<a href="'+e+'" target="'+(t||"_self")+'"> </a>')[0];document.body.appendChild(n),n.click()}}function i(e,t){return t===undefined?t=new Date:$.isNumeric(t)&&(t=new Date(parseInt(t,10))),e.replace(/([YMDhsm])\1*/g,function(e){switch(e.charAt()){case"Y":return f(t.getFullYear(),e);case"M":return f(t.getMonth()+1,e);case"D":return f(t.getDate(),e);case"w":return t.getDay()+1;case"h":return f(t.getHours(),e);case"m":return f(t.getMinutes(),e);case"s":return f(t.getSeconds(),e)}})}function s(e,t,n){$.type(t)=="date"?t=t.getTime():t=parseInt(t);var r=new Date(t),i=r.getHours();return r>432e5&&(i+=Math.floor(r/432e5)),n&&(e=e.replace(/(\w)\1+/g,"$1")),e.replace(/([hms])\1*/g,function(t){switch(t.charAt()){case"h":return f(i-8,t);case"m":var n=(/h+/.test(e)?0:i-8)*60+r.getMinutes();return f(n,t);case"s":return f(r.getSeconds(),t)}})}function u(e,t,n){$.isNumeric(e)&&(e=new Date(parseInt(e,10))),$.isNumeric(t)&&(t=new Date(parseInt(t,10))),e===undefined&&(e=new Date),t===undefined&&(t=new Date),n||(n="YYYY年MM月DD日");var r=new Date(t.toDateString()),s=(+t- +e)/1e3,u=(+t- +r)/1e3;return s<=60?"刚刚":s<=3600?Math.floor(s/60)+"分钟前":s<=u?Math.floor(s/3600)+"小时前":s<=u+o?"昨天":s<=u+o*2?"前天":s<=u+o*25?Math.floor(s/o)+"天前":i(n,e)}function a(e,t){return e<36e5?s("mm分ss秒",e,t):s("hh小时mm分ss秒",e,t)}function f(e,t){return t=t.length,e=e||0,t==1?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function l(e){var t=/[\?\&]([^&]+=[^&#]+)/g,n,r=[],i="",s=window.location.href;while(n=t.exec(s))r.push(n[1]);return e?($.each(r,function(t,n){if(n.indexOf(e)!==-1){var r=n.indexOf("=");return i=n.slice(r+1),!1}}),i):r}function c(t,n){return e.create({title:"提示",custom:'<i class="icon icon-error"></i>'+t,tip:!0,fade:n})}function h(t){return e.create({title:"提示",custom:'<i class="icon icon-success"></i>'+t,tip:!0,fade:!0})}function p(t,n){var r={title:"提示",custom:t,tip:!0,fade:n};return e.create(r)}function d(e,t,n){var t=t||{};try{if($.isEmptyObject(t)){if(n){var r=n.responseText,i="状态："+n.status+"， 异常信息："+n.statusText;if(r)try{r=$.parseJSON(r),i="请求地址："+r.path+"， "+i}catch(s){}c(i)}}else t.resCode=="0000"?e&&e():(e&&e(!0),t&&$.type(t)=="object"&&t[1]=="timeout"?c("网络请求慢，连接超时，请重试",!0):c(t.resMsg,!0))}catch(s){throw"ajax data error:"+s}}function v(e,t,n){var t=t||{};try{t.resCode=="0000"?e&&e():e&&e(!0)}catch(r){throw"ajax data error:"+r}}function m(e,t){var n=[],r={};return $.each(e,function(e,i){var s=t?i[t]:i;r[s]||(n.push(i),r[s]=1)}),n}function g(e,t,n){return e.slice(0,n)+t+e.slice(n)}function y(e,t,n){var r=this,i=$.extend({dataType:"json",success:function(i){r.trigger(t,i,null,e.data,n)},error:function(e,n,i){r.trigger(t,null,e)}},e);$.ajax(i)}function b(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=_utf8_encode(e);while(f<e.length)n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=e.charCodeAt(f++),s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+_keyStr.charAt(s)+_keyStr.charAt(o)+_keyStr.charAt(u)+_keyStr.charAt(a);return t},this.decode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)s=_keyStr.indexOf(e.charAt(f++)),o=_keyStr.indexOf(e.charAt(f++)),u=_keyStr.indexOf(e.charAt(f++)),a=_keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i));return t=_utf8_decode(t),t},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode=function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}}var o=86400;n.openURL=r,n.formatDate=i,n.formatTime=s,n.formatNumber=f,n.formatTime=s,n.formatTimeE=a,n.release=u,n.queryString=l,n.errorTip=c,n.successTip=h,n.tip=p,n.dealAjax=d,n.insertStr=g,n.unique=m,n.request=y,n.mDealAjax=v,n.Base64=b}),define("root-common/module/cookie",[],function(){return function(e,t,n,r){typeof e=="string"&&(r=n,n=t,t=e,e=window);if(n===undefined)return n=e.document.cookie.match(new RegExp("(?:\\s|^)"+t+"\\=([^;]*)")),n?decodeURIComponent(n[1]):null;r=r||{};var i,s="";r.expires&&(r.expires.constructor==Date?i=r.expires:(i=new Date,i.setTime(i.getTime()+r.expires*24*60*60*1e3)),s="; expires="+i.toGMTString());var o=r.path?"; path="+r.path:"",u=r.domain?"; domain="+r.domain:"",a=r.secure?"; secure":"";e.document.cookie=[t,"=",encodeURIComponent(n),s,o,u,a].join("")}}),define("model",["root-common/util","root-common/module/cookie"],function(e,t){function k(n,r,i,s){var o=this,u=$.extend({url:n.url,headers:{token:t("hzw_reading_token")},data:n.data,dataType:"json",success:function(t){t.status==401?(e.tip(t.resDesc,3e3),L()):(o.trigger(i,t,null,n.data,r),s&&s(t))},error:function(e,t,n){o.trigger(i,null,e)}},n);$.ajax(u)}function L(e){t("hzw_reading_token","",{expires:-1}),window.location.href="#"}var n="getUserInfo",r="getTopicInfoList",i="getBookInfoList",s="getMyBook",o="getArticleInfo",u="goWriting",a="finishReading",f="getCommentList",l="commitComment",c="startReading",a="finishReading",h="changePwByKey",p="purchase",d="modifyUserInfo",v="changePswByOldPsw",m="register",g="exercisesStatus",y="getExercises",b="saveExercise",w="getFinishExercises",E="redoBookExercises",S="tradeGold",x="tradeRecharge",T="updateBookStatus",N="queryAllGrade",C="setGrade",A=Backbone.Model.extend({initialize:function(){},getUserInfo:function(t,r){var i=this,s,o={};t.token?o.token=t.token:(s="Basic "+(new e.Base64).encode(r.username+":"+r.pw),o.authorization=s),t.url=window.serviceBase+"/user/userInfo",t.headers=o,t.data={},k.call(this,t,r,n,function(e){A.data.userInfo=e.data})},getTopicInfoList:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/resource/getTopicInfoList",k.call(this,e,t,r)},getBookInfoList:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/resource/getBookInfoListByParams",k.call(this,e,t,i)},getMyBook:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/resource/getMyBookInfoListByParams",k.call(this,e,t,s)},getArticleInfo:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/readingContent/getArticleInfo",k.call(this,e,t,o)},startReading:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/readingContent/startReading",k.call(this,e,t,c)},finishReading:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/finishReading/finishReading",k.call(this,e,t,a)},finishReading:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/finishReading/finishReading",e.type="post",k.call(this,e,t,a)},getCommentList:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/finishReading/getCommentList",k.call(this,e,t,f)},commitComment:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/finishReading/commitComment",e.type="post",k.call(this,e,t,l)},changePswByKey:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/user/changePswByKey",e.type="post",k.call(this,e,t,h)},purchase:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/pay/purchase",e.type="post",k.call(this,e,t,p)},modifyUserInfo:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/user/modifyUserInfo",e.type="post",k.call(this,e,t,d)},changePswByOldPsw:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/user/changePswByOldPsw",e.type="post",k.call(this,e,t,v)},register:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/user/register",e.type="post",k.call(this,e,t,m)},exercisesStatus:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/doExercises/exercisesStatus",k.call(this,e,t,g)},getExercises:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/doExercises/enterBookExercises",k.call(this,e,t,y)},saveExercise:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/doExercises/saveExercisesAnswer",k.call(this,e,t,b)},getFinishExercises:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/doExercises/getFinishExercisesById",k.call(this,e,t,w)},redoBookExercises:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/doExercises/redoBookExercises",k.call(this,e,t,E)},tradeGold:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/trade/gold",k.call(this,e,t,S)},tradeRecharge:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/trade/recharge",k.call(this,e,t,x)},updateUserBookStatus:function(e,t){var n=this;e=e||{},e.type="post",e.url=window.serviceBase+"/doExercises/updateUserBookStatus",k.call(this,e,t,T)},queryAllGrade:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/resource/queryAllGrade",k.call(this,e,t,N)},setGrade:function(e,t){var n=this;e=e||{},e.url=window.serviceBase+"/user/registerUserSaveGrade",k.call(this,e,t,C)}});return A.data={userInfo:{}},A}),define("root-common/module/scrollbar",[],function(){(function(e){e.fn.customScrollbar=function(t,n){var r={skin:undefined,hScroll:!0,vScroll:!0,updateOnWindowResize:!1,animationSpeed:300,onCustomScroll:undefined,swipeSpeed:1,wheelSpeed:40,fixedThumbWidth:undefined,fixedThumbHeight:undefined,preventDefaultScroll:!1},i=function(t,n){this.$element=e(t),this.options=n,this.addScrollableClass(),this.addSkinClass(),this.addScrollBarComponents(),this.options.vScroll&&(this.vScrollbar=new s(this,new u)),this.options.hScroll&&(this.hScrollbar=new s(this,new o)),this.$element.data("scrollable",this),this.initKeyboardScrolling(),this.bindEvents()};i.prototype={addScrollableClass:function(){this.$element.hasClass("scrollable")||(this.scrollableAdded=!0,this.$element.addClass("scrollable"))},removeScrollableClass:function(){this.scrollableAdded&&this.$element.removeClass("scrollable")},addSkinClass:function(){typeof this.options.skin=="string"&&!this.$element.hasClass(this.options.skin)&&(this.skinClassAdded=!0,this.$element.addClass(this.options.skin))},removeSkinClass:function(){this.skinClassAdded&&this.$element.removeClass(this.options.skin)},addScrollBarComponents:function(){this.assignViewPort(),this.$viewPort.length==0&&(this.$element.wrapInner('<div class="viewport" />'),this.assignViewPort(),this.viewPortAdded=!0),this.assignOverview(),this.$overview.length==0&&(this.$viewPort.wrapInner('<div class="overview" />'),this.assignOverview(),this.overviewAdded=!0),this.addScrollBar("vertical","prepend"),this.addScrollBar("horizontal","append")},removeScrollbarComponents:function(){this.removeScrollbar("vertical"),this.removeScrollbar("horizontal"),this.overviewAdded&&this.$element.unwrap(),this.viewPortAdded&&this.$element.unwrap()},removeScrollbar:function(e){this[e+"ScrollbarAdded"]&&this.$element.find(".scroll-bar."+e).remove()},assignViewPort:function(){this.$viewPort=this.$element.find(".viewport")},assignOverview:function(){this.$overview=this.$viewPort.find(".overview")},addScrollBar:function(e,t){this.$element.find(".scroll-bar."+e).length==0&&(this.$element[t]("<div class='scroll-bar "+e+"'><div class='thumb'></div></div>"),this[e+"ScrollbarAdded"]=!0)},resize:function(e){this.vScrollbar&&this.vScrollbar.resize(e),this.hScrollbar&&this.hScrollbar.resize(e)},scrollTo:function(e){this.vScrollbar&&this.vScrollbar.scrollToElement(e),this.hScrollbar&&this.hScrollbar.scrollToElement(e)},scrollToXY:function(e,t){this.scrollToX(e),this.scrollToY(t)},scrollToX:function(e){this.hScrollbar&&this.hScrollbar.scrollOverviewTo(e,!0)},scrollToY:function(e){this.vScrollbar&&this.vScrollbar.scrollOverviewTo(e,!0)},scrollByX:function(e){this.hScrollbar&&this.scrollToX(this.hScrollbar.overviewPosition()+e)},scrollByY:function(e){this.vScrollbar&&this.scrollToY(this.vScrollbar.overviewPosition()+e)},remove:function(){this.removeScrollableClass(),this.removeSkinClass(),this.removeScrollbarComponents(),this.$element.data("scrollable",null),this.removeKeyboardScrolling(),this.vScrollbar&&this.vScrollbar.remove(),this.hScrollbar&&this.hScrollbar.remove()},setAnimationSpeed:function(e){this.options.animationSpeed=e},isInside:function(t,n){var r=e(t),i=e(n),s=r.offset(),o=i.offset();return s.top>=o.top&&s.left>=o.left&&s.top+r.height()<=o.top+i.height()&&s.left+r.width()<=o.left+i.width()},initKeyboardScrolling:function(){var e=this;this.elementKeydown=function(t){document.activeElement===e.$element[0]&&(e.vScrollbar&&e.vScrollbar.keyScroll(t),e.hScrollbar&&e.hScrollbar.keyScroll(t))},this.$element.attr("tabindex","-1").keydown(this.elementKeydown)},removeKeyboardScrolling:function(){this.$element.removeAttr("tabindex").unbind("keydown",this.elementKeydown)},bindEvents:function(){this.options.onCustomScroll&&this.$element.on("customScroll",this.options.onCustomScroll)}};var s=function(e,t){this.scrollable=e,this.sizing=t,this.$scrollBar=this.sizing.scrollBar(this.scrollable.$element),this.$thumb=this.$scrollBar.find(".thumb"),this.setScrollPosition(0,0),this.resize(),this.initMouseMoveScrolling(),this.initMouseWheelScrolling(),this.initTouchScrolling(),this.initMouseClickScrolling(),this.initWindowResize()};s.prototype={resize:function(e){this.overviewSize=this.sizing.size(this.scrollable.$overview),this.calculateViewPortSize(),this.sizing.size(this.scrollable.$viewPort,this.viewPortSize),this.ratio=this.viewPortSize/this.overviewSize,this.sizing.size(this.$scrollBar,this.viewPortSize),this.thumbSize=this.calculateThumbSize(),this.sizing.size(this.$thumb,this.thumbSize),this.maxThumbPosition=this.calculateMaxThumbPosition(),this.maxOverviewPosition=this.calculateMaxOverviewPosition(),this.enabled=this.overviewSize>this.viewPortSize,this.scrollPercent===undefined&&(this.scrollPercent=0),this.enabled?this.rescroll(e):this.setScrollPosition(0,0),this.$scrollBar.toggle(this.enabled)},calculateViewPortSize:function(){var e=this.sizing.size(this.scrollable.$element);if(e>0&&!this.maxSizeUsed)this.viewPortSize=e,this.maxSizeUsed=!1;else{var t=this.sizing.maxSize(this.scrollable.$element);this.viewPortSize=Math.min(t,this.overviewSize),this.maxSizeUsed=!0}},calculateThumbSize:function(){var e=this.sizing.fixedThumbSize(this.scrollable.options),t;return e?t=e:t=this.ratio*this.viewPortSize,Math.max(t,this.sizing.minSize(this.$thumb))},initMouseMoveScrolling:function(){var t=this;this.$thumb.mousedown(function(e){t.enabled&&t.startMouseMoveScrolling(e)}),this.documentMouseup=function(e){t.stopMouseMoveScrolling(e)},e(document).mouseup(this.documentMouseup),this.documentMousemove=function(e){t.mouseMoveScroll(e)},e(document).mousemove(this.documentMousemove),this.$thumb.click(function(e){e.stopPropagation()})},removeMouseMoveScrolling:function(){this.$thumb.unbind(),e(document).unbind("mouseup",this.documentMouseup),e(document).unbind("mousemove",this.documentMousemove)},initMouseWheelScrolling:function(){var e=this;this.scrollable.$element.mousewheel(function(t,n,r,i){if(e.enabled){var s=e.mouseWheelScroll(r,i);e.stopEventConditionally(t,s)}})},removeMouseWheelScrolling:function(){this.scrollable.$element.unbind("mousewheel")},initTouchScrolling:function(){if(document.addEventListener){var e=this;this.elementTouchstart=function(t){e.enabled&&e.startTouchScrolling(t)},this.scrollable.$element[0].addEventListener("touchstart",this.elementTouchstart),this.documentTouchmove=function(t){e.touchScroll(t)},this.scrollable.$element[0].addEventListener("touchmove",this.documentTouchmove),this.elementTouchend=function(t){e.stopTouchScrolling(t)},this.scrollable.$element[0].addEventListener("touchend",this.elementTouchend)}},removeTouchScrolling:function(){document.addEventListener&&(this.scrollable.$element[0].removeEventListener("touchstart",this.elementTouchstart),document.removeEventListener("touchmove",this.documentTouchmove),this.scrollable.$element[0].removeEventListener("touchend",this.elementTouchend))},initMouseClickScrolling:function(){var e=this;this.scrollBarClick=function(t){e.mouseClickScroll(t)},this.$scrollBar.click(this.scrollBarClick)},removeMouseClickScrolling:function(){this.$scrollBar.unbind("click",this.scrollBarClick)},initWindowResize:function(){if(this.scrollable.options.updateOnWindowResize){var t=this;this.windowResize=function(){t.resize()},e(window).resize(this.windowResize)}},removeWindowResize:function(){e(window).unbind("resize",this.windowResize)},isKeyScrolling:function(e){return this.keyScrollDelta(e)!=null},keyScrollDelta:function(e){for(var t in this.sizing.scrollingKeys)if(t==e)return this.sizing.scrollingKeys[e](this.viewPortSize);return null},startMouseMoveScrolling:function(t){this.mouseMoveScrolling=!0,e("body").addClass("not-selectable"),this.setUnselectable(e("body"),"on"),this.setScrollEvent(t),t.preventDefault()},stopMouseMoveScrolling:function(t){this.mouseMoveScrolling=!1,e("body").removeClass("not-selectable"),this.setUnselectable(e("body"),null)},setUnselectable:function(e,t){e.attr("unselectable")!=t&&(e.attr("unselectable",t),e.find(":not(input)").attr("unselectable",t))},mouseMoveScroll:function(e){if(this.mouseMoveScrolling){var t=this.sizing.mouseDelta(this.scrollEvent,e);this.scrollThumbBy(t),this.setScrollEvent(e)}},startTouchScrolling:function(e){e.touches&&e.touches.length==1&&(this.setScrollEvent(e.touches[0]),this.touchScrolling=!0,e.stopPropagation())},touchScroll:function(e){if(this.touchScrolling&&e.touches&&e.touches.length==1){var t=-this.sizing.mouseDelta(this.scrollEvent,e.touches[0])*this.scrollable.options.swipeSpeed,n=this.scrollOverviewBy(t);n&&this.setScrollEvent(e.touches[0]),this.stopEventConditionally(e,n)}},stopTouchScrolling:function(e){this.touchScrolling=!1,e.stopPropagation()},mouseWheelScroll:function(e,t){var n=-this.sizing.wheelDelta(e,t)*this.scrollable.options.wheelSpeed;if(n!=0)return this.scrollOverviewBy(n)},mouseClickScroll:function(e){var t=this.viewPortSize-20;e["page"+this.sizing.scrollAxis()]<this.$thumb.offset()[this.sizing.offsetComponent()]&&(t=-t),this.scrollOverviewBy(t)},keyScroll:function(e){var t=e.which;if(this.enabled&&this.isKeyScrolling(t)){var n=this.scrollOverviewBy(this.keyScrollDelta(t));this.stopEventConditionally(e,n)}},scrollThumbBy:function(e){var t=this.thumbPosition();t+=e,t=this.positionOrMax(t,this.maxThumbPosition);var n=this.scrollPercent;this.scrollPercent=t/this.maxThumbPosition;if(n!=this.scrollPercent){var r=t*this.maxOverviewPosition/this.maxThumbPosition;return this.setScrollPosition(r,t),this.triggerCustomScroll(n),!0}return!1},thumbPosition:function(){return this.$thumb.position()[this.sizing.offsetComponent()]},scrollOverviewBy:function(e){var t=this.overviewPosition()+e;return this.scrollOverviewTo(t,!1)},overviewPosition:function(){return-this.scrollable.$overview.position()[this.sizing.offsetComponent()]},scrollOverviewTo:function(e,t){e=this.positionOrMax(e,this.maxOverviewPosition);var n=this.scrollPercent;this.scrollPercent=e/this.maxOverviewPosition;if(n!=this.scrollPercent){var r=this.scrollPercent*this.maxThumbPosition;return t?this.setScrollPositionWithAnimation(e,r):this.setScrollPosition(e,r),this.triggerCustomScroll(n),!0}return!1},positionOrMax:function(e,t){return e<0?0:e>t?t:e},triggerCustomScroll:function(e){this.scrollable.$element.trigger("customScroll",{scrollAxis:this.sizing.scrollAxis(),direction:this.sizing.scrollDirection(e,this.scrollPercent),scrollPercent:this.scrollPercent*100})},rescroll:function(e){if(e){var t=this.positionOrMax(this.overviewPosition(),this.maxOverviewPosition);this.scrollPercent=t/this.maxOverviewPosition;var n=this.scrollPercent*this.maxThumbPosition;this.setScrollPosition(t,n)}else{var n=this.scrollPercent*this.maxThumbPosition,t=this.scrollPercent*this.maxOverviewPosition;this.setScrollPosition(t,n)}},setScrollPosition:function(e,t){this.$thumb.css(this.sizing.offsetComponent(),t+"px"),this.scrollable.$overview.css(this.sizing.offsetComponent(),-e+"px")},setScrollPositionWithAnimation:function(e,t){var n={},r={};n[this.sizing.offsetComponent()]=t+"px",this.$thumb.animate(n,this.scrollable.options.animationSpeed),r[this.sizing.offsetComponent()]=-e+"px",this.scrollable.$overview.animate(r,this.scrollable.options.animationSpeed)},calculateMaxThumbPosition:function(){return Math.max(0,this.sizing.size(this.$scrollBar)-this.thumbSize)},calculateMaxOverviewPosition:function(){return Math.max(0,this.sizing.size(this.scrollable.$overview)-this.sizing.size(this.scrollable.$viewPort))},setScrollEvent:function(e){var t="page"+this.sizing.scrollAxis();if(!this.scrollEvent||this.scrollEvent[t]!=e[t])this.scrollEvent={pageX:e.pageX,pageY:e.pageY}},scrollToElement:function(t){var n=e(t);if(this.sizing.isInside(n,this.scrollable.$overview)){var r=n.offset(),i=this.scrollable.$overview.offset();this.scrollOverviewTo(r[this.sizing.offsetComponent()]-i[this.sizing.offsetComponent()],!0)}},remove:function(){this.removeMouseMoveScrolling(),this.removeMouseWheelScrolling(),this.removeTouchScrolling(),this.removeMouseClickScrolling(),this.removeWindowResize()},stopEventConditionally:function(e,t){if(t||this.scrollable.options.preventDefaultScroll)e.preventDefault(),e.stopPropagation()}};var o=function(){};o.prototype={size:function(e,t){return t?e.width(t):e.width()},minSize:function(e){return parseInt(e.css("min-width"))||0},maxSize:function(e){return parseInt(e.css("max-width"))||0},fixedThumbSize:function(e){return e.fixedThumbWidth},scrollBar:function(e){return e.find(".scroll-bar.horizontal")},mouseDelta:function(e,t){return t.pageX-e.pageX},offsetComponent:function(){return"left"},wheelDelta:function(e,t){return e},scrollAxis:function(){return"X"},scrollDirection:function(e,t){return e<t?"right":"left"},scrollingKeys:{37:function(e){return-10},39:function(e){return 10}},isInside:function(t,n){var r=e(t),i=e(n),s=r.offset(),o=i.offset();return s.left>=o.left&&s.left+r.width()<=o.left+i.width()}};var u=function(){};return u.prototype={size:function(e,t){return t?e.height(t):e.height()},minSize:function(e){return parseInt(e.css("min-height"))||0},maxSize:function(e){return parseInt(e.css("max-height"))||0},fixedThumbSize:function(e){return e.fixedThumbHeight},scrollBar:function(e){return e.find(".scroll-bar.vertical")},mouseDelta:function(e,t){return t.pageY-e.pageY},offsetComponent:function(){return"top"},wheelDelta:function(e,t){return t},scrollAxis:function(){return"Y"},scrollDirection:function(e,t){return e<t?"down":"up"},scrollingKeys:{38:function(e){return-10},40:function(e){return 10},33:function(e){return-(e-20)},34:function(e){return e-20}},isInside:function(t,n){var r=e(t),i=e(n),s=r.offset(),o=i.offset();return s.top>=o.top&&s.top+r.height()<=o.top+i.height()}},this.each(function(){t==undefined&&(t=r);if(typeof t=="string"){var s=e(this).data("scrollable");s&&s[t](n)}else{if(typeof t!="object")throw"Invalid type of options";t=e.extend(r,t),new i(e(this),t)}})}})(jQuery),function(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var t=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=t.length;n;)e.event.fixHooks[t[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery)}),define("sign",["text!root-tpl/main.tpl","root-common/util","./model","root-common/module/cookie","root-common/module/scrollbar"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(){var t=this;t.times=null,t.inits=0,t.colors="0f3f66",t._tpl=doT.template(e),t._model=new n,t._model.bind({getUserInfo:$.proxy(t.getUserInfo,t)})},events:{"click .btn-confirm":"btnConfirm","click .img-btn":"btnChange","mouseover .img-btn":"overChange","mouseout .img-btn":"outChange"},reset:function(){this.$el.html("")},init:function(){var e=this;e.render()},render:function(){var e=this;e.$el.html(e._tpl({})),this.changeTime(),$(".ui-signin",e.$el).customScrollbar({updateOnWindowResize:!0})},btnConfirm:function(e){var t=this;return e.preventDefault(),window.audioPlay.click(),t._model.getUserInfo({},{username:$('input[name="loginName"]',t.$el).val(),pw:$('input[name="pw"]',t.$el).val()}),!1},overChange:function(){var e=this;clearTimeout(e.times),e.colors=e.inits==0?"0f3f66":"473c4d"},outChange:function(){this.changeTime()},btnChange:function(e){var t=this,n=$(e.target).index();t.colors=n==0?"0f3f66":"473c4d",t.inits=n,$(".ui-image").css({background:"url(../alpha/images/sign_"+n+".jpg) no-repeat #"+t.colors+" top center"}),t.go(n)},changeTime:function(e){var t=this;t.times=setInterval(function(){t.go(t.inits),t.inits=t.inits==0?1:0,t.colors=t.colors=="0f3f66"?"473c4d":"0f3f66"},5e3)},go:function(e){var t=this;$(".ui-image").css({background:"url(../alpha/images/sign_"+e+".jpg) no-repeat #"+t.colors+" top center"}),$(".change .img-btn").removeClass("img-choice"),$(".change .img-btn").eq(e).addClass("img-choice")},getUserInfo:function(e,n,i,s){var o=this;t.dealAjax(function(n){var i=e.data;n||(r("hzw_reading_token",i.token),t.tip("登录成功",!0),i.userPhone?window.location.href="#product":window.location.href="#phone")},e,n)}});return i}),define("text!root-tpl/signup.tpl",[],function(){return'<div class="ui-signin default-skin">\n	<div class="ui-image">\n		<div class="ui-bg"></div>\n		<ul class="fix change">\n			<li class="img-btn img-choice"></li>\n			<li class="img-btn"></li>\n		</ul>\n		<form class="form signin-forms" action="">\n			<div class="form-control fix">\n				<div class="inner">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-user icon-solid icon">\n		                	&#xe90d;\n		                </span>\n		            </div>\n		            <input type="text" class="form-input" name="loginName" placeholder="请输入账号" />\n				</div>\n		        <div class="form-error"></div>\n		    </div>\n		    <div class="form-control fix">\n		    	<div class="inner">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-lock icon-solid icon">\n		            		&#xe90b;\n		                </span>\n		            </div>\n			        <input type="password" class="form-input input-pw" name="pw" placeholder="请输入密码" />\n				</div>\n		        \n		        <div class="form-error"></div>\n		    </div>\n		    <div class="form-control fix">\n		    	<div class="inner">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-lock icon-solid icon">\n		            		&#xe90b;\n		                </span>\n		            </div>\n			        <input type="password" class="form-input input-pw" name="cpw" placeholder="请再次输入密码" />\n				</div>\n		        \n		        <div class="form-error"></div>\n		    </div>\n		    <div class="form-control fix">\n		    	<div class="inner">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-lock icon-solid icon">\n		            		&#xe912;\n		                </span>\n		            </div>\n			        <input type="text" class="form-input" name="email" placeholder="请输入邮箱，用于找回密码" />\n				</div>\n		        \n		        <div class="form-error"></div>\n		    </div>\n		    <div class="form-control "> \n		       <input class="btn btn-confirm" type="submit" value="注&nbsp;&nbsp;&nbsp;&nbsp;册" />\n		    </div>\n		</form>\n	</div>\n</div>'}),define("signup",["text!root-tpl/signup.tpl","root-common/util","./model","root-common/module/cookie","root-common/module/scrollbar"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(){var t=this;t.times=null,t.inits=0,t.colors="0f3f66",t._tpl=doT.template(e),t._model=new n,t._model.bind({register:$.proxy(t.register,t)})},events:{"submit .signin-forms":"_validate","click .img-btn":"btnChange","mouseover .img-btn":"overChange","mouseout .img-btn":"outChange"},reset:function(){this.$el.html("")},init:function(){var e=this;e.render()},render:function(){var e=this;e.$el.html(e._tpl({})),this.changeTime(),$(".ui-signin",e.$el).customScrollbar({updateOnWindowResize:!0})},_validate:function(e){console.log(132);var t=this,n=this.validate($(e.currentTarget)).form();return e.preventDefault(),n&&t._model.register({data:{userName:$('input[name="loginName"]',t.$el).val(),userEmail:$('input[name="email"]',t.$el).val(),password:$('input[name="pw"]',t.$el).val()}}),!1},validate:function(e){var t=this;return e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.parent().parent().find(".form-error"))},rules:{loginName:{required:!0,isUsername:!0,remote:{url:window.serviceBase+"/user/checkUniq",data:{loginName:function(){return $('[name="loginName"]').val()}},dataType:"json"}},pw:{required:!0,ispw:!0},cpw:{required:!0,isCpw:!0},email:{required:!0,isEmail:!0,remote:{url:window.serviceBase+"/user/checkUniq",data:{userEmail:function(){return $('[name="email"]').val()}},dataType:"json"}}},messages:{loginName:{required:"账号不能为空",isUsername:"包含字母或数字，最短 6位，最长 30位",remote:"账号已经存在"},pw:{required:"密码不能为空",ispw:"至少包含字母或数字，最短 6位字符，最长 30位，区分大小写"},cpw:{required:"确认密码不能为空",isCpw:"两次输入不一致"},email:{required:"邮箱不能为空",isEmail:"请输入正确的邮箱",remote:"该邮箱已被使用"}}})},overChange:function(){var e=this;clearTimeout(e.times),e.colors=e.inits==0?"0f3f66":"473c4d"},outChange:function(){this.changeTime()},btnChange:function(e){var t=this,n=$(e.target).index();t.colors=n==0?"0f3f66":"473c4d",t.inits=n,$(".ui-image").css({background:"url(../alpha/images/sign_"+n+".jpg) no-repeat #"+t.colors+" top center"}),t.go(n)},changeTime:function(e){var t=this;t.times=setInterval(function(){t.go(t.inits),t.inits=t.inits==0?1:0,t.colors=t.colors=="0f3f66"?"473c4d":"0f3f66"},5e3)},go:function(e){var t=this;$(".ui-image").css({background:"url(../alpha/images/sign_"+e+".jpg) no-repeat #"+t.colors+" top center"}),$(".change .img-btn").removeClass("img-choice"),$(".change .img-btn").eq(e).addClass("img-choice")},register:function(e,n,r,i){var s=this;t.dealAjax(function(n){var r=e.data;n||(t.tip("注册成功！",!0),window.location.href="#")},e,n)}});return i}),define("text!root-tpl/find-pw/action.tpl",[],function(){return'<div class="form-control fix"> \n   <button class="btn btn-next">确定</button>\n   <a class="btn btn-backtosign" href="javascript:;">返回</a>\n</div>\n'}),define("text!root-tpl/find-pw/update-pw.tpl",[],function(){return'<div class="hd"></div>\n<div class="main">\n	<form class="form form-updatepw fix" action="">\n		<div class="form-control fix">\n			<div class="input-group fix">\n				<div class="clearfix bshadow0 pbs">\n					<span class="icon-solid icon">\n	                	&#xe910;\n	                </span>\n	            </div>\n		        <input type="text" class="form-input" name="pw" placeholder="请输入密码" />\n			</div>\n			\n	        <div class="form-error"></div>\n	    </div>\n	    <div class="form-control fix">\n	    	<div class="input-group fix">\n				<div class="clearfix bshadow0 pbs">\n					<span class="icon-solid icon">\n	            		&#xe910;\n	                </span>\n	            </div>\n		        <input type="text" class="form-input" name="cpw" placeholder="请确认密码" />\n			</div>\n	        <div class="form-error"></div>\n	    </div>\n	    <div class="form-control fix"> \n		   <input class="btn btn-confirm" type="submit" value="确&nbsp;&nbsp;&nbsp;&nbsp;定" />\n		   <a class="btn btn-logout" href="javascript:;">返回</a>\n		   \n		</div>\n	</form>\n</div>'}),define("text!root-tpl/find-pw/choice.tpl",[],function(){return'<div class="bg2"></div>\n<!-- <div class="main">\n	<div class="mask"></div>\n	<div class="content">\n		<div class="nav">\n			\n		</div>\n		<div class="panel">\n			\n		</div>\n	</div>\n	\n</div> -->'}),define("text!root-common/module/pay/main.tpl",[],function(){return'<a href="javascript:;" class="btn-close"></a>\n{{ if(it.overage){ }}\n<div class="panel-pay panel-overage">\n	<p>购买本书需要<i class="num">{{=it.coin}}</i>金币</p>\n	<p>您是否确定要购买？</p>\n	<a href="javascript:;" class="btn btn-purchase">\n		购买\n	</a>\n</div>\n{{ }else{ }}\n<p class="title">账户储币</p>\n<div class="panel-pay panel-recharge">\n	<ul class="price-list">\n		{{~it.list :v:i}}		\n		<li class="item-money fix">\n			<div class="inner">\n				<p class="gold">{{=v.goldAmount}}</p>\n				<p><img src="images/money_{{=i}}.png" width="50" height="50"></p>\n				<p class="as">~</p>\n				<p class="money">{{=v.rmb}}元</p>\n			</div>\n			\n		</li>\n		{{~}}		\n	</ul>\n	<div class="detail">\n\n	</div>\n	{{ if(it.itemType == \'book\'){ }}\n	<p class="pay-str">购买本书需要<i class="num">{{=it.item.goldcoin}}</i>金币，账户余额<i class="num">{{=it.coin}}</i>金币</br>您的余额不足...</p>\n	{{ } }}\n	\n	<div class="btn-pay">\n		<a href="javascript:;" class="btn btn-wechat" data-name="wechat" >\n			<i class="icon-solid">&#xe907;</i>微信支付\n		</a>\n		<a href="javascript:;" class="btn btn-alipay" data-name="alipay" >\n			<i class="icon-solid">&#xe908;</i>支付宝支付\n		</a>\n	</div>\n</div>\n{{ } }}\n'}),define("text!root-common/module/pay/alipay.tpl",[],function(){return'<a href="javascript:;" class="btn-close"></a>\n<p class="title">订单提示</p>\n<div class="panel-pay panel-recharge">\n	<p class="str">请在打开的支付宝页面上完成支付......</p>\n	<div class="btn-pay">\n		<a href="javascript:;" class="btn btn-problems" data-name="problems" >已完成支付</a>\n	</div>\n</div>\n\n\n	\n'}),define("text!root-common/module/pay/thirdpart.tpl",[],function(){return'<div class="panel-wechat">\n	<a href="javascript:;" class="btn-close"></a>\n	<p>应付总额：￥ <i class="total">{{=it.money}}</i></p>\n	<p>\n		<img src="{{=it.url}}" />\n	</p>\n	<p class="desc">使用微信扫描此二维码进行支付</p>\n	<p>微信支付</p>\n</div>'}),define("text!root-common/module/pay/error.tpl",[],function(){return'<a href="javascript:;" class="btn-close"></a>\n<div class="panel-result panel-error form">\n	<h4>储币失败...</h4>\n	<p>本次储币失败，</p>\n	<p>请点击按钮重新充值</p>\n	<a href="javascript:;" class="btn btn-recharge">储 币</a>\n</div>'}),define("text!root-common/module/pay/success.tpl",[],function(){return'<a href="javascript:;" class="btn-close"></a>\n<div class="panel-result panel-success form">\n	<h4>储币成功！</h4>\n	<p>您本次成功充值<i>{{=it.gold}}</i>金币</p>\n	<p>账户余额<i>{{=it.overage}}</i>金币</p>\n	<a href="javascript:;" class="btn btn-close">确定</a>\n</div>'}),define("root-common/module/pay/model",["../../util"],function(e){function s(t,n,r,i){var s=this,o=$.extend({url:t.url,headers:{},data:t.data,dataType:"json",success:function(o){o.status==401?(e.tip(o.resDesc,3e3),s.trigger(E_NO_TOKEN)):(s.trigger(r,o,null,t.data,n),i&&i(o))},error:function(e,t,n){s.trigger(r,null,e)}},t);this.token&&(o.headers.token=this.token),$.ajax(o)}var t="getAmountList",n="order",r="checkStatus",i="userPatrimony",o=Backbone.Model.extend({initialize:function(e){this.baseUrl=e.baseUrl,this.token=e.token},getAmountList:function(e,n){var r=this;e=e||{},e.url=this.baseUrl+"/pay/amountList",s.call(this,e,n,t)},order:function(e,t){var r=this;e=e||{},e.url=this.baseUrl+"/pay/order",e.type="post",e.async=!1,s.call(this,e,t,n)},checkStatus:function(e,t){var n=this;e=e||{},e.url=this.baseUrl+"/pay/getOrderStatusByOrderId",s.call(this,e,t,r)},userPatrimony:function(e,t){var n=this;e=e||{},e.url=this.baseUrl+"/pay/userPatrimony",s.call(this,e,t,i)}});return o.isPaying=!1,o}),define("root-common/module/pay/thirdpart",["text!./thirdpart.tpl","text!./alipay.tpl","text!./error.tpl","text!./success.tpl","../popup","./model","../../util"],function(e,t,n,r,i,s,o){var u="recharge",a="success",f=Backbone.View.extend({initialize:function(o){var u=this;u._tpl=doT.template(e),u._alipayTpl=doT.template(t),u._errorTpl=doT.template(n),u._successTpl=doT.template(r),u._model=new s(o),u._model.bind({order:$.proxy(u.order,u),checkStatus:$.proxy(u.checkStatus,u),userPatrimony:$.proxy(u.userPatrimony,u)}),u.config=o,u.moneyObj=o.moneyObj,u._type=o.name,u._orderNo="",u._timer=null,u._status=!1;var a=u._pop=i.create({custom:'<div class="panel-pay "><div class="loading"></div></div>',hasHd:!1,isMove:!1,mask:!0,className:"ui-pay"});u.setElement(a.$el),u.loadOrder()},events:{"click .btn-close":"close","click .btn-recharge":"recharge","click .btn-problems":"problems"},close:function(){this._pop.close()},recharge:function(){this.close(),this.trigger(u)},problems:function(){var e=this;e.recharge()},loadOrder:function(){var e=this;e._model.order({data:{amountId:e.moneyObj.id,type:e._type=="wechat"?2:1}})},order:function(e,t,n,r){var i=this;o.dealAjax(function(t){var n=e.data;if(!t){i._orderNo=n.orderNo,i._type=="wechat"?($(".panel-pay").css({width:230}),$(".panel-pay",i.$el).html(i._tpl({url:n.url,money:i.moneyObj.rmb})),i._pop.resize()):($(".panel-pay",i.$el).html(i._alipayTpl({})),i._pop.resize(),window.open(n.url,"_blank")),s.isPaying=!0;var r=+(new Date);i._timer&&clearInterval(i._timer),i._timer=setInterval(function(){var e=+(new Date);i._status&&(i.showSuccess(),i._timer&&clearInterval(i._timer),s.isPaying=!1);if((e-r)/1e3>300){i._timer&&clearInterval(i._timer),s.isPaying=!1,i._status||i.showError();return}i._model.checkStatus({data:{orderNo:i._orderNo}})},5e3)}},e,t)},userPatrimony:function(e,t,n,r){var s=this;o.dealAjax(function(t){var n=e.data;if(!t){s.close();var r=s._pop=i.create({custom:s._successTpl({gold:s.moneyObj.goldAmount,overage:n.amount}),hasHd:!1,isMove:!1,mask:!0,className:"ui-pay"});s.setElement(r.$el),s.trigger(a,n.amount)}},e,t)},checkStatus:function(e,t,n,r){var i=this;try{var s=e.resCode,o=e.data;s=="0000"&&o.orderStatus=="4"&&(i._status=!0)}catch(u){}},showSuccess:function(){var e=this;e._model.userPatrimony();var t=$(".amount").html(),n=t*1+e.moneyObj.goldAmount;$(".amount").html(n)},showError:function(){var e=this;e.close();var t=e._pop=i.create({custom:e._errorTpl({}),hasHd:!1,isMove:!1,mask:!0,className:"ui-pay"});e.setElement(t.$el)}});return f}),define("root-common/module/pay/main",["text!./main.tpl","text!./alipay.tpl","../popup","./thirdpart","./model","../../util"],function(e,t,n,r,i,s){var o="purchase",u="pay",a=Backbone.View.extend({initialize:function(n){var r=this;r._tpl=doT.template(e),r._alipayTpl=doT.template(t),r._model=new i(n),r._model.bind({getAmountList:$.proxy(r.getAmountList,r),userPatrimony:$.proxy(r.userPatrimony,r)}),r.config=$.extend(!0,{},n),r.itemCoin=n.coin,r.chooceMoney=null},events:{"click .btn-close":"close","click .btn-wechat":"_wechat","click .btn-purchase":"pay","click .item-money":"_selectMoney","click .btn-wechat":"_thirdpart","click .btn-alipay":"_thirdpart"},init:function(e){var t=this;e?t.render():t._model.userPatrimony()},render:function(e){var t=this,r=t._pop=n.create({custom:t._tpl({overage:e,coin:t.config.coin}),hasHd:!1,isMove:!1,mask:!0,className:"ui-pay"});t._moneyList=[],t.setElement(r.$el),t.$thirdpart=$(".panel-thirdpart",t.$el),t.$wechat=$(".panel-wechat",t.$el),e||t.purchase()},pay:function(e){e.preventDefault(),this.close(),this.trigger(u)},close:function(){this._pop.close()},_wechat:function(e){var t=this;e.preventDefault(),t.$thirdpart.hide(),t.$wechat.show()},purchase:function(){var e=this;e.trigger(o),e.close(),e._model.getAmountList()},_selectMoney:function(e){var t=this;$(".price-list .active",t.$el).removeClass("active");var n=$(e.currentTarget).addClass("active"),r=$(".item-money",t.$el).index(n),i=t._moneyList,s=i[r];t.chooceMoney=s},_thirdpart:function(e){e.preventDefault();var t=this,n=$(e.currentTarget),o=n.data("name");if(!t.chooceMoney){s.errorTip("请选择充值金额",!0);return}t.close();if(i.isPaying)s.errorTip("您当前有尚未处理完的订单，请稍后再试",!0);else{var u=new r($.extend(!0,{name:o,moneyObj:t.chooceMoney},t.config));o!="alipay"&&(u.bind("recharge",function(){t.render()}),u.bind("success",function(e){t.trigger("success",e)}))}},getAmountList:function(e,t,r,i){var o=this;s.dealAjax(function(t){var r=e.data,i=o.config;if(!t){o._moneyList=r.list;var s=o._pop=n.create({custom:o._tpl({overage:!1,showstr:!0,coin:i.coin,type:i.type,item:i.item,list:r.list}),hasHd:!1,isMove:!1,mask:!0,className:"ui-pay"});o.setElement(s.$el)}},e,t)},userPatrimony:function(e,t,n,r){var i=this;s.dealAjax(function(t){var n=e.data;if(!t){var r=n.amount;i.render(i.itemCoin<=r?1:0)}},e,t)}});return a}),define("text!root-common/module/phone-check/main.tpl",[],function(){return'<div class="ui-phone">\n	<div class="hd"></div>\n	<div class="main">\n		<form class="form form-validate-phone fix" action="">\n			<div class="form-control fix">\n				<div class="input-group fix">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-user icon-solid icon">\n		                	&#xe90c;\n		                </span>\n		            </div>\n			        <input type="text" class="form-input" name="phone" placeholder="请输入手机号码" />\n				</div>\n				\n		        <div class="form-error"></div>\n		    </div>\n		    <div class="form-control fix">\n		    	<div class="input-group fix">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-lock icon-solid icon">\n		            		&#xe90a;\n		                </span>\n		            </div>\n			        <input type="text" class="form-input" name="code" placeholder="输入验证码" />\n				</div>\n				<span class="img-code"></span>\n				<i class="icon-solid icon-loop">&#xe90f;</i>\n		        <div class="form-error"></div>\n		    </div>\n		    <div class="form-control fix">\n		    	<div class="input-group fix">\n					<div class="clearfix bshadow0 pbs">\n						<span class="icon-lock icon-solid icon">\n		            		&#xe911;\n		                </span>\n		            </div>\n			        <input type="text" class="form-input" name="dynamicCode" placeholder="输入动态码" />\n				</div>\n				<a href="javascript:;" class="btn-sendcode">\n					<i class="send">获取动态码</i>\n					<i class="nosend">\n						<i class="num"></i>秒后请重试\n					</i>\n				</a>\n		        <div class="form-error"></div>\n		    </div>\n		  	<div class="action"></div>\n		</form>\n	</div>\n</div>'}),define("root-common/module/phone-check/model",["../../util","../../module/cookie"],function(e,t){function u(t,n,r,i){var o=this,u=$.extend({url:t.url,headers:{},data:t.data,dataType:"json",success:function(u){u.status==401?(e.tip(u.resDesc,3e3),o.trigger(s)):(o.trigger(r,u,null,t.data,n),i&&i(u))},error:function(e,t,n){o.trigger(r,null,e)}},t);this.token&&(u.headers.token=this.token),$.ajax(u)}var n="sendMsg",r="verMsg",i="getUuid",s="notoken",o="getCode",a=Backbone.Model.extend({initialize:function(e){this.baseUrl=e.baseUrl,this.token=e.token},sendMsg:function(e,t){var r=this;e=e||{},e.url=this.baseUrl+"/common/sendMsg",u.call(this,e,t,n)},verMsg:function(e,t){var n=this;e=e||{},e.url=this.baseUrl+"/common/verMsg",u.call(this,e,t,r)},getUuid:function(e,t){var n=this;e=e||{},e.type="get",e.dataType="text",e.url=this.baseUrl+"/common/uuid",u.call(this,e,t,i)},getSecurityCode:function(e,t){var n=this;e=e||{},e.url=this.baseUrl+"/common/getSecurityCode",u.call(this,e,t,o)}});return a}),define("root-common/module/phone-check/main",["text!./main.tpl","../../util","../../module/popup","./model","../../module/cookie"],function(e,t,n,r,i){var s="afterVer",o="validate",u=Backbone.View.extend({initialize:function(t){var n=this;n._tpl=doT.template(t.tpl||e),n._model=new r(t),n._type=t.type,n._isSending=!1,n._sendTimer=null,n._uuid=null,n._hasName=t.hasName,n._getUuid(),n._model.bind({verMsg:$.proxy(n.verMsg,n),sendMsg:$.proxy(n.sendMsg,n),getUuid:$.proxy(n.getUuid,n)}),n.render()},events:{"submit .form-validate-phone":"_validate","click .btn-sendcode":"_sendPhone","click .icon-loop":"_getUuid"},render:function(e){var t=this;t.$el.html(t._tpl({}))},reset:function(){this._sendTimer&&clearInterval(this._sendTimer),this._isSending=!1,this._uuid=null},_getUuid:function(){this._model.getUuid()},_validate:function(e){var t=this,n=this.validate($(e.currentTarget)).form();t.trigger(o),e.preventDefault();if(n){var r={type:t._type,mobile:$('input[name="phone"]',t.$el).val(),code:$('input[name="dynamicCode"]',t.$el).val()};t._hasName&&(r.name=$('input[name="name"]',t.$el).val()),t._model.verMsg({type:"post",data:r})}return!1},validate:function(e){var t=this,n={phone:{required:!0,isTelephone:!0},dynamicCode:{required:!0,isCode:!0}},r={phone:{required:"手机号不能为空",isTelephone:"手机号格式不正确"},dynamicCode:{required:"动态码不能为空",isCode:"请输入6位数字动态码"}};return t._hasName&&(n.name={required:!0},r.name={required:"用户名不能为空"}),e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.closest(".form-control").find(".form-error"))},rules:n,messages:r})},_sendPhone:function(e){e.preventDefault();var n=this,r=/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,i=$(e.currentTarget);if(!n._isSending){var s=$('input[name="phone"]',n.$el).val(),o=$('input[name="code"]',n.$el).val();r.test(s)?n._model.sendMsg({type:"post",data:{type:n._type,mobile:s,inputCode:o,uuid:n._uuid}},{node:i}):t.errorTip("手机号格式不正确",!0)}},sendMsg:function(e,n,r,i){var s=this;t.dealAjax(function(n){var r=e.data;if(!n){var o=i.node;o.addClass("btn-disabled"),t.successTip(e.resMsg,!0);var u=60,a=$(".nosend .num",s.$el).text(u);s._sendTimer&&clearInterval(s._sendTimer),s._sendTimer=setInterval(function(){a.text(--u),u||(clearInterval(s._sendTimer),o.removeClass("btn-disabled"),s._isSending=!1)},1e3),s._isSending=!0}else $('input[name="code"]',s.$el).val(""),s._isSending=!1;s._getUuid()},e,n)},verMsg:function(e,n,r,i){var o=this;t.dealAjax(function(n){var r=e.data;n?t.errorTip(e.resMsg,!0):o.trigger(s,r)},e,n)},getUuid:function(e,t,n,r){var i=this;i._uuid=e,i._setCode(e)},_setCode:function(e){var t=this,n=window.serviceBase+"/common/getSecurityCode?uuid="+e+"&t="+ +(new Date);$(".img-code",t.$el).html('<img src="'+n+'" />')}});return u}),define("phonefind",["text!root-tpl/find-pw/action.tpl","text!root-tpl/find-pw/update-pw.tpl","text!root-tpl/find-pw/choice.tpl","root-common/module/cookie","./model","root-common/util","root-common/module/popup","root-common/module/pay/main","root-common/module/phone-check/main"],function(e,t,n,r,i,s,o,u,a){var f="getUserInfo",l=Backbone.View.extend({initialize:function(){var r=this;r._actionTpl=doT.template(e),r._updatepwTpl=doT.template(t),r._choiceTpl=doT.template(n),r._model=new i,r._model.bind({changePwByKey:$.proxy(r.changePwByKey,r)}),r._pop=null,r._key=null,r._phoneCheck=null},reset:function(){this.$el.html(""),this._pop&&this._pop.close(),this._key=null,this.stopListening()},events:{"submit .form-updatepw":"_validate","click .btn-logout":"_back","click .btn-backtosign":"_backtosign"},_back:function(){var e=this;e.reset(),e.init()},_backtosign:function(){var e=this;e.reset(),window.location.href="#"},render:function(e){var t=this;t.$el.html(t._choiceTpl({}));var n=t._pop=o.create({title:"提示",custom:'<div class="findpw-area"></div>',mask:!0,hasHd:!1});t.setElement(n.$el),t._phoneCheck=new a({el:$(".findpw-area",t.$el),baseUrl:window.serviceBase,token:r("hzw_reading_token"),type:3}),t._phoneCheck.bind({afterVer:$.proxy(t.afterVer,t)}),$(".action",t.$el).html(t._actionTpl({})),n.resize()},init:function(){var e=this;e.render()},afterVer:function(e){var t=this;t._key=e.uuid,$(".findpw-area",t.$el).html(t._updatepwTpl({})),t._pop.resize()},_validate:function(e){var t=this,n=this.validate($(e.currentTarget)).form();return e.preventDefault(),n&&t._model.changePswByKey({type:"post",data:{key:t._key,password:$('input[name="pw"]',t.$el).val()}}),!1},validate:function(e){var t=this;return e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.closest(".form-control").find(".form-error"))},rules:{pw:{required:!0,ispw:!0},cpw:{required:!0,isCpw:!0}},messages:{pw:{required:"密码不能为空",ispw:'6~20位小写英文、数字或"_"的组合'},cpw:{required:"确认密码不能为空",isCpw:"两次输入不一致"}}})},changePwByKey:function(e,t,n,i){var o=this;s.dealAjax(function(t){var n=e.data;t||(s.tip("修改成功",!0),r("hzw_reading_token","",{expires:-1}),window.location.href="#")},e,t)}});return l}),define("text!root-tpl/phone/main.tpl",[],function(){return'<div class="bg2"></div>\n'}),define("text!root-tpl/phone/action.tpl",[],function(){return'<div class="form-control fix"> \n   <input class="btn btn-confirm" type="submit" value="确&nbsp;&nbsp;&nbsp;&nbsp;定" />\n   {{ if(!it.isTeacher){ }}\n   <a href="#product" class="btn btn-skip">跳过验证</a>\n   {{ }else{ }}\n   <button class="btn btn-logout">返回</button>\n   {{ } }}\n   \n</div>\n{{ if(!it.isTeacher){ }}\n<div class="form-control fix">\n	<span class="highlight">建议进行手机号码验证 ，否则无法使用找回密码功能哦 ^_^</span>\n</div>\n{{ } }}'}),define("phone",["text!root-tpl/phone/main.tpl","text!root-tpl/phone/action.tpl","root-common/util","root-common/module/popup","./model","root-common/module/cookie","root-common/module/phone-check/main"],function(e,t,n,r,i,s,o){var u=Backbone.View.extend({initialize:function(n){var r=this;r._tpl=doT.template(e),r._actionTpl=doT.template(t),r._pop=null,r._page=$(n.el),r._el=n.el,r._phoneCheck=null},events:{"click .btn-logout":"_logout"},reset:function(){this._page.html(""),this.setElement(this._el),this.$el.html(""),this._pop&&this._pop.close(),this.stopListening(),this._phoneCheck.reset()},init:function(){},render:function(e){var t=this;if(e.userPhone){window.location.href="#product";return}t.$el.html(t._tpl({}));var n=t._pop=r.create({title:"提示",custom:'<div class="phone-area"></div>',mask:!0,hasHd:!1});t.setElement(n.$el),t._phoneCheck=new o({el:$(".phone-area",t.$el),baseUrl:window.serviceBase,token:s("hzw_reading_token"),type:1}),t._phoneCheck.bind({notoken:$.proxy(t._logout,t),afterVer:function(){window.location.href="#product"}}),$(".action",t.$el).html(t._actionTpl({isTeacher:e.roleId=="42"})),n.resize()},getUserInfo:function(e){this.render(e)},_logout:function(e){e&&e.preventDefault(),s("hzw_reading_token","",{expires:-1}),window.location.href="#"}});return u}),define("text!root-tpl/product.tpl",[],function(){return'<div class="bg">\n	<div class="p-container">\n		<div class="newbtn fix">\n			<p class="btn-manuals">写作手册</p> \n			<p class="p-userNews btn-user">用户信息管理</p> \n		</div>\n		\n		<div class="menu-box menu-writing into" rol-stat="1" data-stat="5">\n			<div class="menu-box-icon" >\n				<p class="clearfix bshadow0 pbs">\n					<i class="icon-linear icon-writing">\n	            		&#xe905;\n	                </i>\n	            </p>\n				<p>Writing</p>\n			</div>\n			<p class="menu-btn ">马上参与>></p>\n		</div>\n		<div class="menu-box menu-reading" rol-stat="1" data-stat="6">\n			<div class="menu-box-icon" >\n				<p class="clearfix bshadow0 pbs">\n						<i class="icon-linear icon-reading">\n	            		&#xe906;\n	                </i>\n	            </p>\n				<p>Reading</p>\n			</div>\n			<p class="menu-btn" >立即体验>></p>\n		</div>\n		<div class="menu-box menu-reading2" data-video="{{=it.video}}">\n			<div class="menu-box-icon" >\n				<i class="no-public"></i>\n				<i class="icon-linear icon-play">&#xe907;</i>\n				<p class="clearfix bshadow0 pbs">\n						<i class="icon-linear icon-reading">\n	            		&#xe906;\n	                </i>\n	            </p>\n				<p>Reading</p>\n				<p class="desc">（学校版）</p>\n			</div>\n			<p class="menu-btn" >请联系学校</p>\n		</div>\n	</div>\n	<div class="ui-video"></div>\n</div>'}),define("root-common/module/stat/main",[],function(){var e=_.extend({getRequest:function(e,t){$.ajax({url:e,cache:!1,headers:{token:t}})},param:function(e){var t=[];return $.each(e,function(e,n){n!==""&&t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.join("&")},send:function(e,t,n){var r={};e=e||{},r=$.extend(!0,{},r,e),this.getRequest(t+"?"+this.param(r),n)}},Backbone.Events);return e}),define("stat",["root-common/module/stat/main","root-common/module/cookie"],function(e,t){var n=_.extend({send:function(n){try{var r=t("hzw_reading_token");url=n.url,data=n.data,url=window.serviceBase+url,e.send(data,url,r)}catch(i){}}},Backbone.Events);return n}),define("text!root-tpl/video.tpl",[],function(){return'<div class="inner">\n	<div class="mask"></div>\n	<div class="video-main">\n		<video id="{{=it.id}}" class="video-js vjs-default-skin" controls preload="none" width="780" height="430" poster="" data-setup="{}">\n			<source src="/intro/{{=it.video}}" type="video/mp4" />\n			<p class="vjs-no-js">请升级您的浏览器至IE9以上</p>\n		</video>\n	</div>\n	<i class="icon-linear video-close">&#xe903;</i>\n</div>\n'}),define("root-common/md5",[],function(){(function(e){var t=function(e,t){return e<<t|e>>>32-t},n=function(e,t){var n,r,i,s,o;return i=e&2147483648,s=t&2147483648,n=e&1073741824,r=t&1073741824,o=(e&1073741823)+(t&1073741823),n&r?o^2147483648^i^s:n|r?o&1073741824?o^3221225472^i^s:o^1073741824^i^s:o^i^s},r=function(e,t,n){return e&t|~e&n},i=function(e,t,n){return e&n|t&~n},s=function(e,t,n){return e^t^n},o=function(e,t,n){return t^(e|~n)},u=function(e,i,s,o,u,a,f){return e=n(e,n(n(r(i,s,o),u),f)),n(t(e,a),i)},a=function(e,r,s,o,u,a,f){return e=n(e,n(n(i(r,s,o),u),f)),n(t(e,a),r)},f=function(e,r,i,o,u,a,f){return e=n(e,n(n(s(r,i,o),u),f)),n(t(e,a),r)},l=function(e,r,i,s,u,a,f){return e=n(e,n(n(o(r,i,s),u),f)),n(t(e,a),r)},c=function(e){var t,n=e.length,r=n+8,i=(r-r%64)/64,s=(i+1)*16,o=Array(s-1),u=0,a=0;while(a<n)t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|e.charCodeAt(a)<<u,a++;return t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|128<<u,o[s-2]=n<<3,o[s-1]=n>>>29,o},h=function(e){var t="",n="",r,i;for(i=0;i<=3;i++)r=e>>>i*8&255,n="0"+r.toString(16),t+=n.substr(n.length-2,2);return t},p=function(e){e=e.replace(/\x0d\x0a/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t};e.extend({md5:function(e){var t=Array(),r,i,s,o,d,v,m,g,y,b=7,w=12,E=17,S=22,x=5,T=9,N=14,C=20,k=4,L=11,A=16,O=23,M=6,_=10,D=15,P=21;e=p(e),t=c(e),v=1732584193,m=4023233417,g=2562383102,y=271733878;for(r=0;r<t.length;r+=16)i=v,s=m,o=g,d=y,v=u(v,m,g,y,t[r+0],b,3614090360),y=u(y,v,m,g,t[r+1],w,3905402710),g=u(g,y,v,m,t[r+2],E,606105819),m=u(m,g,y,v,t[r+3],S,3250441966),v=u(v,m,g,y,t[r+4],b,4118548399),y=u(y,v,m,g,t[r+5],w,1200080426),g=u(g,y,v,m,t[r+6],E,2821735955),m=u(m,g,y,v,t[r+7],S,4249261313),v=u(v,m,g,y,t[r+8],b,1770035416),y=u(y,v,m,g,t[r+9],w,2336552879),g=u(g,y,v,m,t[r+10],E,4294925233),m=u(m,g,y,v,t[r+11],S,2304563134),v=u(v,m,g,y,t[r+12],b,1804603682),y=u(y,v,m,g,t[r+13],w,4254626195),g=u(g,y,v,m,t[r+14],E,2792965006),m=u(m,g,y,v,t[r+15],S,1236535329),v=a(v,m,g,y,t[r+1],x,4129170786),y=a(y,v,m,g,t[r+6],T,3225465664),g=a(g,y,v,m,t[r+11],N,643717713),m=a(m,g,y,v,t[r+0],C,3921069994),v=a(v,m,g,y,t[r+5],x,3593408605),y=a(y,v,m,g,t[r+10],T,38016083),g=a(g,y,v,m,t[r+15],N,3634488961),m=a(m,g,y,v,t[r+4],C,3889429448),v=a(v,m,g,y,t[r+9],x,568446438),y=a(y,v,m,g,t[r+14],T,3275163606),g=a(g,y,v,m,t[r+3],N,4107603335),m=a(m,g,y,v,t[r+8],C,1163531501),v=a(v,m,g,y,t[r+13],x,2850285829),y=a(y,v,m,g,t[r+2],T,4243563512),g=a(g,y,v,m,t[r+7],N,1735328473),m=a(m,g,y,v,t[r+12],C,2368359562),v=f(v,m,g,y,t[r+5],k,4294588738),y=f(y,v,m,g,t[r+8],L,2272392833),g=f(g,y,v,m,t[r+11],A,1839030562),m=f(m,g,y,v,t[r+14],O,4259657740),v=f(v,m,g,y,t[r+1],k,2763975236),y=f(y,v,m,g,t[r+4],L,1272893353),g=f(g,y,v,m,t[r+7],A,4139469664),m=f(m,g,y,v,t[r+10],O,3200236656),v=f(v,m,g,y,t[r+13],k,681279174),y=f(y,v,m,g,t[r+0],L,3936430074),g=f(g,y,v,m,t[r+3],A,3572445317),m=f(m,g,y,v,t[r+6],O,76029189),v=f(v,m,g,y,t[r+9],k,3654602809),y=f(y,v,m,g,t[r+12],L,3873151461),g=f(g,y,v,m,t[r+15],A,530742520),m=f(m,g,y,v,t[r+2],O,3299628645),v=l(v,m,g,y,t[r+0],M,4096336452),y=l(y,v,m,g,t[r+7],_,1126891415),g=l(g,y,v,m,t[r+14],D,2878612391),m=l(m,g,y,v,t[r+5],P,4237533241),v=l(v,m,g,y,t[r+12],M,1700485571),y=l(y,v,m,g,t[r+3],_,2399980690),g=l(g,y,v,m,t[r+10],D,4293915773),m=l(m,g,y,v,t[r+1],P,2240044497),v=l(v,m,g,y,t[r+8],M,1873313359),y=l(y,v,m,g,t[r+15],_,4264355552),g=l(g,y,v,m,t[r+6],D,2734768916),m=l(m,g,y,v,t[r+13],P,1309151649),v=l(v,m,g,y,t[r+4],M,4149444226),y=l(y,v,m,g,t[r+11],_,3174756917),g=l(g,y,v,m,t[r+2],D,718787259),m=l(m,g,y,v,t[r+9],P,3951481745),v=n(v,i),m=n(m,s),g=n(g,o),y=n(y,d);var H=h(v)+h(m)+h(g)+h(y);return H.toLowerCase()}})})(jQuery)}),define("product",["text!root-tpl/product.tpl","./model","root-common/module/popup","root-common/util","root-common/module/cookie","./stat","text!root-tpl/video.tpl","root-common/md5"],function(e,t,n,r,i,s,o){var u=Backbone.View.extend({initialize:function(){var n=this;n._tpl=doT.template(e),n._videoTpl=doT.template(o),n._model=new t,n._isStudent=!1,n.status=0,n._bookId=null,n._video=null,n._isFreeRegister=null,$(window).resize(function(){n._pop&&n._pop.resize()}),n._hasGrade=undefined},reset:function(){this.$el.html(""),this.stopListening(),this._video=null,this._isStudent=!1,this._hasGrade=undefined},events:{"click [rol-stat]":"_statArrow","click .btn-user":"showUser","click .icon-play":"_playVideo","click .video-close":"_closeVideo","click .btn-manuals":"_manuals"},_manuals:function(e){e.preventDefault();var t=this,n="/intro/";n+=t._isStudent?"manuals-student.pdf":"manuals-teacher.pdf",window.open(n,"_blank")},init:function(){var e=this,t=i("hzw_reading_token");t||(window.location.href="#")},render:function(){var e=this,t=i("hzw_reading_token");e.$el.html(e._tpl({}))},setVideo:function(e){var t=this;t._isFreeRegister=e.userRegisterType=="8",e.roleId=="42"?t._video="reading-teacher.mp4":(t._isStudent=!0,t._video="reading-student.mp4"),t._hasGrade=e.gradeId,t.render()},showUser:function(){var e=this;window.location.href="#information"},_statArrow:function(e){var t=this,n=$(e.currentTarget).data("stat");s.send({url:"/user/log",data:{type:"product",data:'{"product_id":"'+n+'","info":""}'}}),t.goJump(n)},goJump:function(e){var n=this;e=="6"?n._hasGrade?window.location.href="#booklist":window.location.href="#grade":n._isFreeRegister?window.location.href=window.staticsBase+"/writing/student/index.html?token="+i("hzw_reading_token")+"&url="+encodeURIComponent(window.location.href):window.location.href=window.writeBase+"/service/LoginAction/login?un="+t.data.userInfo.userName+"&token="+t.data.userInfo.token+"&key="+$.md5(t.data.userInfo.userName+t.data.userInfo.token)},_playVideo:function(e){var t=this;if(t._video){var n=window.staticsBase+"/common/scripts/lib/video/video.min.js";require([n],function(e){var n="video"+ +(new Date);$(".ui-video",t.$el).html(t._videoTpl({video:t._video,id:n})),t._isRenderVideo=!0,e(n).ready(function(){this.play()})})}},_closeVideo:function(){$(".ui-video",this.$el).html("")}});return u}),define("text!root-tpl/header.tpl",[],function(){return'<div class="hd-mask"></div>\n<div class="hd-main">\n	<a class="logo"></a>\n	<div class="user-info">\n		欢迎您 {{=it.userInfo.schoolName || \'\'}} {{=it.userInfo.gradeName || \'\'}} {{=it.userInfo.classesName || \'\'}} {{=it.userInfo.userRealName || \'\'}}!\n		<span class="balance">\n			<i></i>\n			<span class="amount">{{=it.userInfo.amount}}</span>\n		</span>\n		<a class="btn-trade" href="javascript:;">\n			交易记录\n		</a>\n	</div>\n	<div class="user-control">\n		<a href="javascript:;" class="ui-btn btn-home">\n			<i class="icon-solid">&#xe601;</i>首页\n		</a>\n		<a href="javascript:;" class="ui-btn btn-logout">\n			<i class="icon-solid">&#xe603;</i>退出\n		</a>\n	</div>\n</div>\n'}),define("text!root-tpl/trade/main.tpl",[],function(){return'<a href="javascript:;" class="btn-close"></a>\n<div class="inner">\n	<div class="hd">交易记录</div>\n	<div class="tab-nav">\n		<ul>\n			<li class="nav-item">消费记录</li>\n			<li class="nav-item active">充值记录</li>\n		</ul>\n	</div>\n	<div class="tab-panel">\n		<ul>\n			<li class="panel-item">\n				\n			</li>	\n			<li class="panel-item">\n				\n			</li>\n		</ul>\n	</div>\n	\n</div>\n'}),define("text!root-tpl/trade/consume-list.tpl",[],function(){return'{{ if(it.list.length){ }}\n	{{~it.list :v:i}}\n	<div class="trade-item">\n		<span class="time">{{=it.release(v.buy_time)}}</span>\n		<span class="info">{{=v.info}}</span>\n		<span class="count">-{{=v.gold_num}}</span>\n	</div>\n	{{~}}\n	<div class="pagi"></div>\n{{ }else{ }}\n	<div class="noitem">暂无记录</div>\n{{ } }}\n'}),define("text!root-tpl/trade/recharge-list.tpl",[],function(){return'{{ if(it.list.length){ }}\n	{{~it.list :v:i}}\n	<div class="trade-item">\n		<span class="time">{{=it.release(v.pay_time)}}</span>\n		<span class="info">{{=v.order_type == 1 ? \'支付宝\' : \'微信\'}}</span>\n		<span class="count">+{{=v.total_fee}}</span>\n	</div>\n	{{~}}\n	<div class="pagi"></div>\n{{ }else{ }}\n	<div class="noitem">暂无记录</div>\n{{ } }}\n'}),define("root-common/module/tab",[],function(){var e="switch",t={btns:"",panels:"",type:"click",index:0},n="active",r="select",i=Backbone.View.extend({initialize:function(e){var n=this,e=n.config=$.extend({},t,e);n.index=n.config.index,n.$nav=$(e.btns).bind(e.type,$.proxy(n.change,n)),n.$main=$(e.panels),n.init()},init:function(){var e=this;e.show(e.config.index)},_index:function(e){var t=this,n=$(e.target),r=n.closest("li"),i=t.$nav.index(r);return i},change:function(t){t.preventDefault();var n=this,r=n._index(t);n.show(r),n.trigger(e,r)},show:function(e){var t=this,i=t.$nav.eq(e);t.index=e,setTimeout(function(){t.trigger(r,e)},0),t.$nav.removeClass(n),i.addClass(n),t.$main.hide().eq(e).show()},getIndex:function(){return this.index}});return i}),define("text!root-common/module/pagination.tpl",[],function(){return'<ul class="pagination">\n{{ if(it.total > 1){ }}\n    <li class="page pagi-first">\n        <a href="#">首页</a>\n    </li>\n    {{ if(it.current > 1){ }}\n    <li class="page pagi-prev">\n        <a href="#">\n            <span class="txt">上一页</span>\n            <span class="icon-linear">&#xe607;</span>\n        </a>\n    </li>\n    {{ } }}\n    {{ for(var i = 0; i < it.total; i++){ }}\n    <li class="page\n    {{ if(i == it.current - 1){ }}active{{ } }}\n    " rel="{{=i+1}}"><a href="#">{{=i+1}}</a></li>\n    {{ } }}\n    {{ if(it.current < it.total){ }}\n    <li class="page pagi-next">\n        <a href="#">\n            <span class="txt">下一页</span>\n            <span class="icon-linear">&#xe609;</span>\n        </a>\n    </li>\n    {{ } }}\n    <li class="page pagi-last">\n        <a href="#">末页</a>\n    </li>\n    <input class="pagi-which" type="text" />\n    <span class="pagi-go">跳转</span>\n{{ } }}\n</ul>'}),define("root-common/module/pagination",["text!./pagination.tpl"],function(e){var t=Backbone.View.extend({initialize:function(t){t.total=t.total||1,t.current=t.current||1,this.options=t,this._tpl=doT.template(e),this.render()},events:{"click .page":"_go","click .pagi-go":"_direct","click .pagi-first":"_goFirst","click .pagi-last":"_goLast"},_go:function(e){e.preventDefault();var t=this,n=$(e.currentTarget);if(n.hasClass("pagi-prev"))t.prev();else if(n.hasClass("pagi-next"))t.next();else{var r=parseInt($.trim(n.attr("rel")));/\d+/.test(r)&&t.go(parseInt(r))}},_direct:function(e){e.preventDefault();var t=$(".pagi-which",this.$el).val();try{t=parseInt(t),t<=this.options.total&&this.go(t)}catch(e){}},_goFirst:function(e){e.preventDefault(),this.go(1)},_goLast:function(e){e.preventDefault(),this.go(this.options.total)},render:function(){this.$el.html(this._tpl(this.options))},reset:function(e){e&&$.extend(this.options,e),this.render()},total:function(e){return e!==undefined&&(this.options.total=e),this.options.total},current:function(e){return e!==undefined&&(this.options.current=e),this.options.current},go:function(e,t){return this.current(e),this.reset(),t&&t(this.options.current),this.trigger("toggle",e),this},prev:function(e){return this.options.current>1&&this.go(this.options.current-1,e),this},next:function(e){return this.options.current<this.options.total&&this.go(this.options.current+1,e),this},first:function(){return this.options.current>1&&this.go(1),this},last:function(){return this.options.current<this.options.total&&this.go(this.options.total),this}});return t}),define("trade",["./model","text!root-tpl/trade/main.tpl","text!root-tpl/trade/consume-list.tpl","text!root-tpl/trade/recharge-list.tpl","root-common/module/popup","root-common/module/tab","root-common/module/pagination","root-common/util"],function(e,t,n,r,i,s,o,u){var a="getUserInfo",f=Backbone.View.extend({initialize:function(){var i=this;i._tpl=doT.template(t),i._consumeTpl=doT.template(n),i._rechargeTpl=doT.template(r),i._model=new e,i._model.bind({tradeGold:$.proxy(i.consume,i),tradeRecharge:$.proxy(i.recharge,i)}),i.pageSize=10,i.pageNum=1,i.total=0,i.isConsume=!0,i.data=null,i.activeIndex=0,i.currentPage=1,i.render()},events:{"click .btn-close":"close"},close:function(){this.pop.close()},render:function(){var e=this,t=e.pop=i.create({custom:e._tpl({}),hasHd:!1,isMove:!1,mask:!0,className:"ui-trade"});e.setElement(t.$el);var n=new s({btns:$(".nav-item",e.$el),panels:$(".panel-item",e.$el)});n.bind({select:function(t){e.activeIndex=t,e.isConsume=t==0?!0:!1,e.load()}})},load:function(e){var t=this;t.currentPage=e!==undefined?e:t.pageNum;var n=t.isConsume?"tradeGold":"tradeRecharge";t._model[n]({data:{pageSize:t.pageSize,pageNum:t.currentPage}})},renderList:function(){var e=this,t=e.isConsume?e._consumeTpl:e._rechargeTpl,n=$(".panel-item",e.$el).eq(e.activeIndex).html(t({list:e.data||[],release:u.release})),r=new o({el:$(".pagi",n),total:e.total,current:e.currentPage});r.bind("toggle",function(t){e.load(t)})},consume:function(e,t,n,r){var i=this;u.dealAjax(function(t){var n=e.data.goldDetailRollPage;t||(i.data=n.resultList,i.total=Math.ceil(n.iTotalRecords/n.pageSize),i.renderList())},e,t)},recharge:function(e,t,n,r){var i=this;u.dealAjax(function(t){var n=e.data.rechargeDetailRollPage;t||(i.data=n.resultList,i.total=Math.ceil(n.iTotalRecords/n.pageSize),i.renderList())},e,t)}});return f}),define("header",["text!root-tpl/header.tpl","text!root-tpl/trade/main.tpl","root-common/module/cookie","./model","root-common/util","root-common/module/pay/main","./trade"],function(e,t,n,r,i,s,o){var u="getUserInfo",a=Backbone.View.extend({initialize:function(){var n=this;n._tpl=doT.template(e),n._tradeTpl=doT.template(t),n._model=new r,n._model.bind({getUserInfo:$.proxy(n.getUserInfo,n)})},events:{"click .btn-logout":"_logout","click .btn-home":"_btnhome","click .user-info .balance":"recharge","click .btn-trade":"showTrade"},render:function(e){var t=this;t.$el.show(),t.$el.html(this._tpl({userInfo:e}))},reset:function(){this.$el.hide()},init:function(){var e=this,t=n("hzw_reading_token");t&&e._model.getUserInfo({token:t})},_btnhome:function(e){e.preventDefault(),window.audioPlay.click(),window.location.href="#product"},_logout:function(e){e.preventDefault(),window.audioPlay.click(),n("hzw_reading_token","",{expires:-1}),window.location.href="#"},getUserInfo:function(e,t,n,r){var s=this;i.dealAjax(function(t){var n=e.data;t||(s.render(n),s.trigger(u,n))},e,t)},recharge:function(e){e.preventDefault();var t=this,r=new s({coin:1,baseUrl:window.serviceBase,token:n("hzw_reading_token")});r.init(1),r.bind("success",function(e){$(".amount",t.$el).text(e)}),window.audioPlay.click()},showTrade:function(e){e.preventDefault();var t=new o}});return a}),define("text!root-common/module/reading/main.tpl",[],function(){return""}),define("root-common/module/reading/main",["text!./main.tpl"],function(e){var t="readover",n="change.page",r=Backbone.View.extend({initialize:function(t){var n=this;n._tpl=doT.template(e),n._data=t.data,n._height=0,n._width=0,n._top=30,n._left=0,n._padding=35,n.$book=$(".content-main",n.$el),n._activeAudio=null,n._currentPage=2,n.timer=null,n._recordPlayTimer=null,n._autoPlayAudio=null,n._historyPlay=[]},reset:function(){var e=this;e.timer&&clearTimeout(e.timer),e._recordPlayTimer&&clearInterval(e._recordPlayTimer)},events:{"mouseenter .sentence":"_showAudio","mouseleave .sentence":"_hideAudio","mousedown .sentence":"_showAudio","click .icon-audio":"_playAudio","mouseup .btn-next":"_readover"},resize:function(e,t){var r=this;r._height=t,r._width=e-r._padding*2,r.$book.html(""),r.setPage(),$(".page p").each(function(){$(this).html()==""&&$(this).remove()}),r.$book.booklet({width:r._width-r._left*2,height:r._height-r._top*2,next:$(".btn-next",r.$el),prev:$(".btn-prev",r.$el),pagePadding:0,hoverWidth:0});var i=$(".page",r.$el).length;$(".b-counter",r.$el).each(function(e){e>=i&&$(this).hide()});var s=$(".b-counter",r.$el).append("/"+i);r.$book.bind("bookletchange",function(e,t){r._recordPlayTimer&&clearInterval(r._recordPlayTimer),$(".playing",r.$el).removeClass("playing");var i=t.index+2;r._currentPage=i,r._autoPlayAudio=null,r._historyPlay=[],r.trigger(n)}),$(".b-wrap-left",r.$el).parent().addClass("b-page-left"),$(".b-wrap-right",r.$el).parent().addClass("b-page-right")},renderText:function(e){var t=this,n=e.sentenceO.pic;if(e.sentenceO.content&&!e.isOverflow){e.$s=$('<span class="sentence" />').appendTo(e.$p),e.$s.attr({"data-recording":e.sentenceO.recordingpath||"","data-id":e.sentenceO.id}),e.sentenceO.recordingpath&&e.$s.append('<i class="icon-solid icon-audio">&#xe602;</i>');var r=e.sentenceO.content,i=r.split(/\s+/);e.tmp[e.i][e.j].words=i.slice(),$.each(i,function(r,i){if(i){var s=$('<i class="word">'+i+" </i>").appendTo(e.$s);e.isOverflow=t._checkOverflow(e.$page);if(e.isOverflow){var o=e.$p.height();return e.tmp=t._getOverplus(e.tmp,e.i,e.j,r,n,o),t.setPage(e.tmp),n&&o<t._height-t._top*2?e.$s.remove():(s.remove(),e.$s.find(".word").length==0&&e.$s.remove()),!1}}})}return e.isOverflow},renderPic:function(e){var t=this,n=e.sentenceO.pic;if(n&&!e.isOverflow){var r=t._insertParagraph(e.$page),i=$('<img src="'+window.imgPath+n+'" />').appendTo(r).attr({"data-id":e.sentenceO.id}),s=e.sentenceO.picwidthandheight;r.addClass("p-pic");if(!s){var o=i.width();s=o+"*"+o*9/16}var u=t.getPicSize(s,i.width());i.css({width:u.width,height:u.height}),e.isOverflow=t._checkOverflow(e.$page);if(e.isOverflow){if(e.$s)var a=e.$s.outerHeight()+r.height()+20;else var a=r.height();return e.tmp=t._getOverplus(e.tmp,e.i,e.j,undefined,n,a),a<t._height-t._top*2&&e.$s&&e.$s.remove(),r.remove(),t.setPage(e.tmp),e.isOverflow}e.tmp[e.i][e.j].pic="",e.$p=t._insertParagraph(e.$page)}return e.isOverflow},setPage:function(e){var t=this;e=e||t._data;var n=$.extend(!0,[],e),r=t._insertPage(),i=!1;$.each(e,function(e,s){if($.type(s)=="array"&&s.length>0&&!i){var o=t._insertParagraph(r);$.each(s,function(s,u){if($.type(u)=="object"&&!i){var a=u.pic,f,l={tmp:n,sentenceO:u,isOverflow:i,$page:r,$p:o,$s:f,i:e,j:s};u.picpostion==1&&u.pic?(t.renderPic(l),t.renderText(l)):(t.renderText(l),t.renderPic(l)),i=l.isOverflow,u=l.sentenceO,n=l.tmp,r=l.$page,o=l.$p,f=l.$s}})}})},getPicSize:function(e,t){var n=this;e=e.split("*");var r=e[0],i=e[1],s=.82;r==0&&(r=t,i=t*9/16);var o=t,u=o*i/r,a=n._height-n._top*2;return console.log(a,u),u>=a*.9&&(u=s*a,o=u*r/i),{width:o,height:u}},_getOverplus:function(e,t,n,r,i,s){var o=this;return $.each(e,function(u,a){u<t?e.splice(u,1,[]):u==t&&n!==undefined&&$.each(a,function(e,t){e<n&&(t.content="",delete t.words),e==n&&(i?s>=o._height-o._top*2&&(t.content="",delete t.words):(r&&t.words&&(t.words=t.words.slice(r),t.content=t.words.join(" ")),r===undefined&&(t.content="",delete t.words)))})}),e},_insertPage:function(){var e=this,t=$('<div class="page" />').appendTo(e.$book);return $(".page",e.$el).css({width:e._width/2-e._left*2}),t},_insertParagraph:function(e){return $("<p />").appendTo(e)},_checkOverflow:function(e){var t=this,n=Math.ceil(t._height-t._top*2);return e.height()>n?!0:!1},_getAudio:function(e){return $('<audio controls="controls" unselectable="on" preload="true"><source src="'+window.imgPath+e+'" type="audio/mpeg"></audio>')},_showAudio:function(e){var t=this;e.stopPropagation();var n=$(e.currentTarget),r=$(".sentence",t.$el),i=r.index(n);t.showAudio(n),t.showAudio(r.eq(i+1)),t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){$(".icon-audio",t.$el).hide(),$(".icon-audio",n).show()},100)},showAudio:function(e){var t=this,n=e.data("recording"),r=e.data("hasrender");if(n&&!r){var i=t._getAudio(n);i.appendTo(e),e.data("hasrender",1)}},_hideAudio:function(e){var t=this,n=$(e.currentTarget);t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){$(".icon-audio",t.$el).hide()},100)},_playAudio:function(e){var t=this,n=$(e.currentTarget),r=n.parent(),i=r.find("audio");t.playAudio(i)},playAudio:function(e,t,n,r){var i=this,s=e[0],o=e.parent(),u=o.find(".icon-audio");if(s&&s.play){i._activeAudio&&(i._activeAudio.pause(),i._activeAudio.currentTime=0);if(t&&i._historyPlay.indexOf(s.currentSrc)!==-1){var a=n+1;a<t.length?i.playAudio(t.eq(a),t,a,r):r&&r()}else{s.play(),i._activeAudio=s,u.hide(),$(".playing",i.$el).removeClass("playing"),o.addClass("playing");try{var f=$(".sentence audio",i.$el).index($(s)),l=$(".sentence audio",i.$el).eq(f+1)[0],c=s.currentSrc==l.currentSrc;c&&$(l).closest(".sentence").addClass("playing")}catch(h){}t&&i._historyPlay.push(s.currentSrc),i._recordPlayTimer&&clearInterval(i._recordPlayTimer),i._recordPlayTimer=setInterval(function(){if(s.ended){$(".playing",i.$el).removeClass("playing");var e=n+1;clearInterval(i._recordPlayTimer),t&&e<t.length?i.playAudio(t.eq(e),t,e,r):r&&r()}},30)}}},_readover:function(){var e=this;$(".page",e.$el).length<=e._currentPage&&(e.reset(),e.trigger(t))},autoPlay:function(e,t){var n=this;if(!e){var e=n._currentPage;e-=2}var r=n._autoPlayAudio,i=0;r&&!t&&(e=$(".b-page").index($(r).closest(".b-page")));var s=$(".b-page").eq(e);s.find(".sentence").each(function(e){n.showAudio($(this))}),$(".b-page").eq(e+1).find(".sentence").each(function(e){n.showAudio($(this))});var o=s.find("audio");r&&!t&&(i=o.index($(r))),n.playAudio(o.eq(i),o,i,function(){var t=e+1;if($(".page",n.$el).length==t)return;t%2==0?($(".btn-next",n.$el).trigger("click"),setTimeout(function(){n.autoPlay(e+1,!0)},2e3)):n.autoPlay(e+1,!0)})},pauseAudio:function(){var e=this;e._activeAudio&&(e._activeAudio.pause(),e._activeAudio.currentTime=0),e._autoPlayAudio=e._activeAudio,$(".playing",e.$el).removeClass("playing"),e._recordPlayTimer&&clearInterval(e._recordPlayTimer)}});return r}),define("text!root-tpl/reading.tpl",[],function(){return'<div class="bg"></div>\n<div class="main">\n	<div class="inner-bg">\n		<i class="book-top"></i>\n		<i class="book-bottom"></i>\n		<div class="content">\n			<div class="content-main"></div>\n			<a href="javascript:;" class="btn-arrow btn-prev" rol-stat="1" data-stat="1">\n				<i class="icon-linear">&#xe607;</i>\n			</a>\n			<a href="javascript:;" class="btn-arrow btn-next" rol-stat="1" data-stat="2">\n				<i class="icon-linear">&#xe609;</i>\n			</a>\n		</div>\n	</div>\n	\n	<div>\n		<audio src="../alpha/audio/page.wav" controls="controls" class="page-audio"></audio>\n	</div>\n	<a class="btn-logout" rol-stat="1" data-stat="3">\n		<i class="icon-linear">&#xe60d;</i>\n	</a>\n	<a class="btn-audio">\n		<i class="icon-solid icon-pause">&#xe91a;</i>\n		<i class="icon-solid icon-play">&#xe60d;</i>\n	</a>\n</div>'}),define("root-common/module/responsive",[],function(){var e=null,t=$(window),n="resize",r=Backbone.View.extend({initialize:function(){var e=this,n;e.check(),t.resize(function(){n&&clearTimeout(n),n=setTimeout(function(){e.check()},100)})},check:function(){var e=this,t=e.viewPort();e.trigger(n,t.width,t.height)},viewPort:function(){var e=window,t="inner",n=this.padding||0;return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"]-n,height:e[t+"Height"]}}});return r.getInstance=function(){return e?e:e=new r},r.getInstance()}),define("reading",["root-common/module/reading/main","text!root-tpl/reading.tpl","root-common/module/responsive","./model","root-common/util","./stat"],function(e,t,n,r,i,s){var o="rendered",u=Backbone.View.extend({initialize:function(){var e=this;e._gap=150,e._proportion=1.6,e._tpl=doT.template(t),e._bookId=null,e._model=new r,e._model.bind({getArticleInfo:$.proxy(e.getArticleInfo,e)}),e._maxHeight=0,e._reading=null,e._currentPage=1},reset:function(){try{this.$el.html(""),this.stopListening()}catch(e){}},events:{"click [rol-stat]":"_statArrow","click .btn-logout":"logout","click .btn-arrow":"_addAudio","click .btn-audio .icon-play":"_autoPlay","click .btn-audio .icon-pause":"_pauseAudio"},init:function(e){var t=this;t._bookId=e,t._model.startReading({type:"post",data:{bookId:e}}),t._model.getArticleInfo({data:{bookId:e}})},render:function(){var e=this;e.$el.html(e._tpl({}));var t=$(".main",e.$el)},resize:function(e,t){var n=this,r,i,s=n._gap,u=n._proportion;(e-s)/(t-s/2)>u&&(i=t-s/2),(e-s)/(t-s/2)<=u&&(r=e-s,i=r/u),i=Math.max(570,i),r=i*u,n._maxHeight=i,$("> .main",n.$el).css({width:r,height:i,marginTop:(t-i)/2}),n._reading.resize(r,i),n.animLeft(),n.trigger(o),$(".icon-audio",n.$el).attr({"rol-stat":1,"data-stat":4})},_addAudio:function(){$(".page-audio",this.$el)[0].play&&$(".page-audio",this.$el)[0].play()},logout:function(){var e=this;window.audioPlay.click(),window.location.href="#bookNav/"+e._bookId},getArticleInfo:function(t,r,i,s){var o=this,u=t.data;o.render(),o._reading=new e({el:$(".content",o.$el),data:u.content}),o.listenTo(o._reading,"readover",$.proxy(o._readover,o)),o.listenTo(n,"resize",$.proxy(o.resize,o)),o.listenTo(o._reading,"change.page",$.proxy(o.resetAudio,o)),n.check()},_statArrow:function(e){var t=this,n=$(e.currentTarget).data("stat");s.send({url:"/readingContent/saveUserReadingLog",data:{bookId:this._bookId,operate:n}})},_readover:function(){var e=this;e._model.finishReading({type:"post",data:{bookId:e._bookId}}),window.audioPlay.completeReading(),window.location.href="#readover/"+e._bookId},_autoPlay:function(e){var t=this;$(".icon-pause",t.$el).css("display","block"),$(".icon-play",t.$el).hide(),t._reading.autoPlay()},_pauseAudio:function(){var e=this;e.resetAudio(),e._reading.pauseAudio()},resetAudio:function(){var e=this;$(".icon-pause",e.$el).hide(),$(".icon-play",e.$el).css("display","block")},animLeft:function(){var e=this,t=$(window).width()/2-e.$el.width()/2;e.$el.stop().animate({left:t},"slow",function(){})}});return u}),define("text!root-tpl/booklist/main.tpl",[],function(){return'<div class="bg"></div>\n<div class="main">\n	<div class="book-nav">\n		<li class="nav-item btn-booklist">\n			<a href="javascript:;">\n				<i class="icon-solid">&#xe909;</i>\n				<span>读物陈列</span>\n			</a>\n		</li>\n		<span class="seperator">|</span>\n		<li class="nav-item btn-mylist">\n			<a href="javascript:;">\n				<i class="icon-solid">&#xe919;</i>\n				<span>我的读物</span>\n			</a>\n		</li>\n	</div>\n	<div class="book-panel">\n		<div class="panel-item panel-booklist">\n			<div class="grade">\n				<span class="current-grade">\n					年级选择\n				</span>\n				<span class="icon-toggle">\n					<i class="icon-solid icon-expand">&#xe918;</i>\n					<i class="icon-solid icon-shrink">&#xe917;</i>\n				</span>\n				<ul>\n					\n				</ul>\n			</div>\n			<div class="content">\n				<div class="mask"></div>\n				<div class="nav">\n			\n				</div>\n				<div class="panel">\n					\n				</div>\n			</div>\n		</div>\n		<div class="panel-item panel-mylist">\n			<div class="content">\n				<div class="mask"></div>\n				<div class="panel">\n					\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n{{ if(it.status == 1){ }}\n<div class="pop-bg"></div>\n{{ } }}'}),define("text!root-tpl/booklist/nav.tpl",[],function(){return'<div class="nav-mask"></div>\n<h2 class="title">主 题</h2>\n<div class="nav-list default-skin">\n	<ul>\n		<li class="nav-item active" title="全部">全部</li>\n		{{~it.list :v:i}}\n		<li class="nav-item" title="{{!v.name}}">{{!v.name}}</li>\n		{{~}}\n	</ul>\n</div>'}),define("text!root-tpl/booklist/panel.tpl",[],function(){return'{{ if(it.isMyList){ }}\n<h3 class="title">我的读物 \n	<span>共<i>{{=it.list.length}}</i>本</span>\n	\n</h3>\n{{ }else{ }}\n<h2 class="title"> \n	{{ if(it.chooceTitle != \'\'){ }}\n		{{=it.chooceTitle}}\n	{{ }else{ }}\n		全部\n	{{ } }}\n</h2>\n{{ } }}\n<div class="panel-list default-skin">\n	{{ if(it.list.length > 0){ }}\n	<ul class="fix">\n		{{~it.list :v:i}}\n		<li class="panel-item ">\n			<h4>{{=v.booktitle}}</h4>\n			<div class="img">\n				<img src="{{=window.staticsBase}}/common/images/loading/ajax-loader.gif" title="{{=v.tip}}" data-url="{{=window.imgPath}}/{{=v.imgurl}}" class="loading" />\n			</div>\n			\n			<p>难度：{{=v.showlevel}}</p>\n			<i class="progress \n			{{ if(v.readStatus === \'0\' || v.readStatus === \'1\'){ }}\n			progress-ing\n			{{ } }}\n			{{ if(v.readStatus === \'3\'){ }}\n			progress-complete\n			{{ } }}\n			"></i>\n		</li>\n		{{~}}\n	</ul>\n	{{ }else{ }}\n	<div class="nobook">暂无读物</div>\n	{{ } }}\n	\n</div>'}),define("text!root-tpl/booklist/grade-list.tpl",[],function(){return'<li data-id="" title="All">\n	<a href="javascript:;">All</a>\n</li>\n{{~it.list :v:i}}\n<li data-id="{{=v.grade_id}}" title="{{=v.grade_name}}" \n{{ if(v.grade_id == it.gradeId){ }}\n class="active animate"\n{{ } }}\n>\n	<a href="javascript:;">{{=window.gradeMap[v.grade_id]}}</a>\n</li>\n\n{{~}}'}),define("root-common/module/tip",[],function(){function e(e,t){return typeof e=="function"?e.call(t):e}function t(e){while(e=e.parentNode)if(e==document)return!0;return!1}function n(e,t){this.$element=$(e),this.options=t,this.enabled=!0,this.fixTitle()}n.prototype={show:function(){var t=this.getTitle();if(t&&this.enabled){var n=this.tip();n.find(".tipsy-inner")[this.options.html?"html":"text"](t),n[0].className="tipsy",n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(this.options.doc.body);var r=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),i=n[0].offsetWidth,s=n[0].offsetHeight,o=e(this.options.gravity,this.$element[0]),u;switch(o.charAt(0)){case"n":u={top:r.top+r.height+this.options.offset,left:r.left+r.width/2-i/2};break;case"s":u={top:r.top-s-this.options.offset,left:r.left+r.width/2-i/2};break;case"e":u={top:r.top+r.height/2-s/2,left:r.left-i-this.options.offset};break;case"w":u={top:r.top+r.height/2-s/2,left:r.left+r.width+this.options.offset}}o.length==2&&(o.charAt(1)=="w"?u.left=r.left+r.width/2-15:u.left=r.left+r.width/2-i+15),n.css(u).addClass("tipsy-"+o),n.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+o.charAt(0),this.options.className&&n.addClass(e(this.options.className,this.$element[0])),this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):n.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){$(this).remove()}):this.tip().remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("original-title")!="string")&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,n=this.options;this.fixTitle();var e,n=this.options;return typeof n.title=="string"?e=t.attr(n.title=="title"?"original-title":n.title):typeof n.title=="function"&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip||(this.$tip=$('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},$.fn.tipsy=function(e){function r(t){var r=$.data(t,"tipsy");return r||(r=new n(t,$.fn.tipsy.elementOptions(t,e)),$.data(t,"tipsy",r)),r}function i(){var t=r(this);t.hoverState="in",e.delayIn==0?t.show():(t.fixTitle(),setTimeout(function(){t.hoverState=="in"&&t.show()},e.delayIn))}function s(){var t=r(this);t.hoverState="out",e.delayOut==0?t.hide():setTimeout(function(){t.hoverState=="out"&&t.hide()},e.delayOut)}if(e===!0)return this.data("tipsy");if(typeof e=="string"){var t=this.data("tipsy");return t&&t[e](),this}e=$.extend({},$.fn.tipsy.defaults,e),e.live||this.each(function(){r(this)});if(e.trigger!="manual"){var o=e.live?"live":"bind",u=e.trigger=="hover"?"mouseenter":"focus",a=e.trigger=="hover"?"mouseleave":"blur";this[o](u,i)[o](a,s)}return this},$.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover",doc:document},$.fn.tipsy.revalidate=function(){$(".tipsy").each(function(){var e=$.data(this,"tipsy-pointee");(!e||!t(e))&&$(this).remove()})},$.fn.tipsy.elementOptions=function(e,t){return $.metadata?$.extend({},t,$(e).metadata()):t},$.fn.tipsy.autoNS=function(){return $(this).offset().top>$(document).scrollTop()+$(window).height()/2?"s":"n"},$.fn.tipsy.autoWE=function(){return $(this).offset().left>$(document).scrollLeft()+$(window).width()/2?"e":"w"},$.fn.tipsy.autoBounds=function(e,t){return function(){var n={ns:t[0],ew:t.length>1?t[1]:!1},r=$(document).scrollTop()+e,i=$(document).scrollLeft()+e,s=$(this);return s.offset().top<r&&(n.ns="n"),s.offset().left<i&&(n.ew="w"),$(window).width()+$(document).scrollLeft()-s.offset().left<e&&(n.ew="e"),$(window).height()+$(document).scrollTop()-s.offset().top<e&&(n.ns="s"),n.ns+(n.ew?n.ew:"")}}}),define("booklist",["text!root-tpl/booklist/main.tpl","text!root-tpl/booklist/nav.tpl","text!root-tpl/booklist/panel.tpl","text!root-tpl/booklist/grade-list.tpl","./model","root-common/util","root-common/module/popup","root-common/module/pay/main","root-common/module/cookie","root-common/module/tab","root-common/module/tip","root-common/module/scrollbar"],function(e,t,n,r,i,s,o,u,a,f){var l=Backbone.View.extend({initialize:function(){var s=this;s._tpl=doT.template(e),s._navTpl=doT.template(t),s._panelTpl=doT.template(n),s._gradeListTpl=doT.template(r),s._model=new i,s._user=null,s._model.bind({getTopicInfoList:$.proxy(s.getTopicInfoList,s),getBookInfoList:$.proxy(s.getBookInfoList,s),getMyBook:$.proxy(s.getMyBook,s),queryAllGrade:$.proxy(s.queryAllGrade,s),purchase:$.proxy(s.purchase,s)}),s.reset(),s.gradeStatus=null},reset:function(){var e=this;e._pop=null,e._tab=null,e._navList=[],e._panelList=[],e._mylist=[],e._topicId=null,e._gradeId=null,e.chooceTitle="",e._isMyList=!1,e._isShrink=!0,e.$el.html("")},events:{"click .btn-mybook":"_showMyBook","click .panel-list li":"_readBook","click .panel-booklist .nav-item":"_switchNav","click .current-grade":"_toggleGrade","click .grade li":"_filterGrade"},init:function(){var e=this;e.render()},_toggleGrade:function(e){var t=this;t._isShrink=!t._isShrink,$(".grade",t.$el).toggleClass("grade-shrink"),t.setGrade()},setGrade:function(){var e=this,t="";e._isShrink?t=$(".grade li.active",e.$el).text():t="年级选择",$(".current-grade",e.$el).text(t)},_filterGrade:function(e){var t=this;$(".grade li.active",t.$el).removeClass("active");var n=$(e.currentTarget).addClass("active");t._gradeId=n.data("id"),t.loadList();try{localStorage.setItem("cp_grade",t._gradeId)}catch(e){}},render:function(){var e=this;e.gradeStatus=a("grade_choice"),e.$el.html(e._tpl({status:e.gradeStatus})),e._tab=new f({btns:$(".book-nav .nav-item",e.$el),panels:$(".book-panel .panel-item",e.$el)}),e._tab.bind("switch",function(t){e._isMyList=!1,t==1&&(e._isMyList=!0,e._showMyBook(),e.chooceTitle="")}),e._toggleGrade(),e._model.getTopicInfoList()},renderNav:function(){var e=this;$(".nav",e.$el).html(e._navTpl({list:e._navList})),$(".nav-list",e.$el).customScrollbar({updateOnWindowResize:!0})},renderPanel:function(e){var t=this,n=t._isMyList?t._mylist:t._panelList;$(".panel",e).html(t._panelTpl({list:n,chooceTitle:t.chooceTitle,isMyList:t._isMyList})),$(".panel-list li img",e).tipsy({}),$(".panel-list",e).customScrollbar({updateOnWindowResize:!0,onCustomScroll:function(e,n){t.showBookImg(n.scrollPercent/100)}});if(t.gradeStatus=="1"){$(".panel-list li",t.$el).removeClass("light");var r=0,i=setInterval(function(){r==n.length&&(clearInterval(i),a("grade_choice",""),$(".pop-bg",t.$el).remove(),$(".panel-list li",t.$el).removeClass("light")),$(".panel-list li",t.$el).eq(r).addClass("light"),r++},500)}n.length>0&&t.showBookImg()},_showMyBook:function(){var e=this;e._model.getMyBook({data:{pageNum:1,pageSize:1e4}})},_readBook:function(e){e.preventDefault();var t=this,n=t._isMyList?$(".panel-mylist"):$(".panel-booklist"),r=$(".panel-item",n).index($(e.currentTarget));$(".tipsy").remove();var i=t._isMyList?t._mylist:t._panelList,s=i[r],o=s.id,f=s.goldcoin;if(s.purchaseStatus)t.goReading(s.id);else{var l=new u({coin:f,baseUrl:window.serviceBase,token:a("hzw_reading_token"),item:s,type:"book"});l.init(),l.bind("success",function(e){$(".ui-header .amount").text(e)}),l.bind("pay",function(){t._model.purchase({data:{bookId:o}},{id:o})})}},goReading:function(e){$(".tipsy").remove(),window.location.href="#bookNav/"+e},getTopicInfoList:function(e,t,n,r){var i=this;s.dealAjax(function(t){var n=e.data;t||(i._navList=n.topicInfoList,i.renderNav())},e,t)},queryAllGrade:function(e,t,n,r){var i=this;s.dealAjax(function(t){var n=e.data;if(!t){i._gradeId=i._user.gradeId;try{i._gradeId=localStorage.getItem("cp_grade")||i._gradeId}catch(r){}$(".grade ul",i.$el).html(i._gradeListTpl({list:n||[],gradeId:i._gradeId})),$(".grade li",i.$el).tipsy({}),i.setGrade(),i.loadList(),i.gradeStatus=="1"&&$(".grade .animate a",i.$el).animate({width:"50px","line-height":"50px"},2e3,function(){$(".grade .animate a",i.$el).animate({width:"36px","line-height":"36px"},2e3,function(){$(".grade .animate",i.$el).removeClass("animate")})})}},e,t)},getBookInfoList:function(e,t,n,r){var i=this;s.dealAjax(function(t){var n=e.data;t||(i._panelList=n.bookRollPage.resultList,i.renderPanel($(".panel-booklist",i.$el)))},e,t)},getMyBook:function(e,t,n,r){var i=this;s.dealAjax(function(t){var n=e.data;t||(i._mylist=n.bookRollPage&&n.bookRollPage.resultList||[],i.renderPanel($(".panel-mylist",i.$el)))},e,t)},_switchNav:function(e){e.preventDefault();var t=this;$(".nav-list .active",t.$el).removeClass("active");var n=$(e.currentTarget).addClass("active"),r=t._navList;t.chooceTitle=$(e.currentTarget).attr("title");var i=$(".nav-list .nav-item",t.$el).index(n);if(i>0){var s=r[i-1];t._topicId=s.id,t.loadList()}else t._topicId=null,t.loadList()},loadList:function(){var e=this,t={pageNum:1,pageSize:1e4};e._topicId&&(t.topicId=e._topicId),e._gradeId&&(t.gradeId=e._gradeId),e._model.getBookInfoList({data:t})},purchase:function(e,t,n,r){var i=this;s.dealAjax(function(t){var n=e.data;if(!t){var o=r.id;s.successTip("购买成功"),i.goReading(o)}},e,t)},showBookImg:function(e){var t=this;e=e||0;var n=t._isMyList?$(".panel-mylist",t.$el):$(".panel-booklist",t.$el),r=$(".panel-list",n).height(),i=$(".panel-list ul",n),s=$(".panel-list .panel-item",n),o=s.eq(0),u=i.height(),a=o.outerHeight(),f=i.width(),l=o.outerWidth(),c=Math.floor(u*e/a),h=Math.ceil(r/a),p=Math.floor(f/l),d=(c+h)*p;c*=p;for(var v=d-1;v>=c;v--){var m=s.eq(v).find("img");m.hasClass("loading")&&m.attr("src",m.data("url")).load(function(){$(this).removeClass("loading")})}},setUser:function(e){var t=this;t._user=e,t._model.queryAllGrade()}});return l}),define("text!root-tpl/readover/main.tpl",[],function(){return'<div class="bg"></div>\n<div class="main">\n	<div class="">\n		<div class="book">\n			<!-- 图书封面 -->\n			<img width="119" height="152" src="{{=window.imgPath}}/{{=it.book.imgurl}}" title="{{=it.book.booktitle}}">\n		</div>\n		<p class="title1">Perfect! 快来给个评价吧！</p>\n		<!-- <p class="title2">有没有感觉语感又更好了一点呢&ensp;!</p> -->\n	</div>\n	<div class="talk">\n		<!-- <p class="title2">给点评价啵&ensp;~&ensp;~</p> -->\n		<div class="btn-group">\n			<!-- 点评按钮 -->\n			{{~it.list :v:i}}\n				<span class="title4 btn-talk" spanid="{{=v.id}}">{{=v.labelContent}}</span>\n			{{~}}\n		</div>\n	</div>\n	\n	<div class="titles">\n		{{ if(it.data.readingComprehension != 0){ }}\n		<p>还有习题等你来挑战！</p>\n		{{ } }}\n	</div>\n	\n	\n	<div class="">\n		<button class="btn-result again">\n            <span class="icon-solid icon-loop">\n            &#xe90f;\n            </span>\n            <span class="title3">再读一遍</span>	\n		</button>\n		{{ if(it.data){ }}\n			{{ if(it.data.readingComprehension == 0){ }}\n			<button class="btn-result more read-more">\n	            <span class="icon-solid icon-more">\n	            &#xe90e;\n	            </span>\n	            <span class="title3 ">阅读更多</span>	\n			</button>\n			{{ }else{ }}\n			<button class="btn-result more next">\n	            <span class="icon-solid icon-more">\n	            &#xe90e;\n	            </span>\n	            <span class="title3 ">进入习题</span>	\n			</button>\n			{{ } }}\n		{{ } }}\n 	</div>\n</div>'}),define("readover",["text!root-tpl/readover/main.tpl","./model","root-common/util","root-common/module/cookie","root-common/module/tip"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(){var n=this;n._model=new t,n._model.bind({finishReading:$.proxy(n.finishReading,n),getCommentList:$.proxy(n.getCommentList,n),commitComment:$.proxy(n.commitComment,n),exercisesStatus:$.proxy(n.exercisesStatus,n),getExercises:$.proxy(n.getExercises,n)}),n._tpl=doT.template(e),n.type=2,n.bookId="",n.chooceTalk=[],n.listArray=[],n.btnIndex=-1},reset:function(){var e=this;this.$el.html(""),e.chooceTalk=[]},events:{"click .btn-talk":"evaluate","click .again":"readAgain","click .read-more":"readMore","click .next":"next"},init:function(e){var t=this;t.bookId=e,t.render()},render:function(){var e=this;e._model.exercisesStatus({data:{bookId:e.bookId}})},next:function(){var e=this;window.audioPlay.click(),e._model.getExercises({data:{questionStyleId:e.type,bookId:e.bookId}})},finishReading:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;t||s.$el.html(s._tpl({data:s.typeList,book:n,list:s.listArray}))},e,t)},getCommentList:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;t||(s.listArray=n.list,s._model.finishReading({data:{bookId:s.bookId}}))},e,t)},commitComment:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;if(!t){var r=s.btnIndex,i=$(".btn-talk").eq(r),o=i.hasClass("choce");i.hasClass("choce")?i.removeClass("choce"):i.addClass("choce")}},e,t)},readAgain:function(){var e=this;e.offpage(),window.audioPlay.click(),window.location.href="#reading/"+e.bookId,window.resetPage()},readMore:function(){var e=this;e.offpage(),window.audioPlay.click(),window.location.href="#booklist"},evaluate:function(e){var t=this;e.preventDefault();var n=$(".btn-talk",t.$el).index($(e.currentTarget));t.btnIndex=n;var r=t.listArray[n],i=r.id,s;for(var o=0;o<t.chooceTalk.length;o++)t.chooceTalk[o]==i&&(s=o);$.inArray(i,t.chooceTalk)==-1?t.chooceTalk.push(i):t.chooceTalk.splice(s,1);var u=t.btnIndex,a=$(".btn-talk").eq(u),f=a.hasClass("choce");a.hasClass("choce")?a.removeClass("choce"):a.addClass("choce")},offpage:function(){var e=this,t=e.chooceTalk.toString();e._model.commitComment({data:{bookId:e.bookId,evaluateId:t}})},exercisesStatus:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;s.typeList=n,t||s._model.getCommentList({})},e,t)},getExercises:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;t||(n.doExercisesStatus=="2"?window.location.href="#testResult/"+s.bookId+"/"+s.type:(s.offpage(),window.location.href="#exercise/"+s.bookId+"/0"))},e,t)}});return i}),define("text!root-tpl/user/bg.tpl",[],function(){return'<div class="bg2"></div>'}),define("text!root-tpl/user/main.tpl",[],function(){return'<div class="user-new">\n	<ul>\n		<li class="user-menu information chooceLi">修改资料</li>\n		<li class="user-menu password">修改密码</li>\n	</ul>\n	<div class="box">\n\n	</div>\n</div>\n'}),define("text!root-tpl/user/student.tpl",[],function(){return'<form class="news-form">\n	<div class="list">\n		<p class="details left"><span>*</span>姓&emsp;名</p>\n		<p class="details right">\n			<input type="text" class="user-name" value="{{=it.userInfo.userRealName || \'\'}}" name="userRealName" >\n		</p>\n		<div class="form-error"></div>\n	</div>\n	<div class="list">\n		<p class="details left">姓&emsp;别</p>\n		<p class="details right">\n			<label>\n				<input type="radio" name="userGender" value="1" \n				{{ if(it.userInfo.userGender ==1){ }}\n		        checked\n		        {{ } }}\n				>&ensp;男\n			</label>&emsp;&emsp;\n			<label>\n				<input type="radio" name="userGender" value="0" \n				{{ if(it.userInfo.userGender ==0){ }}\n		        checked\n		        {{ } }}\n				>&ensp;女\n			</label>\n		</p>\n	</div>\n	<div class="list">\n		<p class="details left">邮&emsp;箱</p>\n		<p class="details right">\n			<input type="text" value="\n			{{ if(it.userInfo.userEmail != null){ }}\n			{{=it.userInfo.userEmail}}\n			{{ } }}\n			" name="userEmail" class="user-email">\n		</p>\n		<div class="form-error"></div>\n	</div>\n	{{ if(it.userInfo.userGender == 7){ }}\n	<div class="list">\n		<p class="details left">家长名</p>\n		<p class="details right">\n			<input type="text" value="\n			{{ if(it.userInfo.userParentName != null){ }}\n			{{=it.userInfo.userParentName}}\n			{{ } }}\n			" name="userParentName" class="user-parent">\n		</p>\n	</div>\n	<div class="list">\n		<p class="details left">家长手机</p>\n		<p class="details right ">\n			<input type="text" value="\n			{{ if(it.userInfo.userParentPhone != null){ }}\n			{{=it.userInfo.userParentPhone}}\n			{{ } }}\n			" name="userParentPhone" class="user-phone">\n		</p>\n		<div class="form-error"></div>\n	</div>\n	{{ } }}\n	<div class="list btn-submit">\n		<input type="submit" value="保存" class="save-user" >\n		<input type="button" value="取消" class="return-back" >\n	</div>\n</form>'}),define("text!root-tpl/user/teacher.tpl",[],function(){return'<form class="news-form">\n	<div class="list">\n		<p class="details left"><span>*</span>姓&emsp;名</p>\n		<p class="details right">\n			<input type="text" class="user-name" value="{{=it.userInfo.userRealName}}" name="userRealName" >\n		</p>\n		<div class="form-error"></div>\n	</div>\n	<div class="list">\n		<p class="details left">姓&emsp;别</p>\n		<p class="details right">\n			<label>\n				<input type="radio" name="userGender" value="1" \n				{{ if(it.userInfo.userGender ==1){ }}\n		        checked\n		        {{ } }}\n				>&ensp;男\n			</label>&emsp;&emsp;\n			<label>\n				<input type="radio" name="userGender" value="0" \n				{{ if(it.userInfo.userGender ==0){ }}\n		        checked\n		        {{ } }}\n				>&ensp;女\n			</label>\n		</p>\n	</div>\n	<div class="list">\n		<p class="details left">邮&emsp;箱</p>\n		<p class="details right">\n			<input type="text" value="\n			{{ if(it.userInfo.userEmail != null){ }}\n			{{=it.userInfo.userEmail}}\n			{{ } }}\n			" name="userEmail" class="user-email">\n		</p>\n		<div class="form-error"></div>\n	</div>\n	<div class="list btn-submit">\n		<input type="submit" value="保存" class="save-user" >\n		<input type="button" value="取消" class="return-back" >\n	</div>\n</form>'}),define("text!root-tpl/user/password.tpl",[],function(){return'<form class="pw-form">\n	<div class="list">\n		<p class="details left">原密码</p>\n		<p class="details right">\n			<input type="text" name="opw" >\n		</p>\n		<div class="form-error"></div>\n	</div>\n	<div class="list">\n		<p class="details left">新密码</p>\n		<p class="details right">\n			<input type="text" name="pw" >\n		</p>\n		<div class="form-error"></div>\n	</div>\n	<div class="list">\n		<p class="details left">确认新密码</p>\n		<p class="details right">\n			<input type="text" name="cpw" >\n		</p>	\n		<div class="form-error"></div>\n	</div>\n	<div class="list btn-submit">\n		<input type="submit" value="保存" class="save-password" >\n		<input type="button" value="取消" class="return-back" >\n	</div>\n</form>'}),define("userNew",["text!root-tpl/user/bg.tpl","text!root-tpl/user/main.tpl","text!root-tpl/user/student.tpl","text!root-tpl/user/teacher.tpl","text!root-tpl/user/password.tpl","root-common/module/cookie","./model","root-common/util","root-common/module/popup"],function(e,t,n,r,i,s,o,u,a){var f=Backbone.View.extend({initialize:function(){var s=this;s._bgTpl=doT.template(e),s._usermainTpl=doT.template(t),s._studentTpl=doT.template(n),s._teacherTpl=doT.template(r),s._passwordTpl=doT.template(i),s._pop=null,s._model=new o,s._model.bind({getUserInfo:$.proxy(s.getUserInfo,s),modifyUserInfo:$.proxy(s.modifyUserInfo,s),changePswByOldPsw:$.proxy(s.changePswByOldPsw,s)}),$(window).resize(function(){s._pop&&s._pop.resize()}),s.user=null},reset:function(){var e=this;e._pop.close(),e._pop=null,e.stopListening(),this.$el.html("")},events:{"click .information":"information","click .password":"password","click .return-back":"returnBack","submit .news-form":"saveUser","submit .pw-form":"savePassword"},init:function(e){var t=this,n=s("hzw_reading_token");n?t._model.getUserInfo({token:n}):window.location.href="#",t.render()},render:function(e){var t=this;t.$el.html(t._bgTpl({}));var n=t._pop=a.create({custom:t._usermainTpl({}),isMove:!1,className:"pop-youyang",hasHd:!1});t.setElement(n.$el),t.updateInformation(),t.getUserInfo(),t.listenTo(t._pop,"close",$.proxy(t.closePop,t))},updateInformation:function(){var e=this;o.data.userInfo.roleId=="42"?$(".box").html(e._teacherTpl({userInfo:e.user})):$(".box").html(e._studentTpl({userInfo:e.user}))},getUserInfo:function(e,t,n,r){var i=this;u.dealAjax(function(t){var n=e.data;i.user=n,t||(console.log(),n.roleId=="42"?$(".box").html(i._teacherTpl({userInfo:n})):$(".box").html(i._studentTpl({userInfo:n})))},e,t)},updatePassword:function(){var e=this;$(".box").html(e._passwordTpl({}))},closePop:function(){window.location.href="#product"},information:function(e){var t=this;$(".user-menu").removeClass("chooceLi"),$(e.target).addClass("chooceLi"),t.updateInformation()},password:function(e){var t=this;t.updatePassword(),$(".user-menu").removeClass("chooceLi"),$(e.target).addClass("chooceLi")},saveUser:function(e){var t=this,n=/^([\w-]+)@([\w-]+).([\w-]+)$/,r=/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,i=n.test($(".user-email[name = 'userEmail']").val()),s=$(".user-phone[name = 'userParentPhone']").val(),o=$("input[name = 'userRealName']").val(),u=r.test(s);$(".error").remove(),o==""&&$(e.currentTarget).parent().parent().find(".form-error").eq(0).append('<span class="error">姓名不得为空</span>'),i||$(e.currentTarget).parent().parent().find(".form-error").eq(1).append('<span class="error">邮箱格式错误</span>'),u||$(e.currentTarget).parent().parent().find(".form-error").eq(2).append('<span class="error">手机格式错误</span>'),e.preventDefault(),s==null&&i&&o!=""&&t._model.modifyUserInfo({data:{userRealName:$(".user-name[name = 'userRealName']").val(),userGender:$("input[name = 'userGender']:checked").val(),userEmail:$(".user-email[name = 'userEmail']").val()}}),i&&u&&o!=""&&t._model.modifyUserInfo({data:{userRealName:$(".user-name[name = 'userRealName']").val(),userGender:$("input[name = 'userGender']:checked").val(),userEmail:$(".user-email[name = 'userEmail']").val(),userParentName:$(".user-parent[name = 'userParentName']").val(),userParentPhone:$(".user-phone[name = 'userParentPhone']").val()}})},modifyUserInfo:function(e,t,n,r){var i=this;u.dealAjax(function(e){if(!e){var t=s("hzw_reading_token");t&&i._model.getUserInfo({token:t}),i.getUserInfo(),alert("信息修改成功")}},e,t)},savePassword:function(e){var t=this,n=this.validate($(e.currentTarget)).form();return e.preventDefault(),n&&t._model.changePswByOldPsw({data:{oldPassword:$("input[name = 'opw']").val(),newPassword:$("input[name = 'pw']").val()}}),!1},changePswByOldPsw:function(e,t,n,r){var i=this;u.dealAjax(function(e){e||alert("密码修改成功")},e,t)},validate:function(e){var t=this;return e.validate({errorElement:"span",errorPlacement:function(e,t){e.prepend(""),e.appendTo(t.parent().parent().find(".form-error"))},rules:{opw:{required:!0},pw:{required:!0,ispw:!0},cpw:{required:!0,isCpw:!0}},messages:{opw:{required:"密码不能为空"},pw:{required:"密码不能为空",ispw:'6~20位小写英文、数字或"_"的组合'},cpw:{required:"确认密码不能为空",isCpw:"两次输入不一致"}}})},returnBack:function(){var e=this;e.closePop(),e.setElement($("#UserPage")),this.$el.html("")}});return f}),define("text!root-tpl/book-nav/main.tpl",[],function(){return'<div class="selection">\n	<div class="bg"></div>\n	<ul>\n		<li class="list fix">\n			<div class="box listone">\n				<p class="title">\n					<span class="icon-Preparation iconfont icon-linear">\n		                &#xe90c;\n		            </span>\n				</p>\n				<p class="str1"></p>\n			</div>\n			<div class="box arrow">\n				<span class="icon-arrow-duble-right iconfont icon-linear ">\n	                &#xe90e;\n	            </span>\n			</div>\n			<div class="box right btn">\n				{{ if(it.data.readingGuide  == 0){ }}\n				<p class="noopen"></p>\n				{{ } }}\n				{{ if(it.data.readingGuide  == 1){ }}\n				<div class="noread">\n					<div class="bg"></div>\n					<span class="icon-block icon-solid icon">\n		                &#xe914;\n		            </span>\n				</div>\n				{{ } }}\n				<div class="content ">\n					<div class="pic \n					{{ if(it.data.readingGuide    == 0){ }}\n					default\n					{{ } }}\n					">\n						<p class="img1"></p>\n					</div>\n					<p class="cn">阅读引导</p>\n					<p class="en">Guide</p>\n				</div>\n			</div>\n		</li>\n		<li class="list fix">\n			<div class="box listone">\n				<p class="title">\n					<span class="icon-Preparation iconfont icon-linear">\n		                &#xe90d;\n		            </span>\n				</p>\n				<p class="str2"></p>\n			</div>\n			<div class="box arrow">\n				<span class="icon-arrow-duble-right iconfont icon-linear ">\n	                &#xe90e;\n	            </span>\n			</div>\n			<div class="box right btn">\n				{{ if(it.data.textReading    == 0){ }}\n				<p class="noopen"></p>\n				{{ } }}\n				{{ if(it.data.textReading    == 1){ }}\n				<div class="noread">\n					<div class="bg"></div>\n					<span class="icon-block icon-solid icon">\n		                &#xe914;\n		            </span>\n				</div>\n				{{ } }}\n				<div class="content ">\n					<div class="pic original\n					{{ if(it.data.textReading    == 0){ }}\n					default\n					{{ } }}\n					">\n						<p class="img2"></p>\n					</div>\n					<p class="cn">原文阅读</p>\n					<p class="en">Passage</p>\n				</div>\n			</div>\n		</li>\n		<li class="list fix">\n			<div class="box listone">\n				<p class="title">\n					<span class="icon-Preparation iconfont icon-linear">\n		                &#xe90b;\n		            </span>\n				</p>\n				<p class="str3"></p>\n			</div>\n			<div class="box arrow">\n				<span class="icon-arrow-duble-right iconfont icon-linear ">\n	                &#xe90e;\n	            </span>\n			</div>\n			<div class="box right fix">\n				<div class="brs btn">\n					{{ if(it.data.readingComprehension == 0){ }}\n					<p class="noopen"></p>\n					{{ } }}\n					{{ if(it.data.readingComprehensionScore < 0 && it.data.readingComprehension > 1){ }}\n					<p class="nocomplete"></p>\n					{{ } }}\n					{{ if(it.data.readingComprehensionScore >= 0 && it.data.readingComprehension > 1){ }}\n					<p class="complete">{{=parseInt(it.data.readingComprehensionScore)}}分</p>\n					{{ } }}\n					{{ if(it.data.readingComprehension == 1){ }}\n					<div class="noread">\n						<div class="bg"></div>\n						<span class="icon-block icon-solid icon">\n			                &#xe914;\n			            </span>\n					</div>\n					{{ } }}\n					<div class="content ">\n						<div class="understand pic \n						{{ if(it.data.readingComprehension == 0){ }}\n						default\n						{{ } }}\n						">\n							<p class="img3-1"></p>\n						</div>\n						<p class="cn">阅读理解</p>\n						<p class="en">Comperhension</p>\n					</div>\n				</div>\n				<div class="brs btn">\n					{{ if(it.data.lexicalGrammar  == 0){ }}\n					<p class="noopen"></p>\n					{{ } }}\n					{{ if(it.data.lexicalGrammar  == 1){ }}\n					<div class="noread">\n						<div class="bg"></div>\n						<span class="icon-block icon-solid icon">\n			                &#xe914;\n			            </span>\n					</div>\n					{{ } }}\n					<div class="content ">\n						<div class="pic \n						{{ if(it.data.lexicalGrammar  == 0){ }}\n						default\n						{{ } }}\n						">\n							<p class="img3-2"></p>\n						</div>\n						<p class="cn">词汇语法</p>\n						<p class="en">Voc & Gra</p>\n					</div>\n				</div>\n				<div class="brs btn">\n					{{ if(it.data.listeningTraining  == 0){ }}\n					<p class="noopen"></p>\n					{{ } }}\n					{{ if(it.data.listeningTraining  == 1){ }}\n					<div class="noread">\n						<div class="bg"></div>\n						<span class="icon-block icon-solid icon">\n			                &#xe914;\n			            </span>\n					</div>\n					{{ } }}\n					<div class="content ">\n						<div class="pic \n						{{ if(it.data.listeningTraining  == 0){ }}\n						default\n						{{ } }}\n						">\n							<p class="img3-3"></p>\n						</div>\n						<p class="cn">听力训练</p>\n						<p class="en">Listening</p>\n					</div>\n				</div>\n			</div>\n		</li>\n		<li class="list fix">\n				<div class="box listone">\n				<p class="title">\n					<span class="icon-Preparation iconfont icon-linear">\n		                &#xe90a;\n		            </span>\n				</p>\n				<p class="str4"></p>\n			</div>\n			<div class="box arrow">\n				<span class="icon-arrow-duble-right iconfont icon-linear ">\n	                &#xe90e;\n	            </span>\n			</div>\n			<div class="box right btn">\n				{{ if(it.data.cloze == 0){ }}\n				<p class="noopen"></p>\n				{{ } }}\n				{{ if(it.data.cloze == 1){ }}\n				<div class="noread">\n					<div class="bg"></div>\n					<span class="icon-block icon-solid icon">\n		                &#xe914;\n		            </span>\n				</div>\n				{{ } }}\n				<div class="content ">\n					<div class="pic \n					{{ if(it.data.cloze == 0){ }}\n					default\n					{{ } }}\n					">\n						<p class="img4"></p>\n					</div>\n					<p class="cn">完形填空</p>\n					<p class="en">Cloze</p>\n				</div>\n			</div>\n		</li>\n	</ul>\n	<div class="opacity"></div>\n</div>'}),define("bookNav",["text!root-tpl/book-nav/main.tpl","root-common/util","./model","root-common/module/cookie"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e),t.bookid=null,t.typeList=null,t.question=0,t.type=2,t._model=new n,t._model.bind({exercisesStatus:$.proxy(t.exercisesStatus,t),getExercises:$.proxy(t.getExercises,t)})},events:{"click .original":"original","click .understand":"understand"},reset:function(){this.$el.html("")},init:function(e){var t=this;t.bookid=e,t.render()},render:function(){var e=this;e._model.exercisesStatus({data:{bookId:e.bookid}})},original:function(e){e.preventDefault();var t=this;window.audioPlay.click(),t.typeList.textReading==2&&(window.location.href="#reading/"+t.bookid)},understand:function(e){e.preventDefault();var t=this;window.audioPlay.click(),t.typeList.readingComprehension==2&&t._model.getExercises({data:{questionStyleId:t.type,bookId:t.bookid}})},exercisesStatus:function(e,n,r,i){var s=this;t.dealAjax(function(t){var n=e.data;s.typeList=n,t||s.$el.html(s._tpl({data:n}))},e,n)},getExercises:function(e,n,r,i){var s=this;t.dealAjax(function(t){var n=e.data;t||(n.doExercisesStatus=="2"?window.location.href="#testResult/"+s.bookid+"/"+s.type:window.location.href="#exercise/"+s.bookid+"/"+s.question)},e,n)},animLeft:function(){var e=this;$(".selection",e.$el).stop().animate({left:"-100%"},"slow",function(){e.reset()})}});return i}),define("text!root-tpl/book-nav/result.tpl",[],function(){return'{{\n	var right = null;\n	var index = null;\n}}\n\n<div class="bg"></div>\n<div class="p-question">\n	<div class="ui-exercise">\n		<div class="mask"></div>\n		<div class="main p-result">\n			<div class="mask"></div>\n			<div class="content ">\n				<p class="icon">\n					<span class="icon-single-arrow-right icon-solid icon">\n		                &#xe60d;\n		            </span>\n		            <span class="icon-single-arrow-right icon-solid icon right">\n		                &#xe60d;\n		            </span>\n		            <span>阅读理解<br/>&emsp;&ensp;&ensp;Comprehension</span>\n				</p>\n			</div>\n			<div class="border chart fix">\n				<div class="box left">\n					<div id="placeholder" class="demo-placeholder"></div>\n					<div class="composition-total-score ">\n						<div class="total-score-center">\n							<div class="center">\n								<p class="center-score-total"><span class="num">{{=Math.floor(it.data.rightPercent*100)}}</span>%</p>\n								<p class="center-score-title">正确率</p>\n							</div>\n						</div>\n					</div>\n				</div>\n				<div class="box right">\n					<p>总题数：{{=it.data.total}}题</p>\n					<p>总用时：{{=it.data.usedTime}}</p>\n					<p>单题平均用时：{{=it.data.avgTime}}</p>\n				</div>\n			</div>\n			<div class="test-btn border">\n				<ul class="fix">\n					{{~it.data.exercisesInfoL :v:i}}\n					<li class="testbtn \n						{{ if(v.userIsRight  == \'0\'){ }}\n						wrong\n						{{ } }}\n					">{{!v.sort}}</li>\n					{{~}}\n				</ul>\n				<p class="title">Choose the best answer to the questions below.</p>\n			</div>\n			<div class="question-area border" data-id="{{=it.exercise.questionId}}" data-userdoid="{{=it.exercise.userDoquestionId}}">\n				<div class="row-title">Question:</div>\n				<div class="question">{{=it.title}}</div>\n				<div class="row-title">Option:</div>\n				<ul class="option-list">\n					{{~it.list :v:i}}\n					<li class="option-item \n					{{ if(it.select == v.questionOptionId ){ }}\n					option-select \n					{{ } }}\n					{{ if(i == it.list.length - 1){ }}\n					option-item-last \n					{{ } }}\n					{{ if(v.isRight == 1){ }}\n					option-right \n					{{ }else{ }}\n					option-error \n					{{ } }}\n					"  data-id="{{=v.questionOptionId}}">\n						{{=it.options[i]}}. {{=v.questionOption}}\n						{{ if( it.select == v.questionOptionId && v.isRight  != \'1\' ){ }}\n						<i class="icon-solid icon-results icon-error">&#xe915;</i>\n						{{ } }}\n						{{ if(v.isRight  == \'1\' ){ }}\n						<i class="icon-solid icon-results icon-right">&#xe916;</i>\n						{{ } }}\n					</li>\n\n					{{ \n						if(v.isRight){\n							right = v;\n							index = i;\n						}\n					}}\n\n					{{~}}\n				</ul>\n			</div>\n			<div class="answer-area">\n				<div class="row-title">The Answer:</div>\n				<div class="answer">\n					<p>{{=it.options[index]}}. {{=right.questionOption}}</p>\n				</div>\n				<a class="btn btn-reset" href="javascript:;">重&nbsp;&nbsp;做</a>\n			</div>\n	</div>\n	<audio src="../alpha/audio/complete.mp3" controls="controls" class="page-audio"></audio>\n</div>'}),define("testResult",["text!root-tpl/book-nav/result.tpl","root-common/util","./model","root-common/module/cookie"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e),t.result=null,t.bookid=null,t.choice=0,t.questionStyleId="2",t.rightPercent=null,t._model=new n,t._model.bind({getExercises:$.proxy(t.getExercises,t),getFinishExercises:$.proxy(t.getFinishExercises,t),redoBookExercises:$.proxy(t.redoBookExercises,t)})},events:{"click .testbtn":"getfinish","click .btn-reset":"getreset"},reset:function(){this.$el.html("")},init:function(e,t){var n=this;n.bookid=e,n.render(),n._model.updateUserBookStatus({data:{bookId:e}})},render:function(){var e=this;e._model.getExercises({data:{bookId:e.bookid,questionStyleId:e.questionStyleId}})},getreset:function(e){var t=this;e.preventDefault(),window.audioPlay.click(),t._model.redoBookExercises({data:{bookId:t.bookid,questionStyleId:t.questionStyleId}})},getfinish:function(e){var t=this;e=e||null;var n=e?$(e.target).index():0;t.choice=n;var r=t.result.exercisesInfoL[n].userDoquestionId;t._model.getFinishExercises({data:{userDoquestionId:r}})},redoBookExercises:function(e,n,r,i){var s=this;t.dealAjax(function(t){var n=e.data;t||(window.location.href="#exercise/"+s.bookid+"/0")},e,n)},getFinishExercises:function(e,n,r,i){var s=this;t.dealAjax(function(t){var n=e.data,r=n.exercisesInfo,i=r.exercisesOptionInfoL,o=r.question,u=r.userSelectedOptionId,a="ABCDEFGH".split("");t||(s.$el.html(s._tpl({data:s.result,title:o,list:i||[],exercise:r,select:u,options:a})),s.initPie(s.rightPercent*100,100),$(".testbtn").eq(s.choice).addClass("choice"))},e,n)},getExercises:function(e,n,r,i){var s=this;t.dealAjax(function(n){var r=e.data;s.result=r,n||(s.result.usedTime=t.formatTimeE(r.usedTime*1e3),s.result.avgTime=t.formatTimeE(r.avgTime*1e3),s.getfinish(),s.rightPercent=r.rightPercent)},e,n)},getTime:function(e){return parseInt(e/60)},initPie:function(e,t){var n=[],e=100*e/t;series=[100-e,e];for(var r=0;r<series.length;r++)n[r]={data:series[r]};var i=$("#placeholder");$("#placeholder").css({width:154,height:154}),$.plot(i,n,{series:{pie:{show:!0,stroke:{color:"#252b17"}}},colors:["#252b17","#fff905"]})}});return i}),define("text!root-tpl/find-pw/main.tpl",[],function(){return'<div class="bg3"></div>\n<div class="back">\n	<span class="icon-back icon-solid">\n    	&#xe913;\n    </span>\n    <span class="btn-str">返回</span>\n</div>\n<div class="main findPw-choice fix">\n	<div class="article">\n		<div class="mode">\n			<span class="iconfont icon-phone icon-linear">\n            	&#xe908;\n            </span>\n			<a href="#phonefind">手机取回</a>\n		</div>\n		<p class="content">\n			如果您的账号已绑定手机，强烈建议您选用手机找回，方便快捷\n		</p>\n	</div>\n	<div  class="article right">\n		<div class="mode">\n			<span class="iconfont icon-email icon-linear">\n            	&#xe909;\n            </span>\n			<a href="{{=it.url}}">邮箱取回</a>\n		</div>\n		<p class="content">\n			如果您的账号未绑定手机或者已更换手机，那么可以选用邮箱找回，同样方便\n		</p>\n	</div>\n	<!-- <div class="mask"></div>\n	<div class="content">\n		<div class="nav">\n			\n		</div>\n		<div class="panel">\n			\n		</div>\n	</div> -->\n	\n</div>'}),define("find-pw",["text!root-tpl/find-pw/main.tpl","root-common/util","./model","root-common/module/cookie"],function(e,t,n,r){var i=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e)},events:{"click .btn-str":"_backtosign"},reset:function(){this.$el.html("")},init:function(){var e=this;e.render()},render:function(e){var t=this,n,r=location.hostname;r==="www.lyced.com"&&(n="http://www.lyced.com/LoginAction.action?method=findPwd"),r==="www.17english.com"&&(n="http://www.17english.com/LoginAction.action?method=findPwd"),r==="192.168.12.240"&&(n="http://192.168.12.240/LoginAction.action?method=findPwd"),t.$el.html(t._tpl({url:n}))},_backtosign:function(){var e=this;e.reset(),window.audioPlay.click(),window.location.href="#"}});return i}),define("text!root-tpl/privacy.tpl",[],function(){return'<div class="inner"><p>\n	<h2 style="text-align:center;">\n		<b>Privacy Notice</b>\n	</h2>\n	<p class="MsoNormal" align="center" style="text-align:center;">\n		<b></b>\n	</p>\n	<p class="MsoNormal">\n		<b>&nbsp;</b>\n	</p>\n	<p class="MsoNormal">\n		<b>WHAT PERSONALLY IDENTIFIABLE INFORMATION ("PII") DOES LANGYING COLLECT ABOUT YOU?</b><b></b>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;Contact information that you provide to us, such as your name, title and organization, address, telephone number, fax number, or e-mail address.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;Contact information obtained via other companies’ marketing lists.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;Credit card or other payment information, if there is any, for your transactions may be collected.\n	</p>\n	<p class="MsoNormal">\n		<b>WHY DOES LANGYINGCOLLECT PII?</b><b></b>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;To process your transactions, maintain your account, and respond to your inquiries.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;To provide you with information about services and products that we believe may be of interest to you offered by LANGYING.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;To provide you with access to website&nbsp;and services, as described in our&nbsp;<a href="http://www.mheducation.com/terms-use"><u>Terms of Use</u></a>\n	</p>\n	<p class="MsoNormal">\n		<b>HOW DOES LANGYINGSHARE YOUR PII?</b><b></b>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;With our vendors to perform services on our behalf.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;With our business partners, which may include authors, who may jointly develop and offer products with LANGYING.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;Potentially in conjunction with a sale or similar transfer of a business.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;If you use our online products or services, we may share your PII, and other information collected in the course of providing you with our online products and services, with instructors and administrators of your educational institution.\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;When legally compelled or for other legal purposes.\n	</p>\n	<p class="MsoNormal">\n		<b>SECURITY AND ACCURACY</b><b></b>\n	</p>\n	<p class="MsoNormal">\n		We have established safeguards and use reasonable security measures to protect your PII from unauthorized access and use. Your PII is stored in a secure location in the People’s Republic of China&nbsp;and access is limited to authorized persons.\n	</p>\n	<p class="MsoNormal">\n		To review and confirm the accuracy of your PII, or to contact us with concerns or questions, please write to:&nbsp;<a href="mailto:.privacy@lyced.com"><u>.privacy@lyced.com</u></a>&nbsp;or Privacy Official, LANGYING, 19A No. 121&nbsp;Yanping Road, Jing’an District, Shanghai, China.\n	</p>\n	<p class="MsoNormal">\n		<b>COOKIE USAGE</b><b></b>\n	</p>\n	<p class="MsoNormal">\n		<b>Please note that by using this website (the "Site"), you consent to the use of the cookies described below.</b>\n	</p>\n	<p class="MsoNormal">\n		<b>LANGYING </b>or our third-party service providers may use cookies (or other tracking technologies that identify your computer or device (like its IP address) and track your use of the Site) when you visit our Site. We do not collect personally identifying information in this way, but if you\'ve provided us with personally identifying information we may associate that information with the information that is collected automatically.\n	</p>\n	<p class="MsoNormal">\n		A "cookie" is a small text file placed on your computer or device, which helps our Site function better. We may use the following types of cookies on this Site:\n	</p>\n	<p class="MsoNormal">\n		"Strictly necessary" cookies, which have to be set to allow us to deliver the Site to you and to provide specific services that you request from us. The services offered by this Site that require cookies to function include:\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;account log-in\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;shopping basket/online store\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;billing\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;comments/forum features\n	</p>\n	<p class="MsoNormal">\n		"Performance" or "Analytics" cookies, which help us to collect information about how visitors use our Site, and helps us with site analysis and improvements. Performance or analytics cookies will remain on your computer after you close your browser, but cannot be used to identify you personally.\n	</p>\n	<p class="MsoNormal">\n		"Functionality" cookies, which allow our site to remember your choices or preferences, such as information on online forms or previous orders. These cookies allow us to offer you a personalized experience while using the Site. They are not used to track your browsing activity on other websites.\n	</p>\n	<p class="MsoNormal">\n		You can change your web browser\'s Internet preferences to disable or delete cookies, although that may affect certain functions on this site. To learn how to manage your cookies, please follow the instructions from your specific browser, or follow the links below:\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;<a href="http://support.microsoft.com/kb/196955">Internet Explorer</a>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;<a href="http://support.mozilla.org/en-US/kb/enable-and-disable-cookies-website-preferences?redirectlocale=en-US&amp;redirectslug=Enabling+and+disabling+cookies">Firefox</a>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;<a href="http://support.google.com/chrome/bin/answer.py?hl=en&amp;answer=95647">Chrome</a>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;<a href="http://support.apple.com/kb/PH5042">Safari</a>\n	</p>\n	<p class="MsoNormal" style="margin-left:22.5000pt;text-indent:-18.0000pt;">\n		·&nbsp;<a href="http://www.opera.com/browser/tutorials/security/privacy/">Opera</a>\n	</p>\n	<p class="MsoNormal">\n		If you are visiting this Site using a mobile device such as a smartphone or tablet, please refer to the manufacturer\'s instructions on how to manage cookies.\n	</p>\n	<p class="MsoNormal">\n		<b>IF YOU WANT TO LIMIT USE OR SHARING OF YOUR PII FOR MARKETING PURPOSES:</b><b></b>\n	</p>\n	<p class="MsoNormal">\n		Write to us at:&nbsp;<a href="mailto:privacy@lyced.com"><u>privacy@lyced.com</u></a>&nbsp;or Privacy Official, LANGYING, 19A No. 121&nbsp;Yanping Road, Jing’an District, Shanghai, China. and let us know if you no longer wish to be contacted for marketing purposes by e-mail, mail, telephone or fax - or by any method.\n	</p>\n	<p class="MsoNormal">\n		&nbsp;\n	</p>\n</p>\n<p>\n	<br />\n</p>\n</div>'}),define("privacy",["text!root-tpl/privacy.tpl"],function(e){var t=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e)},events:{},reset:function(){this.$el.html("")},init:function(){var e=this;e.render()},render:function(e){var t=this;t.$el.html(t._tpl({}))}});return t}),define("text!root-tpl/term.tpl",[],function(){return'<div class="inner"><h2 style="text-align:center;">\n	<b>17English</b><b>.com Terms of Use</b> \n</h2>\n<p class="MsoNormal" align="center" style="text-align:center;">\n	<b></b> \n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	This web site (the "Site"), is owned and operated by Shanghai LangYing Education &amp;&nbsp;Technology Co, Ltd. (“LangYing" or "us" or "we"). By accessing or using this Site, you agree to be bound by the following terms and conditions (the "Terms of Use") and the terms and conditions of our Privacy Notice, which is hereby incorporated by reference (collectively, this “Agreement”). We reserve the right, at our discretion, to change any of these terms in the future. If you do not agree to these Terms of Use, you may not access or otherwise use the Site or the Services.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	1. &nbsp;PROPRIETARY SERVICES FOR REGISERED USERS. &nbsp;LangYing&nbsp;operates an electronic platform/system that enables students, instructors, and administrators of educational institutions to access and use certain online products and services offered by LangYing&nbsp;(the “Services”) through the Site. The material on this Site includes general non-proprietary information available to all users of the Site, but in order to access and use the Services you will be required to log in with you assigned user name and password&nbsp;on the Site or register through your educational institution. You&nbsp;shall be solely responsible for keeping an accurate record of the user name and password&nbsp;assigned to you. If you register to use the Services on behalf of your educational institution, you will be required to agree to additional terms and conditions in connection with the registration process (the " Services Agreement").\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	2. RESTRICTIONS. &nbsp;As a service provider to Subscriber, LangYing&nbsp;will establish and maintain reasonable procedures in accordance with its policies and practices and applicable law to protect the confidentiality, security, and integrity of Personal Information and user information received by LangYing&nbsp;in connection with provision of the Services. You&nbsp;acknowledges and agrees that LangYing&nbsp;has the right to use the Personal Information and userinformation collected in connection with provision of the Service&nbsp;for (a) purposes of performing its obligations under this Agreement, and (b) for research purposes in connection with quality control and the development of revised or new products or services (“Research Purposes”), provided that such Personal Information and userinformation will be used by LangYing&nbsp;for Research Purposes only in the aggregate and so that the privacy of the individual\'s Personal Information will be maintained,consistent with our Privacy Notice. &nbsp;\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	3. INTELLECTUAL PROPERTY. &nbsp;LangYing&nbsp;is the owner and/or authorized user of all trademarks, logos, service marks and trade names (collectively the "Trademarks") on the Site, and is the owner or licensee of the content and/or information on the Site. Except as otherwise expressly provided herein, or pursuant to the Terms and Conditions, your use of the Site does not grant to you a license to any content or materials you may access on the Site. Nothing contained on the Site should be construed as granting any license or right to use any Trademark displayed on the Site without our written permission or that of the third party rights holder.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	4. COMMUNICATIONS TO LANGYING AND USER GENERATED CONTENT. &nbsp;Although we encourage you to e-mail us, you should not e-mail us anything that contains confidential information. Please refer to our Privacy Notice with regard to how we handle your personal information. With respect to all e-mails you send to us, including but not limited to feedback, questions, comments, suggestions, and the like, we shall be free to use any ideas, concepts, know-how, or techniques contained in your communications for any purpose whatsoever, including but not limited to, the development, production and marketing of products and services that incorporate such information.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	LangYing&nbsp;does not and cannot review all communications and materials posted to or created by users accessing the Services (hereinafter, "User Generated Content"), and is not in any manner responsible for the content of the User Generated Content. LangYing&nbsp;reserves the right to block or remove communications or materials that it determines to be in violation of our guidelines or is offensive or otherwise unacceptable to LangYing&nbsp;in its sole discretion.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	You own the rights to anything you post to the Services, including text and photographs, PPT slides and audio or video. You do, however, grant us an irrevocable, non-exclusive, worldwide, perpetual, royalty-free license to use, modify, copy, distribute, publish, perform, sublicense, and create derivative works from all submissions you provide to us, in any media now known or hereafter devised.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	5. USER CONDUCT. &nbsp;While using the Site and the Services, you agree not to:\n</p>\n<p class="MsoNormal">\n	•&nbsp;use the Site or the Services in violation of any applicable law;\n</p>\n<p class="MsoNormal">\n	•&nbsp;use the Site or the Services or features in violation of LangYing\'s or any third party\'s intellectual property or other proprietary, personal or legal rights;\n</p>\n<p class="MsoNormal">\n	•&nbsp;obtain or attempt to obtain unauthorized access to computer systems, materials, information or any Services made available on or through the Site through any means;\n</p>\n<p class="MsoNormal">\n	•&nbsp;attempt to gain unauthorized access to other computer systems through the Site;\n</p>\n<p class="MsoNormal">\n	•&nbsp;impersonate any person or entity or misrepresent your affiliation with any other person or entity;\n</p>\n<p class="MsoNormal">\n	•&nbsp;attempt (or encourage or support anyone else\'s attempt) to circumvent, reverse engineer, decrypt, or otherwise alter or interfere with the Site or the Services, or any content thereof, or make unauthorized use thereof;\n</p>\n<p class="MsoNormal">\n	•&nbsp;use the Site in any manner that could damage, disable, overburden, or impair the Site or interfere with any other party\'s use and enjoyment of the Site;\n</p>\n<p class="MsoNormal">\n	•&nbsp;obtain or attempt to obtain any materials or information through any means not intentionally made publicly available or provided for through the Site.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	6. &nbsp;NO WARRANTIES. &nbsp;WE AND OUR SERVICE PROVIDERS MAKE NO WARRANTIES OR REPRESENTATIONS ABOUT THE CONTENTS OF THE SITE OR THE SERVICE. WE SHALL NOT BE SUBJECT TO LIABILITY FOR ANY DELAYS OR INTERRUPTIONS OF THE SITE OR THE SERVICE FROM WHATEVER CAUSE. YOU AGREE THAT YOU USE THE WEBSITE, THE SITE’S CONTENT, AND THE SERVICE AT YOUR OWN RISK. THE SITE AND THE SERVICE MAY CONTAIN TECHNICAL INACCURACIES OR TYPOGRAPHICAL ERRORS OR OMISSIONS. LANGYING IS NOT RESPONSIBLE FOR ANY SUCH TYPOGRAPHICAL OR TECHNICAL ERRORS. LANGYING RESERVES THE RIGHT TO MAKE CHANGES, CORRECTIONS, AND/OR IMPROVEMENTS TO THE SITE AND THE SERVICE AT ANY TIME WITHOUT NOTICE.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	IN NO EVENT SHALL EITHER PARTY BE LIABLE TO THE OTHER PARTY (OR TO ANY OTHER PERSON CLAIMING RIGHTS DERIVED FROM SUCH PARTY’S RIGHTS) FOR CONSEQUENTIAL, INCIDENTAL, INDIRECT, PUNITIVE OR EXEMPLARY DAMAGES OF ANY KIND (INCLUDING WITHOUT LIMITATION LOST REVENUES OR PROFITS, LOSS OF USE, LOSS OF COST OR OTHER SAVINGS, LOSS OF GOODWILL OR REPUTATION) OR LOSS OF DATA WITH RESPECT TO ANY CLAIMS BASED ON CONTRACT, TORT OR OTHERWISE (INCLUDING NEGLIGENCE AND STRICT LIABILITY) ARISING FROM OR RELATING TO THE SERVICESAND/ORTHE SITE, THE MATERIALS OR OTHERWISE ARISING FROM OR RELATING TO THESE TERMS OF USE, REGARDLESS OF WHETHER SUCH PROTECTED ENTITY WAS ADVISED, HAD OTHER REASON TO KNOW, OR IN FACT KNEW OF THE POSSIBILITY THEREOF. LANGYING’S MAXIMUM LIABILITY ARISING FROM OR RELATING TO THE theSERVICESAND/ORTHE SITE, THE MATERIALS OR OTHERWISE ARISING FROM OR RELATING TO THIS AGREEMENT, REGARDLESS OF THE CAUSE OF ACTION (WHETHER IN CONTRACT, TORT, BREACH OF WARRANTY OR OTHERWISE), WILL NOT EXCEED THE AMOUNTS PAID BY YOU TO LANGYING HEREUNDER.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	7. EXTERNAL WEBSITES. &nbsp;The Site may contain links to third-party websites (“External Websites”). These links are provided solely as a convenience to you and not as an endorsement by us of the content on such External Websites. We are not responsible for the content of any linked External Websites and do not make any representations regarding the content or accuracy of materials on such External Websites.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	8. INDEMNIFICATION. &nbsp;You agree to defend, indemnify, and hold us and our officers, directors, employees, successors, licensees, service providers, and assignees harmless from and against any claims, actions, or demands, including, without limitation, reasonable legal and accounting fees, arising or resulting from your breach of this Agreement or your access to, use, or misuse of the LangYing’scontent, the Site, or the Service. We shall provide notice to you of any such claim, suit, or proceeding and shall assist you, at your expense, in defending any such claim, suit, or proceeding. We reserve the right to assume the exclusive defense and control of any matter that is subject to indemnification under this section. In such case, you agree to cooperate with any reasonable requests assisting our defense of such matter.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	9. INFRINGEMENT NOTIFICATION. We respect the intellectual property rights of others, and require that the people who use the Site do the same. If you believe that your work has been copied in a way that constitutes copyright infringement, please send notifications of the claimed infringement to: Legal Department, LangYing, 19A, No.121, Yanping Road, Jing’an District, Shanghai, China. Notices of the claimed infringement should include the following information: (a) your address, telephone number, and email address; (b) a description of the copyrighted work that you claim has been infringed; (c) a description of where the alleged infringing material is located, with a link if possible; (d) a statement by you that you have a good faith belief that the disputed use is not authorized by the copyright owner, its agent, or the law; (e) an electronic or physical signature of the person authorized to act on behalf of the owner of the copyright interest; (f) a statement by you, made under penalty of perjury, that the above information in your notice is accurate and that you are the copyright owner or authorized to act on the copyright owner\'s behalf.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	10. COMPLIANCE WITH APPLICABLE LAWS. &nbsp;We control and operate the Site from our offices in the Peoples Republic of China. We do not represent that materials on the Site are appropriate or available for use in other locations. Persons who choose to access the Site from other locations do so on their own initiative, and are responsible for compliance with local laws, if and to the extent local laws are applicable. All parties to these terms and conditions waive their respective rights to a trial by jury. &nbsp;\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	11. TERMINATION OF THE AGREEMENT. &nbsp;Subject to the terms of the Services Agreement, if applicable, we reserve the right, in our sole discretion, to restrict, suspend, or terminate this Agreement and your access to the Services and/or all or any part of the Site, at any time and for any reason without prior notice or liability.Your access to the Services and/or all or any part of the Siteshall end immediately upon any termination or expiration of this Agreement, and you&nbsp;shall immediately cease any use of the Servicesand/orthe Site upon such termination.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	12. MISCELLANEOUS. &nbsp;If any provision of this Agreement is found to be invalid by any court having competent jurisdiction or terminated in accordance with the Termination provision above, the invalidity or termination of such provision shall not affect the validity of the following provisions of this Agreement, which shall remain in full force and effect: “Intellectual Property,” “Communications to LangYing” “No Warranties,” “Indemnification,” “Termination of the Agreement,” and “Miscellaneous.” Our failure to act on or enforce any provision of the Agreement shall not be construed as a waiver of that provision or any other provision in this Agreement. No waiver shall be effective against us unless made in writing, and no such waiver shall be construed as a waiver in any other or subsequent instance. Except as expressly agreed by us and you in writing, this Agreement constitutes the entire Agreement between you and us with respect to the subject matter, and supersedes all previous or contemporaneous agreements, whether written or oral, between the parties with respect to the subject matter. The section headings are provided merely for convenience and shall not be given any legal import. This Agreement will inure to the benefit of our successors, assigns, licensees, and sublicensees.\n</p>\n<p class="MsoNormal">\n	&nbsp;\n</p>\n<p class="MsoNormal">\n	Copyright 2016 LangYing Education And Technology. All rights reserved.\n</p>\n</div>'}),define("term",["text!root-tpl/term.tpl"],function(e){var t=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e)},events:{},reset:function(){this.$el.html("")},init:function(){var e=this;e.render()},render:function(e){var t=this;t.$el.html(t._tpl({}))}});return t}),define("text!root-tpl/exercise/main.tpl",[],function(){return'<div class="bg"></div>\n<div class="ui-exercise">\n	<div class="mask"></div>\n	<div class="main">\n		<a href="javascript:;" class="btn-toggle-article">\n			<i class="icon-linear">&#xe90f;</i>\n			查看文章\n		</a>\n		<div class="article-area" style="display:none;">\n			<p class="close-articl">\n				<span class="icon-arrow-duble-right iconfont icon-linear ">\n				    &#xe90e;\n				</span>\n			</p>\n			<div class="main default-skin">\n				<div class="inner">\n					\n				</div>\n				\n			</div>\n		</div>\n		<div class="ui-process fix">\n			\n		</div>\n		<div class="exercise-area">\n			\n		</div>\n		\n	</div>\n</div>'}),define("text!root-tpl/exercise/reading.tpl",[],function(){return"\n{{~it.list :v:i}}\n<p>\n	{{~v :val:key}}\n	<span>{{=val.content}}</span>\n	{{~}}\n</p>\n{{~}}"}),define("text!root-tpl/exercise/process.tpl",[],function(){return'<div class="txt-area">\n	<i class="current">{{=it.index}}</i>\n	/\n	<i class="total">{{=it.total}}</i>\n</div>\n<div class="process-area">\n	<div class="bar">\n		<div class="done" style="width:{{=it.index*100/it.total}}%">\n			<i class="icon-done"></i>\n		</div>\n	</div>\n\n</div>'}),define("exercise/base",["text!root-tpl/exercise/main.tpl","text!root-tpl/exercise/reading.tpl","text!root-tpl/exercise/process.tpl","../model","root-common/util","root-common/module/scrollbar"],function(e,t,n,r,i){var s=Backbone.View.extend({initialize:function(i){var s=this;s.mainTpl=doT.template(e),s.readingTpl=doT.template(t),s.processTpl=doT.template(n),s.bookId=i.bookId,s.book=null,s.index=i.index,s.total=0,s.type=2,s.data=null,s.model=new r,s.model.bind({getArticleInfo:$.proxy(s.getArticleInfo,s),getExercises:$.proxy(s.getExercises,s),saveExercise:$.proxy(s.saveExercise,s)}),s.model.getArticleInfo({data:{bookId:s.bookId}})},events:{"click .btn-toggle-article":"toggleArticle","click .icon-arrow-duble-right":"closeArticle","click .btn-next":"next"},renderMain:function(){var e=this;e.$el.html(e.mainTpl({}))},renderProcess:function(e){var t=this;$(".ui-process",t.$el).html(t.processTpl({index:t.index+1,total:t.total}))},reset:function(){this.$el.html(""),this.undelegateEvents()},toggleArticle:function(e){e.preventDefault();var t=this;window.audioPlay.click(),$(".article-area",t.$el).toggle(),$(".article-area .main",t.$el).customScrollbar({updateOnWindowResize:!0})},closeArticle:function(e){e.preventDefault();var t=this;window.audioPlay.click(),$(".article-area",t.$el).hide(),$(".article-area .main",t.$el).customScrollbar({updateOnWindowResize:!1})},getArticleInfo:function(e,t,n,r){var s=this;i.dealAjax(function(t){var n=e.data;t||(s.book=n,s.model.getExercises({data:{questionStyleId:s.type,bookId:s.bookId}}))},e,t)},getExercises:function(e,t,n,r){var s=this;i.dealAjax(function(t){var n=e.data;if(!t){s.total=n.exercisesCount,s.data=n;if(n.exercisesList[s.index].doStatus==1){var r=s.goNext();if(r)return}s.renderMain(),s.renderReading(s.book),s.renderProcess(n),s.render()}},e,t)},saveExercise:function(e,t,n,r){var s=this;i.dealAjax(function(e){s.data.exercisesList[s.index].doStatus=1},e,t)},renderReading:function(e){var t=this;$(".article-area .inner",t.$el).html(t.readingTpl({list:e.content||[]}))},goNext:function(e,t){var n=this,r=!1;window.audioPlay.click(),e=e?e:n.index;var i=n.data.exercisesList[e];return e>=n.total-1&&i.doStatus==1?window.location.href="#testResult/"+n.bookId+"/"+n.type:i.doStatus==1?n.goNext(e+1,!0):(r=!0,e=t?e:++e,window.location.href="#exercise/"+n.bookId+"/"+e),r}});return s}),define("text!root-tpl/exercise/choice.tpl",[],function(){return'{{\n	var right = null;\n	var index = null;\n}}\n\n<div class="ui-choice">\n	<div class="title">\n		Choose the best answer to the questions below.\n	</div>\n\n	<div class="question-area" data-id="{{=it.exercise.questionId}}" data-userdoid="{{=it.exercise.userDoquestionId}}">\n		<div class="line"></div>\n		<div class="content">\n			<div class="row-title">Question:</div>\n			<div class="question">{{=it.title}}</div>\n			<div class="row-title">Option:</div>\n			<ul class="option-list">\n				{{~it.list :v:i}}\n				{{ if($.trim(v.questionOption)){ }}\n				<li class="option-item \n				{{ if(i == it.list.length - 1){ }}\n				option-item-last \n				{{ } }}\n				{{ if(v.isRight){ }}\n				option-right \n				{{ }else{ }}\n				option-error \n				{{ } }}\n				"  data-id="{{=v.questionOptionId}}">\n					{{=it.options[i]}}. {{=v.questionOption}}\n					<i class="icon-solid icon-result icon-error">&#xe915;</i>\n					<i class="icon-solid icon-result icon-right">&#xe916;</i>\n				</li>\n\n				{{ \n					if(v.isRight){\n						right = v;\n						index = i;\n					}\n				}}\n				{{ } }}\n				{{~}}\n			</ul>\n		</div>\n		<a class="btn btn-check btn-disable" href="javascript:;">检&nbsp;&nbsp;查</a>\n	</div>\n\n	<div class="answer-area" style="display:none;">\n		<div class="line"></div>\n		<div class="row-title">The Answer:</div>\n		<div class="answer">\n			<p>{{=it.options[index]}}. {{=right.questionOption}}</p>\n		</div>\n		<a class="btn btn-next" href="javascript:;">继&nbsp;&nbsp;续</a>\n	</div>\n</div>'}),define("exercise/choice",["./base","text!root-tpl/exercise/choice.tpl","root-common/util"],function(e,t,n){var r="ABCDEFGH".split(""),i=e.extend({initialize:function(n){var r=this;e.prototype.initialize.apply(this,arguments),r.events=$.extend(!0,{},e.prototype.events,r.events),r.delegateEvents(),r._tpl=doT.template(t),r.type=2,r.hasChecked=!1},events:{"click .option-item":"_select","click .btn-check":"_checkAnswer"},render:function(){var e=this;try{var t=e.data.exercisesList[e.index],i=t.exercisesOptionInfoL,s=t.question;for(var o=0;o<i.length;o++)$.trim(i[o].questionOption)||(i.splice(o,1),o--);$(".exercise-area",e.$el).html(e._tpl({title:s,list:i||[],exercise:t,options:r}))}catch(u){n.errorTip("第"+(e.index+1)+"道题目不存在",!0)}},_select:function(e){e.preventDefault();var t=this;t.hasChecked||($(".item-selected",t.$el).removeClass("item-selected"),$(e.currentTarget).addClass("item-selected"),$(".btn-check",t.$el).removeClass("btn-disable"))},_checkAnswer:function(e){e.preventDefault();var t=this;if($(e.currentTarget).hasClass("btn-disable"))return;t.hasChecked=!0,$(".question-area",t.$el).addClass("question-done"),$(".answer-area",t.$el).show();var n=$(".item-selected",t.$el),r=$(".question-area",t.$el).data("userdoid"),i=n.data("id");n.hasClass("option-right")?window.audioPlay.right():window.audioPlay.error(),t.index<=t.total-1&&t.model.saveExercise({data:{userDoquestionId:r,userOptionId:i}})},next:function(e){this.goNext()}});return i}),define("exercise/factory",["./choice"],function(e){return{list:[],init:function(t){if(!t||!t.type)return null;var n=t.type,r=null;switch(n){case"choice":r=new e(t)}return r&&this.list.push(r),r},reset:function(){$.each(this.list,function(e,t){t.reset()}),this.list=[]}}}),define("exercise/main",["./factory"],function(e){var t=Backbone.View.extend({initialize:function(e){},init:function(t,n){var r=this;n=parseInt(n),e.init({el:r.el,type:"choice",bookId:t,index:n})},reset:function(){e.reset()}});return t}),define("text!root-tpl/exercise/header.tpl",[],function(){return'<div class="inner">\n	<div class="mask"></div>\n	<div class="main">\n		<a class="btn-back" href="javascript:;">\n			<i class="icon-solid">&#xe913;</i>返回\n		</a>\n		<div class="book-area">\n			<div class="img">\n				<img src="{{=window.imgPath}}/{{=it.book.imgurl}}" />\n			</div>\n			<div class="txt">\n				{{=it.book.booktitle}}\n			</div>\n		</div>\n	</div>\n</div>'}),define("exercise/header",["text!root-tpl/exercise/header.tpl","../model","root-common/util"],function(e,t,n){var r=Backbone.View.extend({initialize:function(n){var r=this;r.tpl=doT.template(e),r._model=new t,r._model.bind({getArticleInfo:$.proxy(r.getArticleInfo,r)}),r.returnBack=null,r.booId=null},init:function(e,t){var n=this;n.booId=e,this._model.getArticleInfo({data:{bookId:e}}),n.returnBack=t},reset:function(){this.$el.html("")},events:{"click .btn-back":"btnBck"},btnBck:function(e){e.preventDefault();var t=this;window.audioPlay.click(),t.returnBack==1?window.location.href="#bookNav/"+t.booId:window.location.href="#booklist"},getArticleInfo:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;t||s.$el.html(s.tpl({book:n}))},e,t)},animLeft:function(){var e=this;$(".inner",e.$el).stop().animate({left:"-100%"},"slow",function(){e.reset()})}});return r}),define("text!root-tpl/recommend/main.tpl",[],function(){return'<div class="bg"></div>\n<div class="main">\n\n	<div class="mask"></div>\n	<div class="content">\n		<img src="./images/recommend-grade.gif" class="introduction">\n		<div class="selection-area">\n			<div class="header">\n				<img src="./images/bride.png" height="65" width="73">\n				<span>你好，同学！在阅读以前，请选择所在的年级哦~！我们会给你推荐合适的读物的！</span>\n			</div>\n			<div class="grade-list">\n				<div class="grade-slider">\n					<input type="text" class="input-grade" value="" name="range" />\n				</div>\n				\n				<ul class="fix">\n					<li class="on active" data-id="G1"><p class="sanjiao"></p>一年级 <i>G1</i></li>\n					<li data-id="G2"><p class="sanjiao"></p>二年级 <i>G2</i></li>\n					<li data-id="G3"><p class="sanjiao"></p>三年级 <i>G3</i></li>\n					<li data-id="G4"><p class="sanjiao"></p>四年级 <i>G4</i></li>\n					<li data-id="G5"><p class="sanjiao"></p>五年级 <i>G5</i></li>\n					<li data-id="G6" class="wide">\n						<p class="sanjiao"></p>\n						<div class="row">六年级 <i>G6</i></div>\n						<div class="row"><em class="top">（</em>预初<em class="bottom">）</em></div>\n					</li>\n					<li data-id="G7" class="chuyi"><p class="sanjiao"></p>初<br><br>一 <i>G7</i></li>\n					<li data-id="G8"><p class="sanjiao"></p>初<br><br>二 <i>G8</i></li>\n					<li data-id="G9"><p class="sanjiao"></p>初<br><br>三 <i>G9</i></li>\n					<li data-id="G10"><p class="sanjiao"></p>高<br><br>一 <i>G10</i></li>\n					<li data-id="G11"><p class="sanjiao"></p>高<br><br>二 <i>G11</i></li>\n					<li data-id="G12"><p class="sanjiao"></p>高<br><br>三 <i>G12</i></li>\n				</ul>\n			</div>\n			<a class="btn btn-confirm" href="javascript:;">确&nbsp;&nbsp;定</a>\n		</div>\n	</div>\n</div>'}),define("text!root-tpl/recommend/grade-list.tpl",[],function(){return'{{~it.list :v:i}}\n{{\n	var name = v.grade_name;\n	var splitIndex = name.indexOf(\'（\');\n}}\n{{ if(splitIndex !== -1){ }}\n<li data-id="{{=v.grade_id}}" class="wide">\n	{{\n		var desc = name.slice(splitIndex+1, name.length-1);\n		name = name.slice(0, splitIndex);\n	}}\n	<p class="sanjiao"></p>\n	<div class="row">{{=name}} <i>{{=window.gradeMap[v.grade_id]}}</i></div>\n	<div class="row"><em class="top">（</em>{{=desc}}<em class="bottom">）</em></div></li>\n{{ }else{ }}\n<li data-id="{{=v.grade_id}}" class="grade-{{=v.grade_id}}"><p class="sanjiao"></p><span>{{=name}}</span> <i>{{=window.gradeMap[v.grade_id]}}</i></li>\n{{ } }}\n\n{{~}}'}),define("root-common/module/dragval",[],function(){"use strict";var e=0,t=function(){var e=navigator.userAgent,t=/msie\s\d+/i,n;if(e.search(t)>0){n=t.exec(e).toString(),n=n.split(" ")[1];if(n<9)return $("html").addClass("lt-ie9"),!0}return!1}();Function.prototype.bind||(Function.prototype.bind=function(t){var n=this,r=[].slice;if(typeof n!="function")throw new TypeError;var i=r.call(arguments,1),s=function(){if(this instanceof s){var e=function(){};e.prototype=n.prototype;var o=new e,u=n.apply(o,i.concat(r.call(arguments)));return Object(u)===u?u:o}return n.apply(t,i.concat(r.call(arguments)))};return s}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(this==null)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(i===0)return-1;var s=+t||0;Math.abs(s)===Infinity&&(s=0);if(s>=i)return-1;n=Math.max(s>=0?s:i-Math.abs(s),0);while(n<i){if(n in r&&r[n]===e)return n;n++}return-1});var n='<span class="irs"><span class="irs-line" tabindex="-1"><span class="irs-line-left"></span><span class="irs-line-mid"></span><span class="irs-line-right"></span></span><span class="irs-min">0</span><span class="irs-max">1</span><span class="irs-from">0</span><span class="irs-to">0</span><span class="irs-single">0</span></span><span class="irs-grid"></span><span class="irs-bar"></span>',r='<span class="irs-bar-edge"></span><span class="irs-shadow shadow-single"></span><span class="irs-slider single"></span>',i='<span class="irs-shadow shadow-from"></span><span class="irs-shadow shadow-to"></span><span class="irs-slider from"></span><span class="irs-slider to"></span>',s='<span class="irs-disable-mask"></span>',o=function(e,t,n){this.VERSION="2.1.4",this.input=e,this.plugin_count=n,this.current_plugin=0,this.calc_count=0,this.update_tm=0,this.old_from=0,this.old_to=0,this.old_min_interval=null,this.raf_id=null,this.dragging=!1,this.force_redraw=!1,this.no_diapason=!1,this.is_key=!1,this.is_update=!1,this.is_start=!0,this.is_finish=!1,this.is_active=!1,this.is_resize=!1,this.is_click=!1,this.$cache={win:$(window),body:$(document.body),input:$(e),cont:null,rs:null,min:null,max:null,from:null,to:null,single:null,bar:null,line:null,s_single:null,s_from:null,s_to:null,shad_single:null,shad_from:null,shad_to:null,edge:null,grid:null,grid_labels:[]},this.coords={x_gap:0,x_pointer:0,w_rs:0,w_rs_old:0,w_handle:0,p_gap:0,p_gap_left:0,p_gap_right:0,p_step:0,p_pointer:0,p_handle:0,p_single_fake:0,p_single_real:0,p_from_fake:0,p_from_real:0,p_to_fake:0,p_to_real:0,p_bar_x:0,p_bar_w:0,grid_gap:0,big_num:0,big:[],big_w:[],big_p:[],big_x:[]},this.labels={w_min:0,w_max:0,w_from:0,w_to:0,w_single:0,p_min:0,p_max:0,p_from_fake:0,p_from_left:0,p_to_fake:0,p_to_left:0,p_single_fake:0,p_single_left:0};var r=this.$cache.input,i=r.prop("value"),s,o,u;s={type:"single",min:10,max:100,from:null,to:null,step:1,min_interval:0,max_interval:0,drag_interval:!1,values:[],p_values:[],from_fixed:!1,from_min:null,from_max:null,from_shadow:!1,to_fixed:!1,to_min:null,to_max:null,to_shadow:!1,prettify_enabled:!0,prettify_separator:" ",prettify:null,force_edges:!1,keyboard:!1,keyboard_step:5,grid:!1,grid_margin:!0,grid_num:4,grid_snap:!1,hide_min_max:!1,hide_from_to:!1,prefix:"",postfix:"",max_postfix:"",decorate_both:!0,values_separator:" — ",input_values_separator:";",disable:!1,onStart:null,onChange:null,onFinish:null,onUpdate:null},o={type:r.data("type"),min:r.data("min"),max:r.data("max"),from:r.data("from"),to:r.data("to"),step:r.data("step"),min_interval:r.data("minInterval"),max_interval:r.data("maxInterval"),drag_interval:r.data("dragInterval"),values:r.data("values"),from_fixed:r.data("fromFixed"),from_min:r.data("fromMin"),from_max:r.data("fromMax"),from_shadow:r.data("fromShadow"),to_fixed:r.data("toFixed"),to_min:r.data("toMin"),to_max:r.data("toMax"),to_shadow:r.data("toShadow"),prettify_enabled:r.data("prettifyEnabled"),prettify_separator:r.data("prettifySeparator"),force_edges:r.data("forceEdges"),keyboard:r.data("keyboard"),keyboard_step:r.data("keyboardStep"),grid:r.data("grid"),grid_margin:r.data("gridMargin"),grid_num:r.data("gridNum"),grid_snap:r.data("gridSnap"),hide_min_max:r.data("hideMinMax"),hide_from_to:r.data("hideFromTo"),prefix:r.data("prefix"),postfix:r.data("postfix"),max_postfix:r.data("maxPostfix"),decorate_both:r.data("decorateBoth"),values_separator:r.data("valuesSeparator"),input_values_separator:r.data("inputValuesSeparator"),disable:r.data("disable")},o.values=o.values&&o.values.split(",");for(u in o)o.hasOwnProperty(u)&&!o[u]&&o[u]!==0&&delete o[u];i&&(i=i.split(o.input_values_separator||t.input_values_separator||";"),i[0]&&i[0]==+i[0]&&(i[0]=+i[0]),i[1]&&i[1]==+i[1]&&(i[1]=+i[1]),t&&t.values&&t.values.length?(s.from=i[0]&&t.values.indexOf(i[0]),s.to=i[1]&&t.values.indexOf(i[1])):(s.from=i[0]&&+i[0],s.to=i[1]&&+i[1])),$.extend(s,t),$.extend(s,o),this.options=s,this.validate(),this.result={input:this.$cache.input,slider:null,min:this.options.min,max:this.options.max,from:this.options.from,from_percent:0,from_value:null,to:this.options.to,to_percent:0,to_value:null},this.init()};o.prototype={init:function(e){this.no_diapason=!1,this.coords.p_step=this.convertToPercent(this.options.step,!0),this.target="base",this.toggleInput(),this.append(),this.setMinMax(),e?(this.force_redraw=!0,this.calc(!0),this.callOnUpdate()):(this.force_redraw=!0,this.calc(!0),this.callOnStart()),this.updateScene()},append:function(){var e='<span class="irs js-irs-'+this.plugin_count+'"></span>';this.$cache.input.before(e),this.$cache.input.prop("readonly",!0),this.$cache.cont=this.$cache.input.prev(),this.result.slider=this.$cache.cont,this.$cache.cont.html(n),this.$cache.rs=this.$cache.cont.find(".irs"),this.$cache.min=this.$cache.cont.find(".irs-min"),this.$cache.max=this.$cache.cont.find(".irs-max"),this.$cache.from=this.$cache.cont.find(".irs-from"),this.$cache.to=this.$cache.cont.find(".irs-to"),this.$cache.single=this.$cache.cont.find(".irs-single"),this.$cache.bar=this.$cache.cont.find(".irs-bar"),this.$cache.line=this.$cache.cont.find(".irs-line"),this.$cache.grid=this.$cache.cont.find(".irs-grid"),this.options.type==="single"?(this.$cache.cont.append(r),this.$cache.edge=this.$cache.cont.find(".irs-bar-edge"),this.$cache.s_single=this.$cache.cont.find(".single"),this.$cache.from[0].style.visibility="hidden",this.$cache.to[0].style.visibility="hidden",this.$cache.shad_single=this.$cache.cont.find(".shadow-single")):(this.$cache.cont.append(i),this.$cache.s_from=this.$cache.cont.find(".from"),this.$cache.s_to=this.$cache.cont.find(".to"),this.$cache.shad_from=this.$cache.cont.find(".shadow-from"),this.$cache.shad_to=this.$cache.cont.find(".shadow-to"),this.setTopHandler()),this.options.hide_from_to&&(this.$cache.from[0].style.display="none",this.$cache.to[0].style.display="none",this.$cache.single[0].style.display="none"),this.appendGrid(),this.options.disable?(this.appendDisableMask(),this.$cache.input[0].disabled=!0):(this.$cache.cont.removeClass("irs-disabled"),this.$cache.input[0].disabled=!1,this.bindEvents()),this.options.drag_interval&&(this.$cache.bar[0].style.cursor="ew-resize")},setTopHandler:function(){var e=this.options.min,t=this.options.max,n=this.options.from,r=this.options.to;n>e&&r===t?this.$cache.s_from.addClass("type_last"):r<t&&this.$cache.s_to.addClass("type_last")},changeLevel:function(e){switch(e){case"single":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_single_fake);break;case"from":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_from_fake),this.$cache.s_from.addClass("state_hover"),this.$cache.s_from.addClass("type_last"),this.$cache.s_to.removeClass("type_last");break;case"to":this.coords.p_gap=this.toFixed(this.coords.p_pointer-this.coords.p_to_fake),this.$cache.s_to.addClass("state_hover"),this.$cache.s_to.addClass("type_last"),this.$cache.s_from.removeClass("type_last");break;case"both":this.coords.p_gap_left=this.toFixed(this.coords.p_pointer-this.coords.p_from_fake),this.coords.p_gap_right=this.toFixed(this.coords.p_to_fake-this.coords.p_pointer),this.$cache.s_to.removeClass("type_last"),this.$cache.s_from.removeClass("type_last")}},appendDisableMask:function(){this.$cache.cont.append(s),this.$cache.cont.addClass("irs-disabled")},remove:function(){this.$cache.cont.remove(),this.$cache.cont=null,this.$cache.line.off("keydown.irs_"+this.plugin_count),this.$cache.body.off("touchmove.irs_"+this.plugin_count),this.$cache.body.off("mousemove.irs_"+this.plugin_count),this.$cache.win.off("touchend.irs_"+this.plugin_count),this.$cache.win.off("mouseup.irs_"+this.plugin_count),t&&(this.$cache.body.off("mouseup.irs_"+this.plugin_count),this.$cache.body.off("mouseleave.irs_"+this.plugin_count)),this.$cache.grid_labels=[],this.coords.big=[],this.coords.big_w=[],this.coords.big_p=[],this.coords.big_x=[],cancelAnimationFrame(this.raf_id)},bindEvents:function(){if(this.no_diapason)return;this.$cache.body.on("touchmove.irs_"+this.plugin_count,this.pointerMove.bind(this)),this.$cache.body.on("mousemove.irs_"+this.plugin_count,this.pointerMove.bind(this)),this.$cache.win.on("touchend.irs_"+this.plugin_count,this.pointerUp.bind(this)),this.$cache.win.on("mouseup.irs_"+this.plugin_count,this.pointerUp.bind(this)),this.$cache.line.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.line.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.options.drag_interval&&this.options.type==="double"?(this.$cache.bar.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"both")),this.$cache.bar.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"both"))):(this.$cache.bar.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.bar.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"))),this.options.type==="single"?(this.$cache.single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.s_single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.shad_single.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.s_single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"single")),this.$cache.edge.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.shad_single.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"))):(this.$cache.single.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,null)),this.$cache.single.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,null)),this.$cache.from.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.s_from.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.to.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.s_to.on("touchstart.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.shad_from.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.shad_to.on("touchstart.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.from.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.s_from.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"from")),this.$cache.to.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.s_to.on("mousedown.irs_"+this.plugin_count,this.pointerDown.bind(this,"to")),this.$cache.shad_from.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click")),this.$cache.shad_to.on("mousedown.irs_"+this.plugin_count,this.pointerClick.bind(this,"click"))),this.options.keyboard&&this.$cache.line.on("keydown.irs_"+this.plugin_count,this.key.bind(this,"keyboard")),t&&(this.$cache.body.on("mouseup.irs_"+this.plugin_count,this.pointerUp.bind(this)),this.$cache.body.on("mouseleave.irs_"+this.plugin_count,this.pointerUp.bind(this)))},pointerMove:function(e){if(!this.dragging)return;var t=e.pageX||e.originalEvent.touches&&e.originalEvent.touches[0].pageX;this.coords.x_pointer=t-this.coords.x_gap,this.calc()},pointerUp:function(e){if(this.current_plugin!==this.plugin_count)return;if(!this.is_active)return;this.is_active=!1,this.$cache.cont.find(".state_hover").removeClass("state_hover"),this.force_redraw=!0,t&&$("*").prop("unselectable",!1),this.updateScene(),this.restoreOriginalMinInterval();if($.contains(this.$cache.cont[0],e.target)||this.dragging)this.is_finish=!0,this.callOnFinish();this.dragging=!1},pointerDown:function(e,n){n.preventDefault();var r=n.pageX||n.originalEvent.touches&&n.originalEvent.touches[0].pageX;if(n.button===2)return;e==="both"&&this.setTempMinInterval(),e||(e=this.target),this.current_plugin=this.plugin_count,this.target=e,this.is_active=!0,this.dragging=!0,this.coords.x_gap=this.$cache.rs.offset().left,this.coords.x_pointer=r-this.coords.x_gap,this.calcPointerPercent(),this.changeLevel(e),t&&$("*").prop("unselectable",!0),this.$cache.line.trigger("focus"),this.updateScene()},pointerClick:function(e,t){t.preventDefault();var n=t.pageX||t.originalEvent.touches&&t.originalEvent.touches[0].pageX;if(t.button===2)return;this.current_plugin=this.plugin_count,this.target=e,this.is_click=!0,this.coords.x_gap=this.$cache.rs.offset().left,this.coords.x_pointer=+(n-this.coords.x_gap).toFixed(),this.force_redraw=!0,this.calc(),this.$cache.line.trigger("focus")},key:function(e,t){if(this.current_plugin!==this.plugin_count||t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return;switch(t.which){case 83:case 65:case 40:case 37:t.preventDefault(),this.moveByKey(!1);break;case 87:case 68:case 38:case 39:t.preventDefault(),this.moveByKey(!0)}return!0},moveByKey:function(e){var t=this.coords.p_pointer;e?t+=this.options.keyboard_step:t-=this.options.keyboard_step,this.coords.x_pointer=this.toFixed(this.coords.w_rs/100*t),this.is_key=!0,this.calc()},setMinMax:function(){if(!this.options)return;if(this.options.hide_min_max){this.$cache.min[0].style.display="none",this.$cache.max[0].style.display="none";return}this.options.values.length?(this.$cache.min.html(this.decorate(this.options.p_values[this.options.min])),this.$cache.max.html(this.decorate(this.options.p_values[this.options.max]))):(this.$cache.min.html(this.decorate(this._prettify(this.options.min),this.options.min)),this.$cache.max.html(this.decorate(this._prettify(this.options.max),this.options.max))),this.labels.w_min=this.$cache.min.outerWidth(!1),this.labels.w_max=this.$cache.max.outerWidth(!1)},setTempMinInterval:function(){var e=this.result.to-this.result.from;this.old_min_interval===null&&(this.old_min_interval=this.options.min_interval),this.options.min_interval=e},restoreOriginalMinInterval:function(){this.old_min_interval!==null&&(this.options.min_interval=this.old_min_interval,this.old_min_interval=null)},calc:function(e){if(!this.options)return;this.calc_count++;if(this.calc_count===10||e)this.calc_count=0,this.coords.w_rs=this.$cache.rs.outerWidth(!1),this.calcHandlePercent();if(!this.coords.w_rs)return;this.calcPointerPercent();var t=this.getHandleX();this.target==="click"&&(this.coords.p_gap=this.coords.p_handle/2,t=this.getHandleX(),this.options.drag_interval?this.target="both_one":this.target=this.chooseHandle(t));switch(this.target){case"base":var n=(this.options.max-this.options.min)/100,r=(this.result.from-this.options.min)/n,i=(this.result.to-this.options.min)/n;this.coords.p_single_real=this.toFixed(r),this.coords.p_from_real=this.toFixed(r),this.coords.p_to_real=this.toFixed(i),this.coords.p_single_real=this.checkDiapason(this.coords.p_single_real,this.options.from_min,this.options.from_max),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_single_fake=this.convertToFakePercent(this.coords.p_single_real),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real),this.target=null;break;case"single":if(this.options.from_fixed)break;this.coords.p_single_real=this.convertToRealPercent(t),this.coords.p_single_real=this.calcWithStep(this.coords.p_single_real),this.coords.p_single_real=this.checkDiapason(this.coords.p_single_real,this.options.from_min,this.options.from_max),this.coords.p_single_fake=this.convertToFakePercent(this.coords.p_single_real);break;case"from":if(this.options.from_fixed)break;this.coords.p_from_real=this.convertToRealPercent(t),this.coords.p_from_real=this.calcWithStep(this.coords.p_from_real),this.coords.p_from_real>this.coords.p_to_real&&(this.coords.p_from_real=this.coords.p_to_real),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_from_real=this.checkMinInterval(this.coords.p_from_real,this.coords.p_to_real,"from"),this.coords.p_from_real=this.checkMaxInterval(this.coords.p_from_real,this.coords.p_to_real,"from"),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real);break;case"to":if(this.options.to_fixed)break;this.coords.p_to_real=this.convertToRealPercent(t),this.coords.p_to_real=this.calcWithStep(this.coords.p_to_real),this.coords.p_to_real<this.coords.p_from_real&&(this.coords.p_to_real=this.coords.p_from_real),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_to_real=this.checkMinInterval(this.coords.p_to_real,this.coords.p_from_real,"to"),this.coords.p_to_real=this.checkMaxInterval(this.coords.p_to_real,this.coords.p_from_real,"to"),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;case"both":if(this.options.from_fixed||this.options.to_fixed)break;t=this.toFixed(t+this.coords.p_handle*.1),this.coords.p_from_real=this.convertToRealPercent(t)-this.coords.p_gap_left,this.coords.p_from_real=this.calcWithStep(this.coords.p_from_real),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_from_real=this.checkMinInterval(this.coords.p_from_real,this.coords.p_to_real,"from"),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real),this.coords.p_to_real=this.convertToRealPercent(t)+this.coords.p_gap_right,this.coords.p_to_real=this.calcWithStep(this.coords.p_to_real),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_to_real=this.checkMinInterval(this.coords.p_to_real,this.coords.p_from_real,"to"),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real);break;case"both_one":if(this.options.from_fixed||this.options.to_fixed)break;var s=this.convertToRealPercent(t),o=this.result.from_percent,u=this.result.to_percent,a=u-o,f=a/2,l=s-f,c=s+f;l<0&&(l=0,c=l+a),c>100&&(c=100,l=c-a),this.coords.p_from_real=this.calcWithStep(l),this.coords.p_from_real=this.checkDiapason(this.coords.p_from_real,this.options.from_min,this.options.from_max),this.coords.p_from_fake=this.convertToFakePercent(this.coords.p_from_real),this.coords.p_to_real=this.calcWithStep(c),this.coords.p_to_real=this.checkDiapason(this.coords.p_to_real,this.options.to_min,this.options.to_max),this.coords.p_to_fake=this.convertToFakePercent(this.coords.p_to_real)}this.options.type==="single"?(this.coords.p_bar_x=this.coords.p_handle/2,this.coords.p_bar_w=this.coords.p_single_fake,this.result.from_percent=this.coords.p_single_real,this.result.from=this.convertToValue(this.coords.p_single_real),this.options.values.length&&(this.result.from_value=this.options.values[this.result.from])):(this.coords.p_bar_x=this.toFixed(this.coords.p_from_fake+this.coords.p_handle/2),this.coords.p_bar_w=this.toFixed(this.coords.p_to_fake-this.coords.p_from_fake),this.result.from_percent=this.coords.p_from_real,this.result.from=this.convertToValue(this.coords.p_from_real),this.result.to_percent=this.coords.p_to_real,this.result.to=this.convertToValue(this.coords.p_to_real),this.options.values.length&&(this.result.from_value=this.options.values[this.result.from],this.result.to_value=this.options.values[this.result.to])),this.calcMinMax(),this.calcLabels()},calcPointerPercent:function(){if(!this.coords.w_rs){this.coords.p_pointer=0;return}this.coords.x_pointer<0||isNaN(this.coords.x_pointer)?this.coords.x_pointer=0:this.coords.x_pointer>this.coords.w_rs&&(this.coords.x_pointer=this.coords.w_rs),this.coords.p_pointer=this.toFixed(this.coords.x_pointer/this.coords.w_rs*100)},convertToRealPercent:function(e){var t=100-this.coords.p_handle;return e/t*100},convertToFakePercent:function(e){var t=100-this.coords.p_handle;return e/100*t},getHandleX:function(){var e=100-this.coords.p_handle,t=this.toFixed(this.coords.p_pointer-this.coords.p_gap);return t<0?t=0:t>e&&(t=e),t},calcHandlePercent:function(){this.options.type==="single"?this.coords.w_handle=this.$cache.s_single.outerWidth(!1):this.coords.w_handle=this.$cache.s_from.outerWidth(!1),this.coords.p_handle=this.toFixed(this.coords.w_handle/this.coords.w_rs*100)},chooseHandle:function(e){if(this.options.type==="single")return"single";var t=this.coords.p_from_real+(this.coords.p_to_real-this.coords.p_from_real)/2;return e>=t?this.options.to_fixed?"from":"to":this.options.from_fixed?"to":"from"},calcMinMax:function(){if(!this.coords.w_rs)return;this.labels.p_min=this.labels.w_min/this.coords.w_rs*100,this.labels.p_max=this.labels.w_max/this.coords.w_rs*100},calcLabels:function(){if(!this.coords.w_rs||this.options.hide_from_to)return;this.options.type==="single"?(this.labels.w_single=this.$cache.single.outerWidth(!1),this.labels.p_single_fake=this.labels.w_single/this.coords.w_rs*100,this.labels.p_single_left=this.coords.p_single_fake+this.coords.p_handle/2-this.labels.p_single_fake/2,this.labels.p_single_left=this.checkEdges(this.labels.p_single_left,this.labels.p_single_fake)):(this.labels.w_from=this.$cache.from.outerWidth(!1),this.labels.p_from_fake=this.labels.w_from/this.coords.w_rs*100,this.labels.p_from_left=this.coords.p_from_fake+this.coords.p_handle/2-this.labels.p_from_fake/2,this.labels.p_from_left=this.toFixed(this.labels.p_from_left),this.labels.p_from_left=this.checkEdges(this.labels.p_from_left,this.labels.p_from_fake),this.labels.w_to=this.$cache.to.outerWidth(!1),this.labels.p_to_fake=this.labels.w_to/this.coords.w_rs*100,this.labels.p_to_left=this.coords.p_to_fake+this.coords.p_handle/2-this.labels.p_to_fake/2,this.labels.p_to_left=this.toFixed(this.labels.p_to_left),this.labels.p_to_left=this.checkEdges(this.labels.p_to_left,this.labels.p_to_fake),this.labels.w_single=this.$cache.single.outerWidth(!1),this.labels.p_single_fake=this.labels.w_single/this.coords.w_rs*100,this.labels.p_single_left=(this.labels.p_from_left+this.labels.p_to_left+this.labels.p_to_fake)/2-this.labels.p_single_fake/2,this.labels.p_single_left=this.toFixed(this.labels.p_single_left),this.labels.p_single_left=this.checkEdges(this.labels.p_single_left,this.labels.p_single_fake))},updateScene:function(){this.raf_id&&(cancelAnimationFrame(this.raf_id),this.raf_id=null),clearTimeout(this.update_tm),this.update_tm=null;if(!this.options)return;this.drawHandles(),this.is_active?this.raf_id=requestAnimationFrame(this.updateScene.bind(this)):this.update_tm=setTimeout(this.updateScene.bind(this),300)},drawHandles:function(){this.coords.w_rs=this.$cache.rs.outerWidth(!1);if(!this.coords.w_rs)return;this.coords.w_rs!==this.coords.w_rs_old&&(this.target="base",this.is_resize=!0);if(this.coords.w_rs!==this.coords.w_rs_old||this.force_redraw)this.setMinMax(),this.calc(!0),this.drawLabels(),this.options.grid&&(this.calcGridMargin(),this.calcGridLabels()),this.force_redraw=!0,this.coords.w_rs_old=this.coords.w_rs,this.drawShadow();if(!this.coords.w_rs)return;if(!this.dragging&&!this.force_redraw&&!this.is_key)return;if(this.old_from!==this.result.from||this.old_to!==this.result.to||this.force_redraw||this.is_key){this.drawLabels(),this.$cache.bar[0].style.left=this.coords.p_bar_x+"%",this.$cache.bar[0].style.width=this.coords.p_bar_w+"%";if(this.options.type==="single")this.$cache.s_single[0].style.left=this.coords.p_single_fake+"%",this.$cache.single[0].style.left=this.labels.p_single_left+"%",this.options.values.length?this.$cache.input.prop("value",this.result.from_value):this.$cache.input.prop("value",this.result.from),this.$cache.input.data("from",this.result.from);else{this.$cache.s_from[0].style.left=this.coords.p_from_fake+"%",this.$cache.s_to[0].style.left=this.coords.p_to_fake+"%";if(this.old_from!==this.result.from||this.force_redraw)this.$cache.from[0].style.left=this.labels.p_from_left+"%";if(this.old_to!==this.result.to||this.force_redraw)this.$cache.to[0].style.left=this.labels.p_to_left+"%";this.$cache.single[0].style.left=this.labels.p_single_left+"%",this.options.values.length?this.$cache.input.prop("value",this.result.from_value+this.options.input_values_separator+this.result.to_value):this.$cache.input.prop("value",this.result.from+this.options.input_values_separator+this.result.to),this.$cache.input.data("from",this.result.from),this.$cache.input.data("to",this.result.to)}(this.old_from!==this.result.from||this.old_to!==this.result.to)&&!this.is_start&&this.$cache.input.trigger("change"),this.old_from=this.result.from,this.old_to=this.result.to,!this.is_resize&&!this.is_update&&!this.is_start&&!this.is_finish&&this.callOnChange();if(this.is_key||this.is_click)this.is_key=!1,this.is_click=!1,this.callOnFinish();this.is_update=!1,this.is_resize=!1,this.is_finish=!1}this.is_start=!1,this.is_key=!1,this.is_click=!1,this.force_redraw=!1},drawLabels:function(){if(!this.options)return;var e=this.options.values.length,t=this.options.p_values,n,r,i;if(this.options.hide_from_to)return;if(this.options.type==="single")e?(n=this.decorate(t[this.result.from]),this.$cache.single.html(n)):(n=this.decorate(this._prettify(this.result.from),this.result.from),this.$cache.single.html(n)),this.calcLabels(),this.labels.p_single_left<this.labels.p_min+1?this.$cache.min[0].style.visibility="hidden":this.$cache.min[0].style.visibility="visible",this.labels.p_single_left+this.labels.p_single_fake>100-this.labels.p_max-1?this.$cache.max[0].style.visibility="hidden":this.$cache.max[0].style.visibility="visible";else{e?(this.options.decorate_both?(n=this.decorate(t[this.result.from]),n+=this.options.values_separator,n+=this.decorate(t[this.result.to])):n=this.decorate(t[this.result.from]+this.options.values_separator+t[this.result.to]),r=this.decorate(t[this.result.from]),i=this.decorate(t[this.result.to]),this.$cache.single.html(n),this.$cache.from.html(r),this.$cache.to.html(i)):(this.options.decorate_both?(n=this.decorate(this._prettify(this.result.from),this.result.from),n+=this.options.values_separator,n+=this.decorate(this._prettify(this.result.to),this.result.to)):n=this.decorate(this._prettify(this.result.from)+this.options.values_separator+this._prettify(this.result.to),this.result.to),r=this.decorate(this._prettify(this.result.from),this.result.from),i=this.decorate(this._prettify(this.result.to),this.result.to),this.$cache.single.html(n),this.$cache.from.html(r),this.$cache.to.html(i)),this.calcLabels();var s=Math.min(this.labels.p_single_left,this.labels.p_from_left),o=this.labels.p_single_left+this.labels.p_single_fake,u=this.labels.p_to_left+this.labels.p_to_fake,a=Math.max(o,u);this.labels.p_from_left+this.labels.p_from_fake>=this.labels.p_to_left?(this.$cache.from[0].style.visibility="hidden",this.$cache.to[0].style.visibility="hidden",this.$cache.single[0].style.visibility="visible",this.result.from===this.result.to?(this.target==="from"?this.$cache.from[0].style.visibility="visible":this.target==="to"?this.$cache.to[0].style.visibility="visible":this.target||(this.$cache.from[0].style.visibility="visible"),this.$cache.single[0].style.visibility="hidden",a=u):(this.$cache.from[0].style.visibility="hidden",this.$cache.to[0].style.visibility="hidden",this.$cache.single[0].style.visibility="visible",a=Math.max(o,u))):(this.$cache.from[0].style.visibility="visible",this.$cache.to[0].style.visibility="visible",this.$cache.single[0].style.visibility="hidden"),s<this.labels.p_min+1?this.$cache.min[0].style.visibility="hidden":this.$cache.min[0].style.visibility="visible",a>100-this.labels.p_max-1?this.$cache.max[0].style.visibility="hidden":this.$cache.max[0].style.visibility="visible"}},drawShadow:function(){var e=this.options,t=this.$cache,n=typeof e.from_min=="number"&&!isNaN(e.from_min),r=typeof e.from_max=="number"&&!isNaN(e.from_max),i=typeof e.to_min=="number"&&!isNaN(e.to_min),s=typeof e.to_max=="number"&&!isNaN(e.to_max),o,u,a,f;e.type==="single"?e.from_shadow&&(n||r)?(o=this.convertToPercent(n?e.from_min:e.min),u=this.convertToPercent(r?e.from_max:e.max)-o,o=this.toFixed(o-this.coords.p_handle/100*o),u=this.toFixed(u-this.coords.p_handle/100*u),o+=this.coords.p_handle/2,t.shad_single[0].style.display="block",t.shad_single[0].style.left=o+"%",t.shad_single[0].style.width=u+"%"):t.shad_single[0].style.display="none":(e.from_shadow&&(n||r)?(o=this.convertToPercent(n?e.from_min:e.min),u=this.convertToPercent(r?e.from_max:e.max)-o,o=this.toFixed(o-this.coords.p_handle/100*o),u=this.toFixed(u-this.coords.p_handle/100*u),o+=this.coords.p_handle/2,t.shad_from[0].style.display="block",t.shad_from[0].style.left=o+"%",t.shad_from[0].style.width=u+"%"):t.shad_from[0].style.display="none",e.to_shadow&&(i||s)?(a=this.convertToPercent(i?e.to_min:e.min),f=this.convertToPercent(s?e.to_max:e.max)-a,a=this.toFixed(a-this.coords.p_handle/100*a),f=this.toFixed(f-this.coords.p_handle/100*f),a+=this.coords.p_handle/2,t.shad_to[0].style.display="block",t.shad_to[0].style.left=a+"%",t.shad_to[0].style.width=f+"%"):t.shad_to[0].style.display="none")},callOnStart:function(){this.options.onStart&&typeof this.options.onStart=="function"&&this.options.onStart(this.result)},callOnChange:function(){this.options.onChange&&typeof this.options.onChange=="function"&&this.options.onChange(this.result)},callOnFinish:function(){this.options.onFinish&&typeof this.options.onFinish=="function"&&this.options.onFinish(this.result)},callOnUpdate:function(){this.options.onUpdate&&typeof this.options.onUpdate=="function"&&this.options.onUpdate(this.result)},toggleInput:function(){this.$cache.input.toggleClass("irs-hidden-input")},convertToPercent:function(e,t){var n=this.options.max-this.options.min,r=n/100,i,s;return n?(t?i=e:i=e-this.options.min,s=i/r,this.toFixed(s)):(this.no_diapason=!0,0)},convertToValue:function(e){var t=this.options.min,n=this.options.max,r=t.toString().split(".")[1],i=n.toString().split(".")[1],s,o,u=0,a=0;if(e===0)return this.options.min;if(e===100)return this.options.max;r&&(s=r.length,u=s),i&&(o=i.length,u=o),s&&o&&(u=s>=o?s:o),t<0&&(a=Math.abs(t),t=+(t+a).toFixed(u),n=+(n+a).toFixed(u));var f=(n-t)/100*e+t,l=this.options.step.toString().split(".")[1],c;return l?f=+f.toFixed(l.length):(f/=this.options.step,f*=this.options.step,f=+f.toFixed(0)),a&&(f-=a),l?c=+f.toFixed(l.length):c=this.toFixed(f),c<this.options.min?c=this.options.min:c>this.options.max&&(c=this.options.max),c},calcWithStep:function(e){var t=Math.round(e/this.coords.p_step)*this.coords.p_step;return t>100&&(t=100),e===100&&(t=100),this.toFixed(t)},checkMinInterval:function(e,t,n){var r=this.options,i,s;return r.min_interval?(i=this.convertToValue(e),s=this.convertToValue(t),n==="from"?s-i<r.min_interval&&(i=s-r.min_interval):i-s<r.min_interval&&(i=s+r.min_interval),this.convertToPercent(i)):e},checkMaxInterval:function(e,t,n){var r=this.options,i,s;return r.max_interval?(i=this.convertToValue(e),s=this.convertToValue(t),n==="from"?s-i>r.max_interval&&(i=s-r.max_interval):i-s>r.max_interval&&(i=s+r.max_interval),this.convertToPercent(i)):e},checkDiapason:function(e,t,n){var r=this.convertToValue(e),i=this.options;return typeof t!="number"&&(t=i.min),typeof n!="number"&&(n=i.max),r<t&&(r=t),r>n&&(r=n),this.convertToPercent(r)},toFixed:function(e){return e=e.toFixed(9),+e},_prettify:function(e){return this.options.prettify_enabled?this.options.prettify&&typeof this.options.prettify=="function"?this.options.prettify(e):this.prettify(e):e},prettify:function(e){var t=e.toString();return t.replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g,"$1"+this.options.prettify_separator)},checkEdges:function(e,t){return this.options.force_edges?(e<0?e=0:e>100-t&&(e=100-t),this.toFixed(e)):this.toFixed(e)},validate:function(){var e=this.options,t=this.result,n=e.values,r=n.length,i,s;typeof e.min=="string"&&(e.min=+e.min),typeof e.max=="string"&&(e.max=+e.max),typeof e.from=="string"&&(e.from=+e.from),typeof e.to=="string"&&(e.to=+e.to),typeof e.step=="string"&&(e.step=+e.step),typeof e.from_min=="string"&&(e.from_min=+e.from_min),typeof e.from_max=="string"&&(e.from_max=+e.from_max),typeof e.to_min=="string"&&(e.to_min=+e.to_min),typeof e.to_max=="string"&&(e.to_max=+e.to_max),typeof e.keyboard_step=="string"&&(e.keyboard_step=+e.keyboard_step),typeof e.grid_num=="string"&&(e.grid_num=+e.grid_num),e.max<e.min&&(e.max=e.min);if(r){e.p_values=[],e.min=0,e.max=r-1,e.step=1,e.grid_num=e.max,e.grid_snap=!0;for(s=0;s<r;s++)i=+n[s],isNaN(i)?i=n[s]:(n[s]=i,i=this._prettify(i)),e.p_values.push(i)}if(typeof e.from!="number"||isNaN(e.from))e.from=e.min;if(typeof e.to!="number"||isNaN(e.from))e.to=e.max;if(e.type==="single")e.from<e.min&&(e.from=e.min),e.from>e.max&&(e.from=e.max);else{if(e.from<e.min||e.from>e.max)e.from=e.min;if(e.to>e.max||e.to<e.min)e.to=e.max;e.from>e.to&&(e.from=e.to)}if(typeof e.step!="number"||isNaN(e.step)||!e.step||e.step<0)e.step=1;if(typeof e.keyboard_step!="number"||isNaN(e.keyboard_step)||!e.keyboard_step||e.keyboard_step<0)e.keyboard_step=5;typeof e.from_min=="number"&&e.from<e.from_min&&(e.from=e.from_min),typeof e.from_max=="number"&&e.from>e.from_max&&(e.from=e.from_max),typeof e.to_min=="number"&&e.to<e.to_min&&(e.to=e.to_min),typeof e.to_max=="number"&&e.from>e.to_max&&(e.to=e.to_max);if(t){t.min!==e.min&&(t.min=e.min),t.max!==e.max&&(t.max=e.max);if(t.from<t.min||t.from>t.max)t.from=e.from;if(t.to<t.min||t.to>t.max)t.to=e.to}if(typeof e.min_interval!="number"||isNaN(e.min_interval)||!e.min_interval||e.min_interval<0)e.min_interval=0;if(typeof e.max_interval!="number"||isNaN(e.max_interval)||!e.max_interval||e.max_interval<0)e.max_interval=0;e.min_interval&&e.min_interval>e.max-e.min&&(e.min_interval=e.max-e.min),e.max_interval&&e.max_interval>e.max-e.min&&(e.max_interval=e.max-e.min)},decorate:function(e,t){var n="",r=this.options;return r.prefix&&(n+=r.prefix),n+=e,r.max_postfix&&(r.values.length&&e===r.p_values[r.max]?(n+=r.max_postfix,r.postfix&&(n+=" ")):t===r.max&&(n+=r.max_postfix,r.postfix&&(n+=" "))),r.postfix&&(n+=r.postfix),n},updateFrom:function(){this.result.from=this.options.from,this.result.from_percent=this.convertToPercent(this.result.from),this.options.values&&(this.result.from_value=this.options.values[this.result.from])},updateTo:function(){this.result.to=this.options.to,this.result.to_percent=this.convertToPercent(this.result.to),this.options.values&&(this.result.to_value=this.options.values[this.result.to])},updateResult:function(){this.result.min=this.options.min,this.result.max=this.options.max,this.updateFrom(),this.updateTo()},appendGrid:function(){if(!this.options.grid)return;var e=this.options,t,n,r=e.max-e.min,i=e.grid_num,s=0,o=0,u=4,a,f,l=0,c,h="";this.calcGridMargin(),e.grid_snap?(i=r/e.step,s=this.toFixed(e.step/(r/100))):s=this.toFixed(100/i),i>4&&(u=3),i>7&&(u=2),i>14&&(u=1),i>28&&(u=0);for(t=0;t<i+1;t++){a=u,o=this.toFixed(s*t),o>100&&(o=100,a-=2,a<0&&(a=0)),this.coords.big[t]=o,f=(o-s*(t-1))/(a+1);for(n=1;n<=a;n++){if(o===0)break;l=this.toFixed(o-f*n),h+='<span class="irs-grid-pol small" style="left: '+l+'%"></span>'}h+='<span class="irs-grid-pol" style="left: '+o+'%"></span>',c=this.convertToValue(o),e.values.length?c=e.p_values[c]:c=this._prettify(c),h+='<span class="irs-grid-text js-grid-text-'+t+'" style="left: '+o+'%">'+c+"</span>"}this.coords.big_num=Math.ceil(i+1),this.$cache.cont.addClass("irs-with-grid"),this.$cache.grid.html(h),this.cacheGridLabels()},cacheGridLabels:function(){var e,t,n=this.coords.big_num;for(t=0;t<n;t++)e=this.$cache.grid.find(".js-grid-text-"+t),this.$cache.grid_labels.push(e);this.calcGridLabels()},calcGridLabels:function(){var e,t,n=[],r=[],i=this.coords.big_num;for(e=0;e<i;e++)this.coords.big_w[e]=this.$cache.grid_labels[e].outerWidth(!1),this.coords.big_p[e]=this.toFixed(this.coords.big_w[e]/this.coords.w_rs*100),this.coords.big_x[e]=this.toFixed(this.coords.big_p[e]/2),n[e]=this.toFixed(this.coords.big[e]-this.coords.big_x[e]),r[e]=this.toFixed(n[e]+this.coords.big_p[e]);this.options.force_edges&&(n[0]<-this.coords.grid_gap&&(n[0]=-this.coords.grid_gap,r[0]=this.toFixed(n[0]+this.coords.big_p[0]),this.coords.big_x[0]=this.coords.grid_gap),r[i-1]>100+this.coords.grid_gap&&(r[i-1]=100+this.coords.grid_gap,n[i-1]=this.toFixed(r[i-1]-this.coords.big_p[i-1]),this.coords.big_x[i-1]=this.toFixed(this.coords.big_p[i-1]-this.coords.grid_gap))),this.calcGridCollision(2,n,r),this.calcGridCollision(4,n,r);for(e=0;e<i;e++)t=this.$cache.grid_labels[e][0],t.style.marginLeft=-this.coords.big_x[e]+"%"},calcGridCollision:function(e,t,n){var r,i,s,o=this.coords.big_num;for(r=0;r<o;r+=e){i=r+e/2;if(i>=o)break;s=this.$cache.grid_labels[i][0],n[r]<=t[i]?s.style.visibility="visible":s.style.visibility="hidden"}},calcGridMargin:function(){if(!this.options.grid_margin)return;this.coords.w_rs=this.$cache.rs.outerWidth(!1);if(!this.coords.w_rs)return;this.options.type==="single"?this.coords.w_handle=this.$cache.s_single.outerWidth(!1):this.coords.w_handle=this.$cache.s_from.outerWidth(!1),this.coords.p_handle=this.toFixed(this.coords.w_handle/this.coords.w_rs*100),this.coords.grid_gap=this.toFixed(this.coords.p_handle/2-.1),this.$cache.grid[0].style.width=this.toFixed(100-this.coords.p_handle)+"%",this.$cache.grid[0].style.left=this.coords.grid_gap+"%"},update:function(e){if(!this.input)return;this.is_update=!0,this.options.from=this.result.from,this.options.to=this.result.to,this.options=$.extend(this.options,e),this.validate(),this.updateResult(e),this.toggleInput(),this.remove(),this.init(!0)},reset:function(){if(!this.input)return;this.updateResult(),this.update()},destroy:function(){if(!this.input)return;this.toggleInput(),this.$cache.input.prop("readonly",!1),$.data(this.input,"ionRangeSlider",null),this.remove(),this.input=null,this.options=null}},$.fn.ionRangeSlider=function(t){return this.each(function(){$.data(this,"ionRangeSlider")||$.data(this,"ionRangeSlider",new o(this,t,e++))})},function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}),define("recommend/grade",["text!root-tpl/recommend/main.tpl","text!root-tpl/recommend/grade-list.tpl","root-common/util","../model","root-common/module/cookie","root-common/module/dragval"],function(e,t,n,r,i){var s=Backbone.View.extend({initialize:function(){var n=this;n._tpl=doT.template(e),n._gradeListTpl=doT.template(t),n._model=new r,n._model.bind({setGrade:$.proxy(n.setGrade,n),queryAllGrade:$.proxy(n.queryAllGrade,n)}),n._gradeId=null},events:{"click .btn-confirm":"submitGrade"},reset:function(){this.$el.html(""),this._gradeId=null},init:function(e){var t=this;t.render()},render:function(){var e=this;e.$el.html(e._tpl({})),e._model.queryAllGrade()},submitGrade:function(){var e=this,t=e._gradeId;t&&e._model.setGrade({data:{grade_id:t}})},setGrade:function(e,t,r,s){var o=this;n.dealAjax(function(t){var n=e.data;t||(i("grade_choice","1"),window.location.href="#booklist")},e,t)},queryAllGrade:function(e,t,r,i){var s=this;n.dealAjax(function(t){var n=e.data;t||(s._gradeId=n[0].grade_id,$(".grade-list ul",s.$el).html(s._gradeListTpl({list:n||[]})),$(".grade-list li",s.$el).eq(0).addClass("active"),$(".input-grade",s.$el).ionRangeSlider({hide_min_max:!0,keyboard:!0,min:0,max:11,type:"single",step:1,onChange:function(e){var t=e.from;$(".grade-list li.active",s.$el).removeClass("active");var n=$(".grade-list li",s.$el).eq(t).addClass("active");s._gradeId=n.data("id")}}),setTimeout(function(){$(".mask, .selection-area",s.$el).show(),$(".introduction",s.$el).hide()},2500))},e,t)}});return s}),define("auto-domain",[],function(){var e="online",t=location.hostname,n=location.host,r="192.168.12.252",i="192.168.12.240",s="9080",o="http://",u=/192.168|localhost|debug.|127.0/;u.test(t)&&(e="test");try{e=="test"?(window.serviceBase=o+r+":"+s+"/haozuowenapi",window.imgPath=o+i+":9999",window.writeBase=o+i+":8081"):(window.serviceBase=o+t+"/haozuowenapi",window.imgPath=o+t+":9999",window.writeBase=o+t),/localhost/.test(t)?window.staticsBase=o+n:window.staticsBase=o+n+"/ui"}catch(a){alert("自适应域名脚本执行错误!\n")}}),require(["./router","./module-manager","./sign","./signup","./phonefind","./phone","./product","./header","./reading","./booklist","./readover","./userNew","./bookNav","./testResult","./find-pw","./privacy","./term","./exercise/main","./exercise/header","./recommend/grade","./auto-domain"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){function B(){t.clear()}$.extend($.ajaxSettings,{timeout:3e4}),$.support.cors=!0,window.audioPlay={click:function(){$(".audio-click")[0].play&&$(".audio-click")[0].play()},error:function(){$(".audio-error")[0].play&&$(".audio-error")[0].play()},right:function(){$(".audio-right")[0].play&&$(".audio-right")[0].play()},completeReading:function(){$(".audio-complete-reading")[0].play&&$(".audio-complete-reading")[0].play()}},window.resetPage=B,window.gradeMap={P1:"G1",P2:"G2",P3:"G3",P4:"G4",P5:"G5",P6:"G6",PS:"G6",M1:"G7",M2:"G8",M3:"G9",H1:"G10",H2:"G11",H3:"G12"},$.validator.addMethod("isTelephone",function(e,t,n){var r=/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,i=$(t).val();return r.test(i)}),$.validator.addMethod("isCode",function(e,t,n){var r=/^\d{6}$/;return r.test($(t).val())}),$.validator.addMethod("isUsername",function(e,t,n){var r=/^[a-z0-9_]{6,30}$/g;return r.test($(t).val())}),$.validator.addMethod("isCpw",function(e,t,n){var r=$(t).closest("form"),i=$(t).val(),s=$('input[name="pw"]',r).val();return i===s}),$.validator.addMethod("ispw",function(e,t,n){var r=/^[a-z0-9_]{6,30}$/g;return r.test($(t).val())}),$.validator.addMethod("isEmail",function(e,t,n){var r=/^([\w-]+)@([\w-]+)\.([\w-]+)$/,i=$(t).val();return r.test(i)});var w=new e,E=t.add(new u({el:"#Header"})),S=t.add(new n({el:"#SignPage"})),x=t.add(new r({el:"#SignUpPage"})),i=t.add(new i({el:"#PhoneFindPage"})),T=t.add(new s({el:"#PhonePage"})),N=t.add(new o({el:"#ProductPage"})),C=t.add(new a({el:"#ReadingPage"})),k=t.add(new f({el:"#BookListPage"})),L=t.add(new l({el:"#ReadOverPage"})),A=t.add(new d({el:"#FindpwPage"})),O=t.add(new v({el:"#PrivacyPage"})),M=t.add(new m({el:"#TermPage"})),c=t.add(new c({el:"#UserPage"})),_=t.add(new h({el:"#BookNavPage"})),p=t.add(new p({el:"#TestResultPage"})),D=t.add(new g({el:"#ExercisePage"})),P=t.add(new y({el:"#ExerciseHeader"})),H=t.add(new b({el:"#GradePage"}));w.bind({gotoSign:function(){B(),S.init()},gotoPhone:function(){B(),E.init(),T.listenTo(E,"getUserInfo",$.proxy(T.getUserInfo,T))},gotoProduct:function(){B(),N.init(),E.init(),N.listenTo(E,"getUserInfo",$.proxy(N.setVideo,N))},gotoReading:function(e){C.init(e),P.stopListening(),_.stopListening(),P.listenTo(C,"rendered",$.proxy(P.animLeft,P)),_.listenTo(C,"rendered",$.proxy(_.animLeft,_))},gotoBookList:function(){B(),k.init(),E.init(),k.listenTo(E,"getUserInfo",$.proxy(k.setUser,k))},gotoReadOver:function(e){B(),L.init(e)},gotoInformation:function(){B(),N.init(),E.init(),c.init()},gotoFindpw:function(){B(),A.init()},gotoPrivacy:function(){B(),O.init()},gotoTerm:function(){B(),M.init()},gotoSignUp:function(){B(),x.init()},gotoPhoneFind:function(){B(),i.init()},gotoExercise:function(e,t){B(),D.init(e,t),P.init(e,1)},gotoBookNav:function(e){B(),_.init(e),P.init(e)},gotoTestResult:function(e,t){B(),p.init(e,t),P.init(e)},gotoGrade:function(){B(),E.init(),H.init()}}),$("body").on({mousedown:function(){$(".icon-audio").hide()}}),Backbone.history.start()}),define("main",function(){});