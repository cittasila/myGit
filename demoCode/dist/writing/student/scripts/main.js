define("root-base/router",[],function(){var e="gotoHome",t="gotoHistory",n="gotoTopicHistory",r="gotoArticleDetail",i=Backbone.Router.extend({routes:{"":"gotoHome",history:"gotoHistory","history/:id":"gotoTopicHistory","history/:id/:id":"gotoArticleDetail"},initialize:function(){},gotoHome:function(){this.trigger(e)},gotoHistory:function(){this.trigger(t)},gotoTopicHistory:function(e){this.trigger(n,e)},gotoArticleDetail:function(e,t){this.trigger(r,e,t)}});return i}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!root-common/module/popup.tpl",[],function(){return'<div class="ui-pop\r\n{{ if(it.className){ }} {{=it.className}}{{ } }}\r\n{{ if(it.tip){ }} ui-pop-tip{{ } }}\r\n" id="ui-pop-{{=it.id}}" name="{{=it.name}}" style="z-index:{{=it.zIndex}}">\r\n    <div class="ui-popbox">\r\n        <div class="ui-popwrap">\r\n            {{ if(it.tip){ }}\r\n            <a class="ui-popclose ui-popaction" href="javascript:;"></a>\r\n            {{ }else{ }}\r\n                {{ if(it.hasHd){ }}\r\n                <div class="ui-pophd\r\n                {{ if(!it.isMove){ }}\r\n                nomove\r\n                {{ } }}\r\n                ">\r\n                    <span class="ui-poptitle"></span>\r\n                    <a class="ui-popclose ui-popaction" href="javascript:;"></a>\r\n                    {{ if(it.isMax){ }}\r\n                    <a class="ui-popmax ui-popaction" href="javascript:;"></a>\r\n                    <a class="ui-popdefault ui-popaction" href="javascript:;"></a>\r\n                    {{ } }}\r\n                </div>\r\n                {{ } }}\r\n            {{ } }}\r\n            \r\n            <div class="ui-popmain"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("root-common/module/popup",["text!./popup.tpl"],function(e,t,n){var r="close",i=/msie 6/i.test(window.navigator.userAgent),s={data:[],zIndex:100,number:0,config:{title:"",custom:null,fade:!1,delay:3e3,ajax:!1,url:"",iframe:null,name:"",isMax:!1,mask:!1,tip:!1,className:"",isMove:!0,hasHd:!0,containerBoderWidth:1},close:function(e){var t;if(this.data.length>0){$.each(this.data,function(n,r){r.id===e&&(t=n)});var n=this.data[t];n.container.remove(),n.opts.mask&&n.mask.remove(),this.data.splice(t,1)}return e}},o=Backbone.View.extend({initialize:function(t,n){var r=this;r._tpl=doT.template(e),r.build(t,n)},events:{"click .ui-popclose":"close","click .ui-popmax":"maximize","click .ui-popdefault":"defaultsize","mousedown .ui-pophd":"move"},build:function(e,t){var n=this;this.opts=$.extend({},s.config,e),this.id=t,this.name=this.opts.name,this.container=$(this._tpl({id:this.id,zIndex:++s.zIndex,name:this.name,isMax:this.opts.isMax,tip:this.opts.tip,className:this.opts.className,isMove:this.opts.isMove,hasHd:this.opts.hasHd})).appendTo("body"),this.opts.mask&&(this.mask=$('<div class="ui-mask" id="ui-mask-'+this.id+'"></div>').appendTo("body").css({height:$(document).height()})),this.setElement(this.container),this.iframe=null,this.wrap=$(".ui-popmain",this.container),this.closeBtn=$(".ui-popclose",this.container),this.maxBtn=$(".ui-popmax",this.container),this.defaultBtn=$(".ui-popdefault",this.container),this.iframeMask=$('<div class="ui-iframe-mask" />'),this.wrapMargin=0,this.containerBoderWidth=this.opts.containerBoderWidth,this.opts.hasHd?this.titleHeight=$(".ui-pophd",n.$el).outerHeight():this.titleHeight=0,this.show()},show:function(){var e=this;i&&this.container.css({position:"absolute"}),this.container.find(".ui-poptitle").html(this.opts.title),this._show()},_show:function(){this.opts.fade&&setTimeout($.proxy(this,"close"),this.opts.delay),this.opts.custom&&this.getCustom(),this.opts.ajax&&this.ajax(),this.opts.iframe&&this.getIframe(),this.setDefaultSize(),this.reposition(),this.container.bind("mousedown",$.proxy(this,"addZIndex"))},ajax:function(){var e=this;$.ajax({url:this.opts.url,cache:!1}).done(function(t){e.wrap.html(t),e.setDefaultSize(),e.reposition()}).error(function(){alert("error")})},setDefaultSize:function(){this.defaultWidth=this.wrap.outerWidth()+this.wrapMargin*2,this.defaultHeight=this.wrap.outerHeight()+this.wrapMargin*2},resize:function(){this.wrap.css({width:this.wrap.find(">*").outerWidth()}),this.setDefaultSize(),this.reposition()},getIframe:function(){var e=this;$(".iframe").clone().appendTo(this.wrap),this.iframe=this.wrap.find("iframe"),this.iframe.show().removeClass("iframe").attr("src",this.opts.iframe.url),this.iframe.load($.proxy(this,"iframeOnload"))},getCustom:function(){this.wrap.html(this.opts.custom)},close:function(e){e&&e.preventDefault(),s.close(this.id),this.trigger(r)},reposition:function(){var e=this.defaultHeight+this.containerBoderWidth*2;this.opts.tip||(e+=this.titleHeight),this.container.css({width:this.defaultWidth+this.containerBoderWidth*2,height:e,top:Math.max(($(window).height()-this.defaultHeight-this.titleHeight-this.containerBoderWidth*2)/2,0),left:($(window).width()-this.defaultWidth-this.containerBoderWidth*2)/2})},maximize:function(){this.container.css({top:0,left:0,width:$(window).width(),height:$(window).height()}),this.wrap.css({width:$(window).width()-this.containerBoderWidth*2-this.wrapMargin*2,height:$(window).height()-this.titleHeight-this.containerBoderWidth*2-this.wrapMargin*2}),this.opts.iframe||this.wrap.find(">*").css({width:$(window).width()-this.containerBoderWidth*2-this.wrapMargin*2,height:$(window).height()-this.titleHeight-this.containerBoderWidth*2-this.wrapMargin*2}),this.maxBtn.addClass("ui-popmax-hide"),this.defaultBtn.show()},defaultsize:function(){this.container.css({width:this.defaultWidth+this.containerBoderWidth*2,height:this.defaultHeight+this.titleHeight+this.containerBoderWidth*2}),this.wrap.css({width:this.defaultWidth-this.wrapMargin*2,height:this.defaultHeight-this.wrapMargin*2}),this.opts.iframe||this.wrap.find(">*").css({width:this.defaultWidth-this.wrapMargin*2,height:this.defaultHeight-this.wrapMargin*2}),this.reposition(),this.maxBtn.removeClass("ui-popmax-hide"),this.defaultBtn.hide()},addZIndex:function(e){$(this.container).css("z-index",++s.zIndex)},move:function(e){if(!this.opts.isMove)return;var t=this,n=e.clientY-this.container.position().top,r=e.clientX-this.container.position().left,i=$(window).width()-this.container.outerWidth(),s=$(window).height()-this.container.outerHeight(),o,u;$(document).bind("mousemove",function(e){o=e.clientY-n,u=e.clientX-r,t.container.css({left:Math.min(i,Math.max(0,u)),top:Math.min(s,Math.max(0,o))}),t._showIframeMask()}).bind("mouseup",function(){t._hideIframeMask(),$(this).unbind("mousemove")})},iframeOnload:function(){this.wrap.css({width:this.opts.iframe.width,height:this.opts.iframe.height}),this.iframe.show(),this.iframeMask.appendTo(this.wrap),this.setDefaultSize(),this.reposition(),this.iframeMask.bind("mousedown",$.proxy(this,"_hideIframeMask"))},_hideIframeMask:function(e){this.iframeMask.hide()},_showIframeMask:function(e){this.iframeMask.show()}});return{create:function(e){var t=new o(e,++s.number);return s.data.push(t),t}}}),define("root-common/util",["./module/popup","require","exports"],function(e,t,n){function r(e,t){if(!$.browser.msie)t?window.open(e,t):location.href=e;else{var n=$('<a href="'+e+'" target="'+(t||"_self")+'"> </a>')[0];document.body.appendChild(n),n.click()}}function i(e,t){return t===undefined?t=new Date:$.isNumeric(t)&&(t=new Date(parseInt(t,10))),e.replace(/([YMDhsm])\1*/g,function(e){switch(e.charAt()){case"Y":return f(t.getFullYear(),e);case"M":return f(t.getMonth()+1,e);case"D":return f(t.getDate(),e);case"w":return t.getDay()+1;case"h":return f(t.getHours(),e);case"m":return f(t.getMinutes(),e);case"s":return f(t.getSeconds(),e)}})}function s(e,t,n){$.type(t)=="date"?t=t.getTime():t=parseInt(t);var r=new Date(t),i=r.getHours();return r>432e5&&(i+=Math.floor(r/432e5)),n&&(e=e.replace(/(\w)\1+/g,"$1")),e.replace(/([hms])\1*/g,function(t){switch(t.charAt()){case"h":return f(i-8,t);case"m":var n=(/h+/.test(e)?0:i-8)*60+r.getMinutes();return f(n,t);case"s":return f(r.getSeconds(),t)}})}function u(e,t,n){$.isNumeric(e)&&(e=new Date(parseInt(e,10))),$.isNumeric(t)&&(t=new Date(parseInt(t,10))),e===undefined&&(e=new Date),t===undefined&&(t=new Date),n||(n="YYYY年MM月DD日");var r=new Date(t.toDateString()),s=(+t- +e)/1e3,u=(+t- +r)/1e3;return s<=60?"刚刚":s<=3600?Math.floor(s/60)+"分钟前":s<=u?Math.floor(s/3600)+"小时前":s<=u+o?"昨天":s<=u+o*2?"前天":s<=u+o*25?Math.floor(s/o)+"天前":i(n,e)}function a(e,t){return e<36e5?s("mm分ss秒",e,t):s("hh小时mm分ss秒",e,t)}function f(e,t){return t=t.length,e=e||0,t==1?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function l(e){var t=/[\?\&]([^&]+=[^&#]+)/g,n,r=[],i="",s=window.location.href;while(n=t.exec(s))r.push(n[1]);return e?($.each(r,function(t,n){if(n.indexOf(e)!==-1){var r=n.indexOf("=");return i=n.slice(r+1),!1}}),i):r}function c(t,n){return e.create({title:"提示",custom:'<i class="icon icon-error"></i>'+t,tip:!0,fade:n})}function h(t){return e.create({title:"提示",custom:'<i class="icon icon-success"></i>'+t,tip:!0,fade:!0})}function p(t,n){var r={title:"提示",custom:t,tip:!0,fade:n};return e.create(r)}function d(e,t,n){var t=t||{};try{if($.isEmptyObject(t)){if(n){var r=n.responseText,i="状态："+n.status+"， 异常信息："+n.statusText;if(r)try{r=$.parseJSON(r),i="请求地址："+r.path+"， "+i}catch(s){}c(i)}}else t.resCode=="0000"?e&&e():(e&&e(!0),t&&$.type(t)=="object"&&t[1]=="timeout"?c("网络请求慢，连接超时，请重试",!0):c(t.resMsg,!0))}catch(s){throw"ajax data error:"+s}}function v(e,t,n){var t=t||{};try{t.resCode=="0000"?e&&e():e&&e(!0)}catch(r){throw"ajax data error:"+r}}function m(e,t){var n=[],r={};return $.each(e,function(e,i){var s=t?i[t]:i;r[s]||(n.push(i),r[s]=1)}),n}function g(e,t,n){return e.slice(0,n)+t+e.slice(n)}function y(e,t,n){var r=this,i=$.extend({dataType:"json",success:function(i){r.trigger(t,i,null,e.data,n)},error:function(e,n,i){r.trigger(t,null,e)}},e);$.ajax(i)}function b(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=_utf8_encode(e);while(f<e.length)n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=e.charCodeAt(f++),s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+_keyStr.charAt(s)+_keyStr.charAt(o)+_keyStr.charAt(u)+_keyStr.charAt(a);return t},this.decode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)s=_keyStr.indexOf(e.charAt(f++)),o=_keyStr.indexOf(e.charAt(f++)),u=_keyStr.indexOf(e.charAt(f++)),a=_keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i));return t=_utf8_decode(t),t},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode=function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}}var o=86400;n.openURL=r,n.formatDate=i,n.formatTime=s,n.formatNumber=f,n.formatTime=s,n.formatTimeE=a,n.release=u,n.queryString=l,n.errorTip=c,n.successTip=h,n.tip=p,n.dealAjax=d,n.insertStr=g,n.unique=m,n.request=y,n.mDealAjax=v,n.Base64=b}),define("root-common/module/tab",[],function(){var e="switch",t={btns:"",panels:"",type:"click",index:0},n="active",r="select",i=Backbone.View.extend({initialize:function(e){var n=this,e=n.config=$.extend({},t,e);n.index=n.config.index,n.$nav=$(e.btns).bind(e.type,$.proxy(n.change,n)),n.$main=$(e.panels),n.init()},init:function(){var e=this;e.show(e.config.index)},_index:function(e){var t=this,n=$(e.target),r=n.closest("li"),i=t.$nav.index(r);return i},change:function(t){t.preventDefault();var n=this,r=n._index(t);n.show(r),n.trigger(e,r)},show:function(e){var t=this,i=t.$nav.eq(e);t.index=e,setTimeout(function(){t.trigger(r,e)},0),t.$nav.removeClass(n),i.addClass(n),t.$main.hide().eq(e).show()},getIndex:function(){return this.index}});return i}),define("root-common/module/tip",[],function(){function e(e,t){return typeof e=="function"?e.call(t):e}function t(e){while(e=e.parentNode)if(e==document)return!0;return!1}function n(e,t){this.$element=$(e),this.options=t,this.enabled=!0,this.fixTitle()}n.prototype={show:function(){var t=this.getTitle();if(t&&this.enabled){var n=this.tip();n.find(".tipsy-inner")[this.options.html?"html":"text"](t),n[0].className="tipsy",n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(this.options.doc.body);var r=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),i=n[0].offsetWidth,s=n[0].offsetHeight,o=e(this.options.gravity,this.$element[0]),u;switch(o.charAt(0)){case"n":u={top:r.top+r.height+this.options.offset,left:r.left+r.width/2-i/2};break;case"s":u={top:r.top-s-this.options.offset,left:r.left+r.width/2-i/2};break;case"e":u={top:r.top+r.height/2-s/2,left:r.left-i-this.options.offset};break;case"w":u={top:r.top+r.height/2-s/2,left:r.left+r.width+this.options.offset}}o.length==2&&(o.charAt(1)=="w"?u.left=r.left+r.width/2-15:u.left=r.left+r.width/2-i+15),n.css(u).addClass("tipsy-"+o),n.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+o.charAt(0),this.options.className&&n.addClass(e(this.options.className,this.$element[0])),this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):n.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){$(this).remove()}):this.tip().remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("original-title")!="string")&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,n=this.options;this.fixTitle();var e,n=this.options;return typeof n.title=="string"?e=t.attr(n.title=="title"?"original-title":n.title):typeof n.title=="function"&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip||(this.$tip=$('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},$.fn.tipsy=function(e){function r(t){var r=$.data(t,"tipsy");return r||(r=new n(t,$.fn.tipsy.elementOptions(t,e)),$.data(t,"tipsy",r)),r}function i(){var t=r(this);t.hoverState="in",e.delayIn==0?t.show():(t.fixTitle(),setTimeout(function(){t.hoverState=="in"&&t.show()},e.delayIn))}function s(){var t=r(this);t.hoverState="out",e.delayOut==0?t.hide():setTimeout(function(){t.hoverState=="out"&&t.hide()},e.delayOut)}if(e===!0)return this.data("tipsy");if(typeof e=="string"){var t=this.data("tipsy");return t&&t[e](),this}e=$.extend({},$.fn.tipsy.defaults,e),e.live||this.each(function(){r(this)});if(e.trigger!="manual"){var o=e.live?"live":"bind",u=e.trigger=="hover"?"mouseenter":"focus",a=e.trigger=="hover"?"mouseleave":"blur";this[o](u,i)[o](a,s)}return this},$.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover",doc:document},$.fn.tipsy.revalidate=function(){$(".tipsy").each(function(){var e=$.data(this,"tipsy-pointee");(!e||!t(e))&&$(this).remove()})},$.fn.tipsy.elementOptions=function(e,t){return $.metadata?$.extend({},t,$(e).metadata()):t},$.fn.tipsy.autoNS=function(){return $(this).offset().top>$(document).scrollTop()+$(window).height()/2?"s":"n"},$.fn.tipsy.autoWE=function(){return $(this).offset().left>$(document).scrollLeft()+$(window).width()/2?"e":"w"},$.fn.tipsy.autoBounds=function(e,t){return function(){var n={ns:t[0],ew:t.length>1?t[1]:!1},r=$(document).scrollTop()+e,i=$(document).scrollLeft()+e,s=$(this);return s.offset().top<r&&(n.ns="n"),s.offset().left<i&&(n.ew="w"),$(window).width()+$(document).scrollLeft()-s.offset().left<e&&(n.ew="e"),$(window).height()+$(document).scrollTop()-s.offset().top<e&&(n.ns="s"),n.ns+(n.ew?n.ew:"")}}}),define("container",["root-common/module/tab","root-common/util","root-common/module/tip"],function(e,t){var n="show",r="hide",i="select",s=Backbone.View.extend({initialize:function(){var e=this;e._isShow=!1,$(".ui-navs .nav-item, .ui-actions .ui-btn").tipsy()},events:{"click .panel-toggle":"_togglePanel","click .btn-logout, .btn-products-center":"_backProduct"},_togglePanel:function(){this.togglePanel()},togglePanel:function(e){var t=this;e!==undefined?t._isShow=e:t._isShow=!t._isShow,e=t._isShow,$(".panel-toggle")[e?"addClass":"removeClass"]("panel-toggle-show"),$('div[rol="right-panel"]')[e?"removeClass":"addClass"]("right-panel-whole"),$('div[rol="left-panel"]')[e?"removeClass":"addClass"]("left-panel-hide"),t.trigger(e?n:r)},showPanel:function(){var e=this;$(".panel-toggle").show(),e.trigger(n),e.togglePanel(!0)},hidePanel:function(){this.togglePanel(!1)},hidePanelIcon:function(){$(".panel-toggle").hide()},_backProduct:function(){var e=t.queryString("url");if(e)return window.location.href=decodeURIComponent(e),!1}});return s}),define("p-data",[],function(){return{topicId:null}}),define("text!nav/../../tpl/score/left.tpl",[],function(){return'<div class="composition-left-box">\r\n	<div id="placeholder" class="demo-placeholder"></div>\r\n	<div class="composition-total-score">\r\n		<div class="total-score-center">\r\n			<div class="center">\r\n				<p class="center-score-title">总&ensp;分</p>\r\n				<p class="center-score-self">\r\n					<span class="score_before"></span>\r\n					.<i class="score_after"></i>\r\n				</p>\r\n				<p class="center-score-slash">/</p>\r\n				<p class="center-score-total">{{!it.score}}</p>\r\n			</div>\r\n		</div>\r\n		<img class="total-score-center-title" src="../../writing/images/score-come-on.png" height="62" width="190" >\r\n	</div>\r\n	</div>\r\n	<div class="composition-modul-box default-skin">\r\n	<div class="composition-modul composition-my-comments">\r\n		\r\n	</div>\r\n	<div class="composition-modul composition-edit-guide">\r\n		\r\n	</div>\r\n	<div class="composition-box"></div>'}),define("text!nav/../../tpl/score/score.tpl",[],function(){return'<p class="composition-modul-title">\r\n	我的评语\r\n</p>\r\n<!-- 三角符号 -->\r\n<div class="my-comments-triangle"></div>\r\n<!-- 评语内容 -->\r\n<div class="my-comments-content">\r\n	{{ if(it.allComment){ }}\r\n	<div class="content-total-score">\r\n		<p class="total-score-title">总评:</p>	\r\n		<p class="total-score-content">{{!it.allComment}}</p>	\r\n	</div>\r\n	{{ } }}\r\n	<ul class="content-list">\r\n		{{ if(it.Comment){ }}\r\n			{{ if(it.Comment.languageCn){ }}\r\n			<li>\r\n				<div class="content-list-left">\r\n					<p class="content-list-title">语言</p>\r\n					<p class="content-list-score">{{=it.languageScore.toFixed(1)}}分</p>\r\n				</div>\r\n				<div class="content-list-right">\r\n					<p>{{=it.Comment.languageCn}}</p>\r\n				</div>\r\n			</li>\r\n			{{ } }}\r\n			{{ if(it.Comment.contentCn){ }}\r\n			<li>\r\n				<div class="content-list-left">\r\n					<p class="content-list-title">内容</p>\r\n					<p class="content-list-score">{{=it.contentScore.toFixed(1)}}分</p>\r\n				</div>\r\n				<div class="content-list-right">\r\n					<p>{{=it.Comment.contentCn}}</p>\r\n				</div>\r\n			</li>\r\n			{{ } }}\r\n			{{ if(it.Comment.structCn){ }}\r\n			<li>\r\n				<div class="content-list-left">\r\n					<p class="content-list-title">结构</p>\r\n					<p class="content-list-score">{{=it.styleScore.toFixed(1)}}分</p>\r\n				</div>\r\n				<div class="content-list-right">\r\n					<p>{{=it.Comment.structCn}}</p>\r\n				</div>\r\n			</li>\r\n			{{ } }}\r\n		{{ } }}\r\n		\r\n	</ul>	\r\n</div>'}),define("text!nav/../../tpl/score/correction.tpl",[],function(){return'{{ if(it.list.length > 0){ }}\r\n<p class="composition-modul-title">\r\n	<i class="icon-solid">&#xe60b;</i>\r\n	语言指导\r\n</p>\r\n<ul>\r\n	{{~it.list :v:i}}\r\n	<li class="language-guide-list">\r\n		<div class="language-guide-list-header">\r\n			<p class="language-guide-list-title-num">第{{=i+1}}句</p>\r\n			<p class="language-guide-list-title-content">\r\n				{{!v.sentence}}\r\n			</p>\r\n		</div>\r\n		{{ if(v.errors && v.errors.length > 0){ }}\r\n		<div class="language-guide-list-error">\r\n			<p class="list-error-title">[错误]</p>\r\n			<div class="list-error-content">\r\n				{{~v.errors :val:key}}\r\n				<p>\r\n					<i>{{=key+1}}.</i>\r\n					<span class="list-error-content-main">{{=val.errorContent}}</span>\r\n					<span>{{=val.errorMsg}}</span>\r\n				</p>\r\n				{{~}}\r\n			</div>\r\n		</div>\r\n		{{ } }}\r\n		{{\r\n			var hasWordList = v.wordList && v.wordList.length > 0;\r\n			var idiomsList = v.idiomsList;\r\n			var groupList = [];\r\n			var sameMeanList = [];\r\n		}}\r\n		{{ if(hasWordList || idiomsList){ }}\r\n		<div  class="language-guide-list-comment">\r\n			<p class="list-comment-title">[点评]</p>\r\n\r\n			{{ if(hasWordList){ }}\r\n			{{~v.wordList :val:key}}\r\n				{{ if(val.groupList){ }}\r\n				{{ groupList.push(val); }}\r\n				{{ } }}\r\n				{{ if(val.sameMeanList){ }}\r\n				{{ sameMeanList.push(val); }}\r\n				{{ } }}\r\n			{{~}}\r\n			{{ } }}\r\n\r\n			{{ if(groupList.length > 0){ }}\r\n			<div class="words-area">\r\n				<div class="subtitle">\r\n					<i>[</i>&nbsp;词或词组&nbsp;<i>]</i>\r\n				</div>\r\n				<div class="list-comment-content">\r\n					{{~groupList :val:key}}\r\n					<div class="list-comment-content-each">\r\n						{{~val.groupList :value:j}}\r\n						<p class="list-comment-content-each-header">\r\n							<i class="icon icon-star"></i>\r\n							<span>{{=value.wordGroup}}</span>\r\n						</p>\r\n						<div class="list-comment-content-each-main">\r\n							{{ if(value.example1){ }}<p>{{=it.parse(value.example1)}}</p>{{ } }}\r\n							{{ if(value.example2){ }}<p>{{=it.parse(value.example2)}}</p>{{ } }}\r\n							{{ if(value.example3){ }}<p>{{=it.parse(value.example3)}}</p>{{ } }}\r\n						</div>\r\n						{{ if(value.wordUsage){ }}\r\n						<div class="word-usage">\r\n							<strong>用法：</strong>{{=value.wordUsage}}\r\n						</div>\r\n						{{ } }}\r\n						{{~}}\r\n					</div>\r\n					{{~}}\r\n				</div>\r\n			</div>\r\n			{{ } }}\r\n\r\n			{{ if(sameMeanList.length > 0){ }}\r\n			<div class="synonyms-area">\r\n				<div class="subtitle">\r\n					<i>[</i>&nbsp;近义词&nbsp;<i>]</i>\r\n				</div>\r\n				<div class="comment-list">\r\n					{{~sameMeanList :val:key}}\r\n					<div class="comment-item">\r\n						<h4><i class="icon icon-synonyms"></i>{{=val.word}}</h4>\r\n						<ul class="detail-list">\r\n							{{~val.sameMeanList :sameMeanVal:sameMeanKey}}\r\n							{{\r\n								var synonymsList = sameMeanVal.synonyms && sameMeanVal.synonyms.split(\',\');\r\n							}}\r\n							<li>\r\n								<div>\r\n									<span class="detail-title">释义：</span>{{=sameMeanVal.clearDefinition}}\r\n								</div>\r\n								{{ if(synonymsList.length > 0){ }}\r\n								<div class="synonyms-words">\r\n									<span class="detail-title">近义词：</span>\r\n									<span class="words-list">\r\n										{{~synonymsList :synoVal:synoKey}}\r\n										<a class="words-item" href="javascript:;">\r\n											{{=synoVal}}\r\n										</a>\r\n										{{ if(synoKey != synonymsList.length - 1){ }}\r\n										，\r\n										{{ } }}\r\n										{{~}}\r\n										<i class="more">more&gt;&gt;</i>\r\n									</span>\r\n								</div>\r\n								{{ } }}\r\n							</li>\r\n							{{~}}\r\n						</ul>\r\n					</div>\r\n					{{~}}\r\n				</div>\r\n			</div>\r\n			{{ } }}\r\n\r\n			{{ if(idiomsList && $.type(idiomsList) == \'array\' && idiomsList.length > 0){ }}\r\n			<div class="vulgarism-area" style="display:none;">\r\n				<div class="subtitle">\r\n					<i>[</i>&nbsp;俗语&nbsp;<i>]</i>\r\n				</div>\r\n				<div class="comment-list">\r\n					<div class="comment-item">\r\n						<ul class="detail-list">\r\n							{{~idiomsList :val:key}}\r\n							<li class="vulgarism-item">{{=val}}</li>\r\n							{{~}}\r\n						</ul>\r\n					</div>\r\n				</div>\r\n			</div>\r\n			{{ } }}\r\n		</div>\r\n		{{ } }}\r\n	</li>\r\n\r\n	{{~}}\r\n</ul>\r\n{{ } }}'}),define("text!nav/../../tpl/score/suggestion.tpl",[],function(){return'<div class="composition-modul composition-language">\r\n	<div class="language-title">\r\n		<p class="title">语言总汇</p>\r\n		<p class="triangle"></p>\r\n		<p class="hidden-word">隐藏单词详情</p>\r\n	</div>\r\n	<div class="language-content">\r\n		{{~it.vocabulary.posList :v:i}}\r\n		<div class="content-li">\r\n			<div class="produce">\r\n				<span class="name">{{=v.desc}}：</span>\r\n				<span class="low">低级：</span><i>{{=v.low}}</i>\r\n				<span class="base">基本：</span><i>{{=v.basic}}</i>\r\n				<span class="super">超纲：</span><i>{{=v.beyond}}</i>\r\n			</div>\r\n			<p class="word">\r\n				{{ if(v.words.low != \'\'){ }}\r\n				<span class="low">{{=v.words.low.replace(/,/g, \', \')}}</span>,\r\n				{{ } }}\r\n				{{ if(v.words.basic != \'\'){ }}\r\n				<span class="base">{{=v.words.basic.replace(/,/g, \', \')}}</span>,\r\n				{{ } }}\r\n				{{ if(v.words.beyond != \'\'){ }}\r\n				<span class="super">{{=v.words.beyond.replace(/,/g, \', \')}}</span>\r\n				{{ } }}\r\n			</p>\r\n		</div>\r\n		{{~}}\r\n		<div class="sentence">\r\n			<p>\r\n				<span class="title">短 句：</span>\r\n				<span class="low">{{=it.vocabulary.sentenceMap.short.count}}</span>，\r\n				<span class="low">{{=it.vocabulary.sentenceMap.short.percent}}</span>\r\n			</p>\r\n			<p>\r\n				<span class="title">中 句：</span>\r\n				<span class="base">{{=it.vocabulary.sentenceMap.mid.count}}</span>，\r\n				<span class="base">{{=it.vocabulary.sentenceMap.mid.percent}}</span>\r\n			</p>\r\n			<p>\r\n				<span class="title">长 句：</span>\r\n				<span class="super">{{=it.vocabulary.sentenceMap.long.count}}</span>，\r\n				<span class="super">{{=it.vocabulary.sentenceMap.long.percent}}</span>\r\n			</p>\r\n		</div>\r\n		<div class="summary">\r\n			字数：\r\n			<span class="">{{=it.vocabulary.wordsCount}}</span>字，平均词长：\r\n			<span class="">{{=it.vocabulary.avgLength}}</span>个字，段落数\r\n			<span class="">{{=it.vocabulary.paragraph}}</span>段\r\n		</div>	\r\n	</div>\r\n			\r\n</div>\r\n<div class="composition-modul composition-theme">\r\n	<div class="theme-title">\r\n		<p class="title">主题解析</p>\r\n		<p class="theme-triangle"></p>\r\n	</div>\r\n	<div class="theme-content">\r\n		<p class="article">{{=it.centerSentence1}}</p>\r\n		<p class="content">{{=it.centerSentenceTips}}</p>\r\n	</div>\r\n</div>\r\n<div class="composition-modul composition-write-advice">\r\n	<div class="composition-modul-title">\r\n		<p class="title">写作建议</p>\r\n		<p class="write-triangle"></p>\r\n	</div>\r\n	<div class="write-advice-title">{{=it.questionZh}}</div>\r\n	<div class="write-advice-content">{{=it.contentZh}}</div>	\r\n</div>\r\n'}),define("text!nav/../../tpl/score/tip-synonyms.tpl",[],function(){return'{{ if(it.word){ }}\r\n<h4>{{=it.word}}</h4>\r\n{{ } }}\r\n{{ if(it.phonetic_symbol_a){ }}\r\n<div class="pronunciation">\r\n	{{=it.phonetic_symbol_a}}\r\n</div>\r\n{{ } }}\r\n{{ if(it.lexical_category){ }}\r\n<div class="speech">{{=it.lexical_category}}</div>\r\n{{ } }}\r\n{{ if(it.translation){ }}\r\n<div class="desc">{{=it.translation}}</div>\r\n{{ } }}\r\n{{ if(it.example_1){ }}\r\n<div class="examples">\r\n	<h5>例如：</h5>\r\n	<p>{{=it.parse(it.example_1)}}</p>\r\n	<p>{{=it.parse(it.example_trans_1)}}</p>\r\n</div>\r\n{{ } }}\r\n'}),define("root-base/model/scoringModel",[],function(){var e=Backbone.Model.extend({initialize:function(){this.url=window.serviceBase+"/scoring"}});return e.list=Backbone.Collection.extend({model:e,initialize:function(){}}),e}),define("root-base/model/suggestModel",[],function(){var e=Backbone.Model.extend({initialize:function(){this.url=window.serviceBase+"/suggest"}});return e.list=Backbone.Collection.extend({model:e,initialize:function(){}}),e}),define("root-base/model/ajax",[],function(){return{request:function(e,t,n){var r=this,i=$.extend(!0,{headers:{token:window.token},dataType:"json"},e);$.ajax(i).done(function(i){r.trigger(t,i,null,e.data,n)}).fail(function(e,n,i){r.trigger(t,null,e)})}}}),define("root-base/model/correctionModel",["./ajax"],function(e){var t="getDict",n=Backbone.Model.extend({initialize:function(){this.url=window.serviceBase+"/correction"},getDict:function(n,r){n=$.extend(!0,{url:window.serviceBase+"/queryDict"},n),e.request.call(this,n,t,r)}});return n}),define("root-common/module/tip2",[],function(){var e=$(window),t={showDelay:300,hideDelay:300,gravity:"n",auto:!0,container:null,inTip:!0,className:"",afterTip:$.noop,shadowSize:8},n='<div class="ui-tip-wrap"><div class="ui-tip-mask"></div><div class="ui-tip-arrow"></div><div class="ui-tip-inner"></div></div>',r,i,s=$("body"),o=o?o:$(n).appendTo(s),u=$(".ui-tip-inner",o),a=$(".ui-tip-arrow",o),f=$(".ui-tip-mask",o),l=5,c=!0,h=function(e,t,n){r&&clearTimeout(r),r=setTimeout(function(){if(!c)return;n&&u.html(n),o.show().attr("class","ui-tip-wrap "+e.className),position=e.getPosition(),o.addClass("ui-tip-"+e.gravity),t&&a.css({left:t.offset().left+t.outerWidth()/2-position.left}),a.attr("class","ui-tip-arrow ui-tip-arrow-"+e.gravity),o.css(position),f.css({height:o.outerHeight(),width:o.outerWidth()})},e.showDelay)},p=function(e){r&&clearTimeout(r),r=setTimeout(function(){if(i)return;o.hide().removeClass("ui-tip-"+e.gravity+" "+e.className),a.removeClass("ui-tip-arrow-"+e.gravity)},e.hideDelay)},d=Backbone.View.extend({initialize:function(e){var n=this;$.extend(n,t,e)},show:function(e){var t=this;if(!t.renderHtml)return;var n=t.renderHtml.apply(t,arguments);t.update(n)},getPosition:function(){var t,n,r=this,i=r.$el,s=r.container?r.container.offset().left:0,u=r.container?r.container.offset().top:0,a=r.container||e,f=i.offset().left-s+o.outerWidth()/2+i.outerWidth()/2-a.outerWidth()+r.shadowSize,c=o.outerWidth()/2-i.outerWidth()/2-(i.offset().left-s),h=f>0?f:c>0?-c:0;r.gravity=r.auto?r.autoGravity(a,s,u):r.gravity;switch(r.gravity){case"s":t=i.offset().left-(o.outerWidth()/2-i.outerWidth()/2),n=i.offset().top-o.outerHeight()-l;break;case"n":t=i.offset().left-(o.outerWidth()/2-i.outerWidth()/2),n=i.offset().top+i.outerHeight()+l}return t-=h,{left:t,top:n}},autoGravity:function(e,t,n){var r=this;return this.$el.offset().top-n>e.scrollTop()+e.height()-o.outerHeight()-this.$el.outerHeight()?"s":"n"},hide:function(){p(this)},update:function(e,t){var n=this,r=n.$el;e&&(o.data("tip-target",r[0]).data("tip",n),h(this,r,e)),n.afterTip(e)}});return $.fn.tip=function(e){var n=$.extend({},t,e),r=$.makeArray(arguments),s=function(e){var t=$(e.currentTarget),r=t.data("tip");return $.extend(n,{el:t,wrap:u}),r||(r=new d(n),t.data("tip",r)),r};return this.each(function(){var t=$(this);if($.type(e)==="string"){var n=t.data("tip");n&&n[e].apply(n,r.slice(1))}else t.hover(function(e){i=o.data("tip-target")==e.target,c=!0;var t=s(e);i||o.hide(),t.show(e)},function(e){var t=s(e);i=!1,c=!1,t.hide()}).click(function(e){var t=s(e);t.hide()})})},o.hover(function(){var e=$(this).data("tip");c=!0;if(!e.inTip)return;i=!0,h(e)},function(){var e=$(this).data("tip");c=!1;if(!e.inTip)return;i=!1,p(e)}),d}),define("nav/score",["root-common/util","text!../../tpl/score/left.tpl","text!../../tpl/score/score.tpl","text!../../tpl/score/correction.tpl","text!../../tpl/score/suggestion.tpl","text!../../tpl/score/tip-synonyms.tpl","root-base/model/scoringModel","root-base/model/suggestModel","root-base/model/correctionModel","root-common/module/tip2"],function(e,t,n,r,i,s,o,u,a){var f=null,l=Backbone.View.extend({initialize:function(){var e=this;e.isLoad=!1,e.isInit=!1,e._isShow=!1,e._isWord=!1,e._isLanguage=!1,e._isTheme=!1,e._isWrite=!1,e._leftTpl=doT.template(t),e._scoreTpl=doT.template(n),e._correctionTpl=doT.template(r),e._suggestionTpl=doT.template(i),e._tipSynonymsTpl=doT.template(s),e._scoreModel=new o,e._correctionModel=new a,e._suggestModel=new u,e._topicId=null,e._totalScore=0},events:{"click .my-comments-triangle":"_showThumb","click .hidden-word":"_hiddenWord","click .triangle":"_hiddenLanguage","click .theme-triangle":"_hiddenTheme","click .write-triangle":"_hiddenWrite","click .synonyms-words .words-list .more":"_toggleSynonyms"},render:function(){var e=this;this.$el.html(e._leftTpl({})),$(".ui-article",e.$el).css({top:$(".icon-list",e.$el).outerHeight()+$(".ui-topic",e.$el).outerHeight()+20})},init:function(){var e=this;e.isInit=!0,e.render(),e.clientHeight(),e._scoreModel.bind({change:$.proxy(e.renderScore,e)}),e._suggestModel.bind({change:$.proxy(e.renderSuggestion,e)}),e._correctionModel.bind({getDict:$.proxy(e._showTipContent,e)})},loadScore:function(e){var t=this;t._topicId=e?e:t._topicId,t._scoreModel.fetch({url:t._scoreModel.url+"/"+t._topicId,cache:!1,headers:{token:window.token}})},loadSuggestion:function(e){var t=this;t._topicId=e?e:t._topicId,t._suggestModel.fetch({url:t._suggestModel.url,cache:!1,headers:{token:window.token}})},reset:function(){this.isLoad=!1},renderScore:function(){var t=this,n=t._scoreModel.toJSON()||{};t.isLoad=!0,e.dealAjax(function(e){if(!e){var r=n.data,i=r.overall.toFixed(1);$(".composition-my-comments",t.$el).html(t._scoreTpl(r)),$(".score_before",t.$el).text(i.split(".")[0]),$(".score_after",t.$el).text(i.split(".")[1]),$(".center-score-total",t.$el).text(t._totalScore),t.initPie(i,t._totalScore),t.updateScollbar()}},n,arguments[1])},renderSuggestion:function(){var t=this,n=t._suggestModel.toJSON()||{};e.dealAjax(function(e){if(!e){var r=n.data;$(".composition-box",t.$el).show().html(t._suggestionTpl(r)),t.updateScollbar()}},n,arguments[1])},hideSuggestion:function(){$(".composition-box",this.$el).hide()},renderCorrection:function(e){var t=this;$(".composition-edit-guide",t.$el).html(t._correctionTpl({list:e||[],parse:t._parse})),t.updateScollbar(),t._updateTips()},_showThumb:function(){this.showThumb()},showThumb:function(e){var t=this;t._isShow=e||!t._isShow,e=t._isShow,$(".my-comments-triangle")[e?"addClass":"removeClass"]("my-comments-triangle-show"),$(".my-comments-content").fadeToggle()},_hiddenWord:function(){this.hiddenWord()},hiddenWord:function(e){var t=this;t._isWord=e||!t._isWord,isShow=t._isWord;var n=[isShow?"展开单词详情":"隐藏单词详情"];$(".hidden-word").html(n),$(".word").fadeToggle()},_hiddenLanguage:function(){this.hiddenLanguage()},hiddenLanguage:function(e){var t=this;t._isLanguage=e||!t._isLanguage,e=t._isLanguage,$(".triangle")[e?"addClass":"removeClass"]("triangle-hover"),$(".language-content,.hidden-word").fadeToggle()},_hiddenTheme:function(){this.hiddenTheme()},hiddenTheme:function(e){var t=this;t._isTheme=e||!t._isTheme,e=t._isTheme,$(".theme-triangle")[e?"addClass":"removeClass"]("theme-triangle-hover"),$(".theme-content").fadeToggle()},_hiddenWrite:function(){this.hiddenWrite()},hiddenWrite:function(e){var t=this;t._isWrite=e||!t._isWrite,e=t._isWrite,$(".write-triangle")[e?"addClass":"removeClass"]("write-triangle-hover"),$(".write-advice-title ,.write-advice-content").fadeToggle()},initPie:function(e,t){var n=[],e=100*e/t;series=[100-e,e];for(var r=0;r<series.length;r++)n[r]={data:series[r]};var i=$("#placeholder");$("#placeholder").css({width:154,height:154}),$.plot(i,n,{series:{pie:{show:!0,stroke:{color:"#d5e0e5"}}},colors:["#d5e0e5","#4ab9de"]})},clientHeight:function(){var e=document.documentElement.clientHeight;$(".composition-modul-box").css({height:e-220}),setTimeout(function(){$(".composition-modul-box").customScrollbar({updateOnWindowResize:!0})},300)},setTotalScore:function(e){this._totalScore=e},updateScollbar:function(){$(".composition-modul-box").customScrollbar("resize")},setTopicId:function(e){this._topicId=e},_toggleSynonyms:function(e){e.preventDefault();var t=$(e.target).closest(".words-list").toggleClass("words-list-show")},_updateTips:function(){var e=this;$(".synonyms-words .words-item",e.$el).tip({gravity:"s",auto:!1,container:e.$el,className:"tip-synonyms",renderHtml:function(t){var n=this;return f&&clearTimeout(f),f=setTimeout(function(){e._correctionModel.getDict({data:{word:$(t.currentTarget).text()}},{node:n.el})},500),'<div class="loading"></div>'}})},_showTipContent:function(t,n,r,i){var s=this;e.dealAjax(function(e){if(!e){var n=i&&i.node,r=t.data;r=$.extend(!0,{parse:s._parse},r);if(n){var o=s._tipSynonymsTpl(r);n.tip("update",o)}}},t,n)},_parse:function(e){var t=/#[^#]*?#/g;return e.replace(t,function(e){return e=e.replace(/#/g,""),'<i style="color:red;">'+e+"</i>"})}});return l}),define("text!topic/../../tpl/topic/detail.tpl",[],function(){return'<div class="title">\r\n	<span class="keyword">命题</span>\r\n	<p>{{!it.topicName}}</p>\r\n</div>\r\n<div class="demand">\r\n	<span class="keyword">命题要求</span>\r\n	<div class="desc default-skin">{{!it.topicDesc}}</div>\r\n	<p class="words">（{{=it.minWord}}—{{=it.maxWord}}字，满分：{{=it.score}}分）</p>\r\n</div>'}),define("root-base/model/topicModel",[],function(){var e=Backbone.Model.extend({initialize:function(){this.url=window.serviceBase+"/topic"}});return e}),define("root-base/model/recTopicsModel",["./ajax"],function(e){var t="getTopicType",n="getTopicList",r="getTopicListByKeyword",i="getTopicManual",s=Backbone.Model.extend({initialize:function(){},getTopicType:function(n){n=$.extend(!0,{url:window.serviceBase+"/topicType"},n),e.request.call(this,n,t)},getTopicList:function(t){t=$.extend(!0,{url:window.serviceBase+"/topicListByType"},t),e.request.call(this,t,n)},getTopicListByKeyword:function(t){t=$.extend(!0,{url:window.serviceBase+"/topicListByKeyword"},t),e.request.call(this,t,r)},getTopicManual:function(t){t=$.extend(!0,{url:window.serviceBase+"/topicManual"},t),e.request.call(this,t,i)}});return s}),define("text!topic/../../tpl/topic/topicRecNav.tpl",[],function(){return'{{~it.list :v:i}}\r\n	<li class="nav-item\r\n	{{ if(i == 0){ }} nav-item-on {{ } }}\r\n	{{ if(i == it.list.length-1){ }} nav-item-last {{ } }}\r\n	">\r\n		<a href="javascript:;">{{=v.typeName}}</a>\r\n	</li>\r\n{{~}}'}),define("text!topic/../../tpl/topic/topicRecPanel.tpl",[],function(){return'{{~it.list :v:i}}\r\n	<li class="panel-item\r\n	{{ if(i == 0){ }} panel-item-on {{ } }}\r\n	{{ if(i == it.list.length-1){ }} panel-item-last {{ } }}\r\n	">\r\n		\r\n	</li>\r\n{{~}}'}),define("text!topic/../../tpl/topic/topicRecList.tpl",[],function(){return'{{ if(it.list.length > 0){ }}\r\n{{~it.list :v:i}}\r\n	<li class="topic-item\r\n	{{ if(i == 0){ }} topic-item-active {{ } }}\r\n	{{ if(i%2 == 0){ }} even {{ } }}\r\n	" data-id="{{=v.id}}">\r\n		<a href="javascript:;" class="title">{{=v.topicName}}</a>\r\n		<div class="title">\r\n			<span class="keyword">命题</span>\r\n			<p>{{=v.topicName}}</p>\r\n		</div>\r\n		<div class="demand">\r\n			<span class="keyword">命题要求</span>\r\n			<div class="desc default-skin">{{=v.topicDesc}}</div>\r\n			<p class="words">（{{=v.minWord}}—{{=v.maxWord}}字，满分：{{=v.score}}分）</p>\r\n		</div>\r\n	</li>\r\n{{~}}\r\n\r\n{{ }else{ }}\r\n	<li class="noitem">\r\n		没有相关记录\r\n	</li>\r\n{{ } }}'}),define("text!topic/../../tpl/topic/topicRecMain.tpl",[],function(){return'<div class="topics-inner">\r\n	<div class="topic-search">\r\n		<input type="text" class="frm-txt" placeholder="请输入作业标题或关键字" />\r\n		<a href="javascript:;" class="btn-search"><i class="icon-linear">&#xe605;</i></a>\r\n	</div>\r\n	<div class="topic-list default-skin">\r\n		<ul class="list-nav fix"></ul>\r\n		<ul class="list-panel"></ul>\r\n		<div class="topic-pagi"></div>\r\n	</div>\r\n</div>'}),define("text!root-common/module/pagination.tpl",[],function(){return'<ul class="pagination">\n{{ if(it.total > 1){ }}\n    <li class="page pagi-first">\n        <a href="#">首页</a>\n    </li>\n    {{ if(it.current > 1){ }}\n    <li class="page pagi-prev">\n        <a href="#">\n            <span class="txt">上一页</span>\n            <span class="icon-linear">&#xe607;</span>\n        </a>\n    </li>\n    {{ } }}\n    {{ for(var i = 0; i < it.total; i++){ }}\n    <li class="page\n    {{ if(i == it.current - 1){ }}active{{ } }}\n    " rel="{{=i+1}}"><a href="#">{{=i+1}}</a></li>\n    {{ } }}\n    {{ if(it.current < it.total){ }}\n    <li class="page pagi-next">\n        <a href="#">\n            <span class="txt">下一页</span>\n            <span class="icon-linear">&#xe609;</span>\n        </a>\n    </li>\n    {{ } }}\n    <li class="page pagi-last">\n        <a href="#">末页</a>\n    </li>\n    <input class="pagi-which" type="text" />\n    <span class="pagi-go">跳转</span>\n{{ } }}\n</ul>'}),define("root-common/module/pagination",["text!./pagination.tpl"],function(e){var t=Backbone.View.extend({initialize:function(t){t.total=t.total||1,t.current=t.current||1,this.options=t,this._tpl=doT.template(e),this.render()},events:{"click .page":"_go","click .pagi-go":"_direct","click .pagi-first":"_goFirst","click .pagi-last":"_goLast"},_go:function(e){e.preventDefault();var t=this,n=$(e.currentTarget);if(n.hasClass("pagi-prev"))t.prev();else if(n.hasClass("pagi-next"))t.next();else{var r=parseInt($.trim(n.attr("rel")));/\d+/.test(r)&&t.go(parseInt(r))}},_direct:function(e){e.preventDefault();var t=$(".pagi-which",this.$el).val();try{t=parseInt(t),t<=this.options.total&&this.go(t)}catch(e){}},_goFirst:function(e){e.preventDefault(),this.go(1)},_goLast:function(e){e.preventDefault(),this.go(this.options.total)},render:function(){this.$el.html(this._tpl(this.options))},reset:function(e){e&&$.extend(this.options,e),this.render()},total:function(e){return e!==undefined&&(this.options.total=e),this.options.total},current:function(e){return e!==undefined&&(this.options.current=e),this.options.current},go:function(e,t){return this.current(e),this.reset(),t&&t(this.options.current),this.trigger("toggle",e),this},prev:function(e){return this.options.current>1&&this.go(this.options.current-1,e),this},next:function(e){return this.options.current<this.options.total&&this.go(this.options.current+1,e),this},first:function(){return this.options.current>1&&this.go(1),this},last:function(){return this.options.current<this.options.total&&this.go(this.options.total),this}});return t}),define("topic/topicRec",["root-base/model/recTopicsModel","text!../../tpl/topic/topicRecNav.tpl","text!../../tpl/topic/topicRecPanel.tpl","text!../../tpl/topic/topicRecList.tpl","text!../../tpl/topic/topicRecMain.tpl","root-common/util","root-common/module/tab","root-common/module/pagination"],function(e,t,n,r,i,s,o,u){var a="init.topic",f=Backbone.View.extend({initialize:function(e){var s=this;s.$btn=$(e.btn).unbind("click").click($.proxy(s.show,s)),s._navTpl=doT.template(t),s._panelTpl=doT.template(n),s._listTpl=doT.template(r),s._mainTpl=doT.template(i),s.reset(),s.render()},events:{"mouseenter .topic-item":"_showTopic","click .topic-item":"_initTopic","click .btn-search":"_search"},render:function(){this.$el.html(this._mainTpl({}))},reset:function(){var t=this;t._model=new e,t._isShow=!1,t._isPanelOpened=!1,t._tab=null,t._page=null,t._topicTypes=[],t._currentTopicCode=null,t._model.bind({getTopicType:$.proxy(t._getTopicType,t),getTopicList:$.proxy(t._getTopicList,t),getTopicManual:$.proxy(t._getTopicManual,t)})},show:function(e){e.preventDefault();var t=this,n=t._isShow=!t._isShow;t.$el.toggle(),n&&t._model.getTopicType()},hide:function(){this.$el.hide()},_getTopicType:function(e,t){var n=this;s.dealAjax(function(t){if(!t){var r=n._topicTypes=e.data;$(".list-nav",n.$el).html(n._navTpl({list:r})),$(".list-panel",n.$el).html(n._panelTpl({list:r})),n._tab=new o({btns:$(".list-nav .nav-item",n.$el),panels:$(".list-panel .panel-item",n.$el)}),n._tab.bind("select",$.proxy(n._switchTab,n,r))}},e,t)},_getTopicList:function(e,t,n){var r=this;s.dealAjax(function(t){if(!t){r._isPanelOpened=!0;var i=e.data,s=i.recordList||[];try{var o=n.keyword,a=n.typeCode,f=r._tab.getIndex(),l=f+1;$(".panel-item",r.$el).eq(f).html(r._listTpl({list:s})),r._page||(r._page=new u({el:$(".topic-pagi",r.$el),total:i.pageSum,current:l}),r._page.bind("toggle",function(e){var t={typeCode:r._currentTopicCode,pageNum:e,pageSize:13};r._loadTopicList(t)}));if(a!==r._currentTopicCode||o!==undefined)r._currentTopicCode=a,r._page.current(1),r._page.total(i.pageSum),r._page.render()}catch(c){}}},e,t)},_showTopic:function(e){$(".topic-item-active",this.$el).removeClass("topic-item-active"),$(e.currentTarget).addClass("topic-item-active")},_switchTab:function(e,t){var n=this,r=e[t];r&&n.search(r.typeCode)},_loadTopicList:function(e){this._model.getTopicList({data:e})},_search:function(e){e.preventDefault(),this.search()},search:function(e){var t=this,n=$(".topic-search .frm-txt",this.$el).val();n=t._getKeyword(n),e=e||t._currentTopicCode;var r={typeCode:e,keyword:n,pageNum:1,pageSize:13};n||(r.keyword=""),t._loadTopicList(r)},_getKeyword:function(e){return e=$.trim(e),e},_initTopic:function(e){e.preventDefault();var t=$(e.currentTarget).data("id");t!==undefined&&this._model.getTopicManual({data:{topicId:t}})},_getTopicManual:function(e,t){var n=this;s.dealAjax(function(t){t||(n.$el.hide(),n.trigger(a,e.data),n.undelegateEvents(),n.off())},e,t)}});return f}),define("root-common/module/scrollbar",[],function(){(function(e){e.fn.customScrollbar=function(t,n){var r={skin:undefined,hScroll:!0,vScroll:!0,updateOnWindowResize:!1,animationSpeed:300,onCustomScroll:undefined,swipeSpeed:1,wheelSpeed:40,fixedThumbWidth:undefined,fixedThumbHeight:undefined,preventDefaultScroll:!1},i=function(t,n){this.$element=e(t),this.options=n,this.addScrollableClass(),this.addSkinClass(),this.addScrollBarComponents(),this.options.vScroll&&(this.vScrollbar=new s(this,new u)),this.options.hScroll&&(this.hScrollbar=new s(this,new o)),this.$element.data("scrollable",this),this.initKeyboardScrolling(),this.bindEvents()};i.prototype={addScrollableClass:function(){this.$element.hasClass("scrollable")||(this.scrollableAdded=!0,this.$element.addClass("scrollable"))},removeScrollableClass:function(){this.scrollableAdded&&this.$element.removeClass("scrollable")},addSkinClass:function(){typeof this.options.skin=="string"&&!this.$element.hasClass(this.options.skin)&&(this.skinClassAdded=!0,this.$element.addClass(this.options.skin))},removeSkinClass:function(){this.skinClassAdded&&this.$element.removeClass(this.options.skin)},addScrollBarComponents:function(){this.assignViewPort(),this.$viewPort.length==0&&(this.$element.wrapInner('<div class="viewport" />'),this.assignViewPort(),this.viewPortAdded=!0),this.assignOverview(),this.$overview.length==0&&(this.$viewPort.wrapInner('<div class="overview" />'),this.assignOverview(),this.overviewAdded=!0),this.addScrollBar("vertical","prepend"),this.addScrollBar("horizontal","append")},removeScrollbarComponents:function(){this.removeScrollbar("vertical"),this.removeScrollbar("horizontal"),this.overviewAdded&&this.$element.unwrap(),this.viewPortAdded&&this.$element.unwrap()},removeScrollbar:function(e){this[e+"ScrollbarAdded"]&&this.$element.find(".scroll-bar."+e).remove()},assignViewPort:function(){this.$viewPort=this.$element.find(".viewport")},assignOverview:function(){this.$overview=this.$viewPort.find(".overview")},addScrollBar:function(e,t){this.$element.find(".scroll-bar."+e).length==0&&(this.$element[t]("<div class='scroll-bar "+e+"'><div class='thumb'></div></div>"),this[e+"ScrollbarAdded"]=!0)},resize:function(e){this.vScrollbar&&this.vScrollbar.resize(e),this.hScrollbar&&this.hScrollbar.resize(e)},scrollTo:function(e){this.vScrollbar&&this.vScrollbar.scrollToElement(e),this.hScrollbar&&this.hScrollbar.scrollToElement(e)},scrollToXY:function(e,t){this.scrollToX(e),this.scrollToY(t)},scrollToX:function(e){this.hScrollbar&&this.hScrollbar.scrollOverviewTo(e,!0)},scrollToY:function(e){this.vScrollbar&&this.vScrollbar.scrollOverviewTo(e,!0)},scrollByX:function(e){this.hScrollbar&&this.scrollToX(this.hScrollbar.overviewPosition()+e)},scrollByY:function(e){this.vScrollbar&&this.scrollToY(this.vScrollbar.overviewPosition()+e)},remove:function(){this.removeScrollableClass(),this.removeSkinClass(),this.removeScrollbarComponents(),this.$element.data("scrollable",null),this.removeKeyboardScrolling(),this.vScrollbar&&this.vScrollbar.remove(),this.hScrollbar&&this.hScrollbar.remove()},setAnimationSpeed:function(e){this.options.animationSpeed=e},isInside:function(t,n){var r=e(t),i=e(n),s=r.offset(),o=i.offset();return s.top>=o.top&&s.left>=o.left&&s.top+r.height()<=o.top+i.height()&&s.left+r.width()<=o.left+i.width()},initKeyboardScrolling:function(){var e=this;this.elementKeydown=function(t){document.activeElement===e.$element[0]&&(e.vScrollbar&&e.vScrollbar.keyScroll(t),e.hScrollbar&&e.hScrollbar.keyScroll(t))},this.$element.attr("tabindex","-1").keydown(this.elementKeydown)},removeKeyboardScrolling:function(){this.$element.removeAttr("tabindex").unbind("keydown",this.elementKeydown)},bindEvents:function(){this.options.onCustomScroll&&this.$element.on("customScroll",this.options.onCustomScroll)}};var s=function(e,t){this.scrollable=e,this.sizing=t,this.$scrollBar=this.sizing.scrollBar(this.scrollable.$element),this.$thumb=this.$scrollBar.find(".thumb"),this.setScrollPosition(0,0),this.resize(),this.initMouseMoveScrolling(),this.initMouseWheelScrolling(),this.initTouchScrolling(),this.initMouseClickScrolling(),this.initWindowResize()};s.prototype={resize:function(e){this.overviewSize=this.sizing.size(this.scrollable.$overview),this.calculateViewPortSize(),this.sizing.size(this.scrollable.$viewPort,this.viewPortSize),this.ratio=this.viewPortSize/this.overviewSize,this.sizing.size(this.$scrollBar,this.viewPortSize),this.thumbSize=this.calculateThumbSize(),this.sizing.size(this.$thumb,this.thumbSize),this.maxThumbPosition=this.calculateMaxThumbPosition(),this.maxOverviewPosition=this.calculateMaxOverviewPosition(),this.enabled=this.overviewSize>this.viewPortSize,this.scrollPercent===undefined&&(this.scrollPercent=0),this.enabled?this.rescroll(e):this.setScrollPosition(0,0),this.$scrollBar.toggle(this.enabled)},calculateViewPortSize:function(){var e=this.sizing.size(this.scrollable.$element);if(e>0&&!this.maxSizeUsed)this.viewPortSize=e,this.maxSizeUsed=!1;else{var t=this.sizing.maxSize(this.scrollable.$element);this.viewPortSize=Math.min(t,this.overviewSize),this.maxSizeUsed=!0}},calculateThumbSize:function(){var e=this.sizing.fixedThumbSize(this.scrollable.options),t;return e?t=e:t=this.ratio*this.viewPortSize,Math.max(t,this.sizing.minSize(this.$thumb))},initMouseMoveScrolling:function(){var t=this;this.$thumb.mousedown(function(e){t.enabled&&t.startMouseMoveScrolling(e)}),this.documentMouseup=function(e){t.stopMouseMoveScrolling(e)},e(document).mouseup(this.documentMouseup),this.documentMousemove=function(e){t.mouseMoveScroll(e)},e(document).mousemove(this.documentMousemove),this.$thumb.click(function(e){e.stopPropagation()})},removeMouseMoveScrolling:function(){this.$thumb.unbind(),e(document).unbind("mouseup",this.documentMouseup),e(document).unbind("mousemove",this.documentMousemove)},initMouseWheelScrolling:function(){var e=this;this.scrollable.$element.mousewheel(function(t,n,r,i){if(e.enabled){var s=e.mouseWheelScroll(r,i);e.stopEventConditionally(t,s)}})},removeMouseWheelScrolling:function(){this.scrollable.$element.unbind("mousewheel")},initTouchScrolling:function(){if(document.addEventListener){var e=this;this.elementTouchstart=function(t){e.enabled&&e.startTouchScrolling(t)},this.scrollable.$element[0].addEventListener("touchstart",this.elementTouchstart),this.documentTouchmove=function(t){e.touchScroll(t)},this.scrollable.$element[0].addEventListener("touchmove",this.documentTouchmove),this.elementTouchend=function(t){e.stopTouchScrolling(t)},this.scrollable.$element[0].addEventListener("touchend",this.elementTouchend)}},removeTouchScrolling:function(){document.addEventListener&&(this.scrollable.$element[0].removeEventListener("touchstart",this.elementTouchstart),document.removeEventListener("touchmove",this.documentTouchmove),this.scrollable.$element[0].removeEventListener("touchend",this.elementTouchend))},initMouseClickScrolling:function(){var e=this;this.scrollBarClick=function(t){e.mouseClickScroll(t)},this.$scrollBar.click(this.scrollBarClick)},removeMouseClickScrolling:function(){this.$scrollBar.unbind("click",this.scrollBarClick)},initWindowResize:function(){if(this.scrollable.options.updateOnWindowResize){var t=this;this.windowResize=function(){t.resize()},e(window).resize(this.windowResize)}},removeWindowResize:function(){e(window).unbind("resize",this.windowResize)},isKeyScrolling:function(e){return this.keyScrollDelta(e)!=null},keyScrollDelta:function(e){for(var t in this.sizing.scrollingKeys)if(t==e)return this.sizing.scrollingKeys[e](this.viewPortSize);return null},startMouseMoveScrolling:function(t){this.mouseMoveScrolling=!0,e("body").addClass("not-selectable"),this.setUnselectable(e("body"),"on"),this.setScrollEvent(t),t.preventDefault()},stopMouseMoveScrolling:function(t){this.mouseMoveScrolling=!1,e("body").removeClass("not-selectable"),this.setUnselectable(e("body"),null)},setUnselectable:function(e,t){e.attr("unselectable")!=t&&(e.attr("unselectable",t),e.find(":not(input)").attr("unselectable",t))},mouseMoveScroll:function(e){if(this.mouseMoveScrolling){var t=this.sizing.mouseDelta(this.scrollEvent,e);this.scrollThumbBy(t),this.setScrollEvent(e)}},startTouchScrolling:function(e){e.touches&&e.touches.length==1&&(this.setScrollEvent(e.touches[0]),this.touchScrolling=!0,e.stopPropagation())},touchScroll:function(e){if(this.touchScrolling&&e.touches&&e.touches.length==1){var t=-this.sizing.mouseDelta(this.scrollEvent,e.touches[0])*this.scrollable.options.swipeSpeed,n=this.scrollOverviewBy(t);n&&this.setScrollEvent(e.touches[0]),this.stopEventConditionally(e,n)}},stopTouchScrolling:function(e){this.touchScrolling=!1,e.stopPropagation()},mouseWheelScroll:function(e,t){var n=-this.sizing.wheelDelta(e,t)*this.scrollable.options.wheelSpeed;if(n!=0)return this.scrollOverviewBy(n)},mouseClickScroll:function(e){var t=this.viewPortSize-20;e["page"+this.sizing.scrollAxis()]<this.$thumb.offset()[this.sizing.offsetComponent()]&&(t=-t),this.scrollOverviewBy(t)},keyScroll:function(e){var t=e.which;if(this.enabled&&this.isKeyScrolling(t)){var n=this.scrollOverviewBy(this.keyScrollDelta(t));this.stopEventConditionally(e,n)}},scrollThumbBy:function(e){var t=this.thumbPosition();t+=e,t=this.positionOrMax(t,this.maxThumbPosition);var n=this.scrollPercent;this.scrollPercent=t/this.maxThumbPosition;if(n!=this.scrollPercent){var r=t*this.maxOverviewPosition/this.maxThumbPosition;return this.setScrollPosition(r,t),this.triggerCustomScroll(n),!0}return!1},thumbPosition:function(){return this.$thumb.position()[this.sizing.offsetComponent()]},scrollOverviewBy:function(e){var t=this.overviewPosition()+e;return this.scrollOverviewTo(t,!1)},overviewPosition:function(){return-this.scrollable.$overview.position()[this.sizing.offsetComponent()]},scrollOverviewTo:function(e,t){e=this.positionOrMax(e,this.maxOverviewPosition);var n=this.scrollPercent;this.scrollPercent=e/this.maxOverviewPosition;if(n!=this.scrollPercent){var r=this.scrollPercent*this.maxThumbPosition;return t?this.setScrollPositionWithAnimation(e,r):this.setScrollPosition(e,r),this.triggerCustomScroll(n),!0}return!1},positionOrMax:function(e,t){return e<0?0:e>t?t:e},triggerCustomScroll:function(e){this.scrollable.$element.trigger("customScroll",{scrollAxis:this.sizing.scrollAxis(),direction:this.sizing.scrollDirection(e,this.scrollPercent),scrollPercent:this.scrollPercent*100})},rescroll:function(e){if(e){var t=this.positionOrMax(this.overviewPosition(),this.maxOverviewPosition);this.scrollPercent=t/this.maxOverviewPosition;var n=this.scrollPercent*this.maxThumbPosition;this.setScrollPosition(t,n)}else{var n=this.scrollPercent*this.maxThumbPosition,t=this.scrollPercent*this.maxOverviewPosition;this.setScrollPosition(t,n)}},setScrollPosition:function(e,t){this.$thumb.css(this.sizing.offsetComponent(),t+"px"),this.scrollable.$overview.css(this.sizing.offsetComponent(),-e+"px")},setScrollPositionWithAnimation:function(e,t){var n={},r={};n[this.sizing.offsetComponent()]=t+"px",this.$thumb.animate(n,this.scrollable.options.animationSpeed),r[this.sizing.offsetComponent()]=-e+"px",this.scrollable.$overview.animate(r,this.scrollable.options.animationSpeed)},calculateMaxThumbPosition:function(){return Math.max(0,this.sizing.size(this.$scrollBar)-this.thumbSize)},calculateMaxOverviewPosition:function(){return Math.max(0,this.sizing.size(this.scrollable.$overview)-this.sizing.size(this.scrollable.$viewPort))},setScrollEvent:function(e){var t="page"+this.sizing.scrollAxis();if(!this.scrollEvent||this.scrollEvent[t]!=e[t])this.scrollEvent={pageX:e.pageX,pageY:e.pageY}},scrollToElement:function(t){var n=e(t);if(this.sizing.isInside(n,this.scrollable.$overview)){var r=n.offset(),i=this.scrollable.$overview.offset();this.scrollOverviewTo(r[this.sizing.offsetComponent()]-i[this.sizing.offsetComponent()],!0)}},remove:function(){this.removeMouseMoveScrolling(),this.removeMouseWheelScrolling(),this.removeTouchScrolling(),this.removeMouseClickScrolling(),this.removeWindowResize()},stopEventConditionally:function(e,t){if(t||this.scrollable.options.preventDefaultScroll)e.preventDefault(),e.stopPropagation()}};var o=function(){};o.prototype={size:function(e,t){return t?e.width(t):e.width()},minSize:function(e){return parseInt(e.css("min-width"))||0},maxSize:function(e){return parseInt(e.css("max-width"))||0},fixedThumbSize:function(e){return e.fixedThumbWidth},scrollBar:function(e){return e.find(".scroll-bar.horizontal")},mouseDelta:function(e,t){return t.pageX-e.pageX},offsetComponent:function(){return"left"},wheelDelta:function(e,t){return e},scrollAxis:function(){return"X"},scrollDirection:function(e,t){return e<t?"right":"left"},scrollingKeys:{37:function(e){return-10},39:function(e){return 10}},isInside:function(t,n){var r=e(t),i=e(n),s=r.offset(),o=i.offset();return s.left>=o.left&&s.left+r.width()<=o.left+i.width()}};var u=function(){};return u.prototype={size:function(e,t){return t?e.height(t):e.height()},minSize:function(e){return parseInt(e.css("min-height"))||0},maxSize:function(e){return parseInt(e.css("max-height"))||0},fixedThumbSize:function(e){return e.fixedThumbHeight},scrollBar:function(e){return e.find(".scroll-bar.vertical")},mouseDelta:function(e,t){return t.pageY-e.pageY},offsetComponent:function(){return"top"},wheelDelta:function(e,t){return t},scrollAxis:function(){return"Y"},scrollDirection:function(e,t){return e<t?"down":"up"},scrollingKeys:{38:function(e){return-10},40:function(e){return 10},33:function(e){return-(e-20)},34:function(e){return e-20}},isInside:function(t,n){var r=e(t),i=e(n),s=r.offset(),o=i.offset();return s.top>=o.top&&s.top+r.height()<=o.top+i.height()}},this.each(function(){t==undefined&&(t=r);if(typeof t=="string"){var s=e(this).data("scrollable");s&&s[t](n)}else{if(typeof t!="object")throw"Invalid type of options";t=e.extend(r,t),new i(e(this),t)}})}})(jQuery),function(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var t=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=t.length;n;)e.event.fixHooks[t[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery)}),define("topic/detail",["../p-data","text!../../tpl/topic/detail.tpl","root-common/util","root-base/model/topicModel","./topicRec","root-common/module/scrollbar"],function(e,t,n,r,i){var s="get.topicId",o="get.totalScore",u="init.topic",a=Backbone.View.extend({initialize:function(){var e=this;e._topicTpl=doT.template(t),e._topicId=null,e._topicRec=null,e._topicModel=new r,e.isLoad=!1,e._topicModel.bind({change:$.proxy(e.renderTopic,e),error:$.proxy(e.renderTopic,e)})},events:{},init:function(){this.loadTopic()},loadTopic:function(){this._topicModel.fetch({type:"get",cache:!1,headers:{token:window.token}})},reset:function(){this.isLoad=!1,this._topicRec&&this._topicRec.hide()},renderTopic:function(){var e=this,t=e._topicModel.toJSON()||{};e.isLoad=!0,n.dealAjax(function(n){n||(t=t.data,e._renderTopic(t))},t,arguments[1])},_renderTopic:function(t){var n=this;n._topicId=t.id,e.topicId=t.id,n.trigger(o,t.score),n.trigger(s,n._topicId),n.$el.html(n._topicTpl(t)),n._topicRec=new i({el:$(".topics-area"),btn:$(".icon-list .icon-linear")}),n._topicRec.bind({"init.topic":function(e){n._renderTopic(e),n.trigger(u,e)}}),setTimeout(function(){$(".demand .desc",n.$el).customScrollbar({updateOnWindowResize:!0,hScroll:!1})},300)},updateScollbar:function(){$(".demand .desc",this.$el).customScrollbar("resize")}});return a}),define("text!../tpl/article.tpl",[],function(){return'<a href="javascript:;" class="ui-btn icon-solid icon-clear">&#xe60c;</a>\r\n<div class="total-result">\r\n    <div class="time">\r\n        <p class="keyword">写作时间</p>\r\n        <p class="time-calculated">00分00秒</p>\r\n    </div>\r\n    <div class="words">\r\n        <p class="keyword">字数统计</p>\r\n        <p><span class="words-calculated">0</span> words</p>\r\n    </div>\r\n</div>\r\n<div class="btns-action">\r\n    <a href="javascript:;" class="ui-btn btn-draft">存为草稿<i class="icon-solid">&#xe60d;</i></a>\r\n    <a href="javascript:;" class="ui-btn btn-submit">提交评分<i class="icon-solid">&#xe60d;</i></a>\r\n</div>\r\n<div class="main-text">\r\n    <textarea id="Editor" class="main-editor" name="content"></textarea>\r\n</div>'}),define("root-base/model/answerModel",[],function(){var e="score.status",t=Backbone.Model.extend({initialize:function(){this.url=window.serviceBase+"/answer"},score:function(t,n){var r=this,i=t.topicId;$.ajax({url:this.url+"/"+i,type:"post",headers:{token:window.token},data:t,dataType:"json"}).done(function(i){r.trigger(e,i,null,t,n)}).fail(function(){r.trigger(e,arguments)})}});return t.list=Backbone.Collection.extend({model:t}),t}),define("root-base/kindeditor",[],function(){KindEditor.basePath="/common/images/kindeditor/",KindEditor.lang({txtPaste:"格式化文本"}),KindEditor.plugin("txtPaste",function(e){var t=this,n="txtPaste";t.clickToolbar(n,function(){var e=t.lang(n+"."),r='<div style="padding:10px 20px;"><textarea class="ke-textarea" style="width:408px;height:260px;"></textarea></div>',i=t.createDialog({name:n,width:450,title:t.lang(n),body:r,yesBtn:{name:t.lang("yes"),click:function(e){var n=s.val();n=KindEditor.escape(n),n=n.replace(/ {2}/g," &nbsp;").replace(/([^\x00-\xff])/g,""),t.newlineTag=="p"?n=n.replace(/^/,"<p>").replace(/$/,"</p>").replace(/\n/g,"</p><p>"):n=n.replace(/\n/g,"<br />$&"),t.insertHtml(n).hideDialog().focus()}}}),s=KindEditor("textarea",i.div);s[0].focus()})}),KindEditor.options.minWidth=300,KindEditor.options.filterMode=!0,KindEditor.options.loadStyleMode=!1,KindEditor.options.wellFormatMode=!1,KindEditor.options.resizeType=0,KindEditor.options.allowImageUpload=!1,KindEditor.options.fullscreenShortcut=!1,KindEditor.options.pasteType=0,KindEditor.options.items=["txtPaste"],KindEditor.options.htmlTags={font:["id","class","color","size","face","style"],span:["id","class","style"],div:["id","class","align","style"],table:["id","class","border","cellspacing","cellpadding","width","height","align","bordercolor","style"],"td,th":["id","class","align","valign","width","height","colspan","rowspan","bgcolor","style"],a:["id","class","href","target","name"],embed:["id","class","src","width","height","type","loop","autostart","quality","align","allowscriptaccess","style"],img:["id","class","src","width","height","border","alt","title","align","_tedio","style"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["id","class","align","style"],"pre,hr,br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":["id","class","style"],tedio:["title","cid"]}}),define("article",["./p-data","text!../tpl/article.tpl","root-common/util","root-base/model/topicModel","root-base/model/answerModel","root-common/module/tip","root-base/kindeditor","root-common/module/scrollbar"],function(e,t,n,r,i){var s="answer.status",o="score",u="score.exception",a=Backbone.View.extend({initialize:function(){var e=this;e.isLoad=!1,e._tpl=doT.template(t),e._topicId=null,e.editor=null,e.editorDoc=null,e.startTime=+(new Date),e.corrections=[],e._totalTime=null,e._totalWords=0,e._timer=null,e._checkErrorTimer=null,e._answerModel=new i,e._loadingTip=null,e._autoSaveTimer=null,e.render(),e._answerModel.bind({change:$.proxy(e.renderAnswer,e),error:$.proxy(e.renderAnswer,e),"score.status":$.proxy(e._showResult,e)})},events:{"click .btn-draft":"_draft","click .btn-submit":"_save"},renderAnswer:function(){var e=this,t=e._answerModel.toJSON();e.isLoad=!0,n.dealAjax(function(n){if(!n){var r=t.data;e.trigger(s,parseInt(r.answerStatus),e._topicId),e.startTime=+(new Date)-(r.costTime||0)*1e3,r.answerStatus==2&&(e.startTime=+(new Date)),e._calculateTime(),e.initEditor()}},t,arguments[1])},render:function(){this.$el.html(this._tpl({}))},reset:function(){this.isLoad=!1},loadAnswer:function(e){var t=this;t._topicId=e,t._answerModel.fetch({type:"get",cache:!1,headers:{token:window.token}})},initEditor:function(e,t,r){var i=this;i.setMainHeight();if(t)i.editor&&i._hightLightErrors(30);else if(r)e&&i.editor&&(e=e.replace(/\&nbsp;/g," "),i.editor.html(e),i._hightLightErrors(30));else{var s=i._answerModel.toJSON();$.isEmptyObject(s)||(e=s.data&&s.data.answerContent||""),e=e&&e.replace(/\&nbsp;/g," ");var o=$(".main-text").height(),u=$(".main-editor",i.$el).html(e);KindEditor.remove(u),i.editor=KindEditor.create(u,{width:"100%",height:o,afterChange:function(e){i._calculateWords(),i.autoSave()}}),i.editorDoc=i.editor.cmd.doc,i.editor.html(e),KindEditor.ctrl(i.editorDoc.body,"V",function(){n.tip("请通过右上角格式化文本按钮进行粘贴操作",!0)}),i._calculateWords(),i._addCss(i.editorDoc,window.staticsRoot+"/writing/student/css/editor.css?t="+ +(new Date)),e||i.editor.focus()}},setCorrection:function(e){this.corrections=e},_replaceAll:function(e,t,n){var r=0;while(e.indexOf(t)>=0){if(r>100)break;e=e.replace(t,function(){return n(arguments)}),r++}return e},_hightLightErrors:function(e){var t=this;e=e||3e3;if(!t.editor||!t.corrections)return;t._checkErrorTimer&&clearTimeout(t._checkErrorTimer),t._checkErrorTimer=setTimeout(function(){var e=$(t.editorDoc.body),r=e.html(),i=t.corrections||[];r=r.replace(/\<span\s*class="text-error"[^\>]*\>(.*?)\<\/span\>/g,"$1"),$.each(i,function(e,i){i.errors&&$.type(i.errors)=="array"&&i.errors.length>0&&(r=t._replaceAll(r,i.sentence,function(){var e=i.sentence,t=0,r=e.length;return i.errors.sort(function(e,t){return e.index-t.index}),i.errors=n.unique(i.errors,"index"),$.each(i.errors,function(i,s){var o='<span class="text-error" title="'+s.errorMsg+'">',u="</span>",a=s.errorContentPre.length+t,f=s.errorContentPre.length+s.errorContent.length+t+o.length;e=n.insertStr(e,o,a),e=n.insertStr(e,u,f),t=e.length-r}),e}))}),e.html(r),$(".text-error",e).tipsy({doc:t.editorDoc,gravity:$.fn.tipsy.autoNS})},e)},_addCss:function(e,t){var n=e.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.getElementsByTagName("head")[0].appendChild(n)},_calculateTime:function(){var e=this;e._timer&&clearInterval(e._timer),e._timer=setInterval(function(){var t=+(new Date)-e.startTime;e._setTime(t),e._totalTime=t},1e3)},_setTime:function(e){var t=this,r=n.formatTimeE(e);$(".time-calculated",t.$el).text(r)},_calculateWords:function(){var e=this,t=/\s+/g,n=/\<(p|br)\s*\/*\>/g;if(!e.editor)return;var r=e.editor.html(),i;r=r.replace(n," "),r=$("<div>"+r+"</div>").text(),r=$.trim(r);if(r){var s=1;while(i=t.exec(r))s++}else s=0;$(".words-calculated",e.$el).text(s),e._totalWords=s},_draft:function(e){e.preventDefault(),this.draft()},_save:function(e){e.preventDefault();var t=this;if(t.editor){var r=t.editor.html(),i=t._totalWords;r?i<40?n.errorTip("字数过少",!0):i>4e3?n.errorTip("字数过多",!0):(t._loadingTip=n.tip('正在提交评分，请稍后<i class="ajax-loader"></i>'),t._score(1)):n.errorTip("文章内容不能为空",!0)}},_score:function(e,t){var n=this;$(".tipsy",$(n.editorDoc.body)).remove();var r=n.editor.html();r=r.replace(/\<span\s*class="text-error"[^\>]*\>(.*?)\<\/span\>/g,"$1").replace(/\<span\s*style="white-space:normal;"[^\>]*\>(.*?)\<\/span\>/g,"$1"),this._answerModel.score({topicId:n._topicId,answerContent:r,costTime:Math.floor(n._totalTime/1e3),answerWords:n._totalWords,submitStatus:e},{isAuto:t})},_showResult:function(e,t,r,i){var s=this;n.dealAjax(function(t){s._loadingTip&&s._loadingTip.close(),t?r.submitStatus==1&&s.trigger(u,e):r&&(r.submitStatus==1?(n.successTip("提交成功"),s.startTime=+(new Date),s._calculateTime(),s.trigger(o)):(!i||!i.isAuto)&&n.successTip("保存草稿成功"),r.answerContent&&s.initEditor(r.answerContent,!1,!0))},e,t)},setMainHeight:function(){var e=this,t=$(".ui-topic").outerHeight()+$(".icon-list").outerHeight();e.$el.show().css({top:t}),e.editor&&e.editor.edit.setHeight($(".main-text").height())},getTopicId:function(){return this._topicId},autoSave:function(){var e=this;e._autoSaveTimer&&clearInterval(e._autoSaveTimer),e._autoSaveTimer=setInterval(function(){e.draft(!0)},6e4)},draft:function(e){var t=this;if(t.editor){var r=t.editor.html();if(!r){e||n.errorTip("文章内容不能为空",!0);return}e||(t._loadingTip=n.tip('正在保存为草稿，请稍后<i class="ajax-loader"></i>')),t._score(0,e)}}});return a}),define("text!../tpl/exception.tpl",[],function(){return'<div class="inner">\r\n    <div class="hd"></div>\r\n    <div class="txt">\r\n        <div class="quote-start"></div>\r\n        <div>\r\n        	{{~it.list :val:key}}\r\n        	<p>\r\n        		<span class="title"><i>文</i>本：</span>{{=val.content}}<br />\r\n        		<span class="title">异常信息：</span>{{=val.message}}\r\n        	</p>\r\n        	{{~}}\r\n        </div>\r\n        <div class="quote-end"></div>\r\n    </div>\r\n    <a href="javascript:;" class="btn-back-writing">\r\n        <i></i>\r\n    </a>\r\n</div>'}),define("exception",["text!../tpl/exception.tpl"],function(e){var t=Backbone.View.extend({initialize:function(){var t=this;t._tpl=doT.template(e)},events:{"click .btn-back-writing":"clear"},render:function(e){var t=this;try{var n=e.data,r=e.resMsg;t.$el.html(t._tpl({msg:r,list:n||[]}))}catch(i){}},clear:function(){this.$el.html("")}});return t}),define("root-base/model/historyModel",["./ajax"],function(e){var t="find.articleList",n="find.topic",r="find.article",i="find.article.to.edit",s="find.errors",o=Backbone.Model.extend({initialize:function(){this.url=window.serviceBase+"/history"},findAricleList:function(n){n=$.extend(!0,{},n),e.request.call(this,n,t)},findTopic:function(t){t=$.extend(!0,{},t),e.request.call(this,t,n)},findArticle:function(t){t=$.extend(!0,{},t),e.request.call(this,t,r)},findArticleToEdit:function(t){t=$.extend(!0,{},t),e.request.call(this,t,i)},findErrors:function(t){t=$.extend(!0,{},t),e.request.call(this,t,s)}});return o.list=Backbone.Collection.extend({model:o,initialize:function(){}}),o}),define("text!nav/../../tpl/history/main.tpl",[],function(){return'<div class="ui-history">\r\n	<div class="search">\r\n		<input class="search-text" type="text" placeholder="请输入你想查找的关键词">\r\n		<img class="search-icon" src="../../writing/images/zoom.png" height="24" width="24" />\r\n	</div>\r\n	<div class="list default-skin">\r\n		<ul class="list-box">\r\n			\r\n		</ul>\r\n		<div class="topic-pagi"></div>\r\n	</div>\r\n</div>\r\n<div class="history-article"></div>'}),define("text!nav/../../tpl/history/mainList.tpl",[],function(){return'{{~it.data.recordList :v:i}}\r\n<li class="list-li" data-id="{{=v.id}}">\r\n	<a href="#history/{{=v.id}}">{{=(i+1+it.num*(it.data.pageNum-1))}}.{{=v.topicName}}</a>\r\n</li>\r\n{{~}}\r\n'}),define("text!nav/../../tpl/history/article.tpl",[],function(){return'<div class="content default-skin">\r\n	<div class="back">\r\n		<a href="#history">\r\n			<i class="icon-linear">&#xe802;</i>\r\n			<span>作文列表</span>\r\n		</a>\r\n		\r\n	</div>\r\n	<div class="topic-detail title">\r\n		\r\n	</div>\r\n	<p class="sanjiao"></p>\r\n	<div class="article-area" data-topicid="{{=it.id}}">\r\n		\r\n	</div>\r\n\r\n	<div class="article-content">\r\n\r\n	</div>\r\n	\r\n</div>	'}),define("text!nav/../../tpl/history/topicDetail.tpl",[],function(){return'<p>/ 命题 /</p>\r\n<p class="inproduce">{{=it.topicName}}</p>\r\n<p>/ 命题要求 /</p>\r\n<p class="inproduce-demand">{{=it.topicDesc}}</p>\r\n<p class="other">（{{=it.minWord}}—{{=it.maxWord}}字，满分：{{=it.score}}分）</p>'}),define("text!nav/../../tpl/history/articleList.tpl",[],function(){return'<ul class="article-list">\r\n	{{~it.list :val:key}}\r\n	<li data-id="{{=val.id}}">\r\n		<p>\r\n			<span>修改保存于 {{=it.format(\'YYYY-MM-DD hh:mm:ss\', val.upTime)}} </span>\r\n			<span class="action-groups">\r\n				<a href="#history/{{=it.topicId}}/{{=val.id}}" class="icon-linear btn-preview" title="预览">&#xe801;</a>\r\n				<a href="javascript:;" class="icon-linear btn-edit" title="编辑">&#xe60c;</a>\r\n			</span>\r\n		</p>\r\n	</li>\r\n	{{~}}\r\n</ul>	'}),define("text!nav/../../tpl/history/articleDetail.tpl",[],function(){return'<div class="detail-inner">\r\n		<p class="time"> \r\n		<span>修改保存于 {{=it.format(\'YYYY-MM-DD hh:mm:ss\', it.res.upTime)}}  <i class="score-area">得分：<i class="score-num"></i>分</i>  </span>\r\n		<a class="go-topic" href="#history/{{=it.topicId}}">\r\n			<i class="icon-linear">&#xe800;</i>\r\n		</a>\r\n	</p>\r\n	<div class="article-main">\r\n		<h2>{{=it.topic.topicName}}</h2>\r\n		<div class="main">\r\n			{{=it.res.answerContent}}\r\n		</div>\r\n	</div>\r\n</div>'}),define("errors",["root-common/util","root-common/module/tip"],function(e){var t=Backbone.View.extend({initialize:function(t){var n=this;try{var r=t.res.sentenceList,i=$(".main",n.$el),s=i.html();s=s.replace(/\<span\s*class="text-error"[^\>]*\>(.*?)\<\/span\>/g,"$1"),$.each(r,function(t,r){r.errors&&$.type(r.errors)=="array"&&r.errors.length>0&&(s=n._replaceAll(s,r.sentence,function(){var t=r.sentence,n=0,i=t.length;return r.errors.sort(function(e,t){return e.index-t.index}),r.errors=e.unique(r.errors,"index"),$.each(r.errors,function(r,s){var o='<span class="text-error" title="'+s.errorMsg+'">',u="</span>",a=s.errorContentPre.length+n,f=s.errorContentPre.length+s.errorContent.length+n+o.length;t=e.insertStr(t,o,a),t=e.insertStr(t,u,f),n=t.length-i}),t}))}),i.html(s),$(".text-error",i).tipsy({gravity:$.fn.tipsy.autoNS})}catch(o){}},_replaceAll:function(e,t,n){var r=0;while(e.indexOf(t)>=0){if(r>100)break;e=e.replace(t,function(){return n(arguments)}),r++}return e}});return t}),define("nav/history",["root-base/model/historyModel","root-common/util","text!../../tpl/history/main.tpl","text!../../tpl/history/mainList.tpl","text!../../tpl/history/article.tpl","text!../../tpl/history/topicDetail.tpl","text!../../tpl/history/articleList.tpl","text!../../tpl/history/articleDetail.tpl","root-base/model/answerModel","root-common/module/pagination","../errors","root-common/module/scrollbar"],function(e,t,n,r,i,s,o,u,a,f,l){var c="edit",h=Backbone.View.extend({initialize:function(t){var f=this;f._mainTpl=doT.template(n),f._mainListTpl=doT.template(r),f._articleTpl=doT.template(i),f._topicDetailTpl=doT.template(s),f._articleListTpl=doT.template(o),f._articleDetailTpl=doT.template(u),f.$btn=$(t.btn),f._HistoryModel=new e,f._pageNum=20,f._topic=null,f._answerModel=new a,f.reset(),f._HistoryModel.bind({sync:$.proxy(f.renderHistory,f),"find.articleList":$.proxy(f.renderArticleList,f),"find.topic":$.proxy(f.renderTopic,f),"find.article":$.proxy(f.renderArticle,f),"find.article.to.edit":$.proxy(f._draftToEdit,f),"find.errors":$.proxy(f._showErrors,f)}),f._answerModel.bind({"score.status":$.proxy(f.edit,f)})},events:{"click .search-icon":"_search","keydown .search-text":"_keySearch","click .btn-edit":"_edit"},render:function(){var e=this;this.$el.html(e._mainTpl({})).show()},init:function(){var e=this;e.reset(),e.render(),e.resetUI(),e.search()},reset:function(){var e=this;e._page=null,e._isArticle=!1},renderHistory:function(e,n,r){var i=this,e=i._HistoryModel.toJSON()||{};t.dealAjax(function(t){if(!t){var n=e.data,s=r&&r.data&&r.data.keyword;$(".list-box",i.$el).html(i._mainListTpl({data:n,num:i._pageNum})),i._page||(i._page=new f({el:$(".topic-pagi",i.$el),total:n.pageSum}),i._page.bind("toggle",function(e){i.search({pageIndex:e})})),s!==undefined&&(i._page.current(1),i._page.total(n.pageSum),i._page.render()),i._initScrollbar()}},e,arguments[1])},renderArticleList:function(e,n){var r=this;t.dealAjax(function(n){if(!n){var i=e.data;$(".article-content",r.$el).html(""),$(".article-area",r.$el).html(r._articleListTpl({list:i.recordList,format:t.formatDate,topicId:$(".article-area",r.$el).data("topicid")})),$(".history-article .content",r.$el).customScrollbar("resize")}},e,arguments[1])},renderArticle:function(e,n){var r=this;t.dealAjax(function(n){if(!n){var i=e.data,s=$(".article-area",r.$el).data("topicid");$(".article-area",r.$el).html(""),$(".article-content",r.$el).html(r._articleDetailTpl({res:i,format:t.formatDate,topic:r._topic||{},topicId:s})),$(".history-article .content",r.$el).customScrollbar("resize"),r._HistoryModel.findErrors({url:window.serviceBase+"/history/correction/"+i.id})}},e,arguments[1])},renderTopic:function(e,n){var r=this;t.dealAjax(function(t){if(!t){var n=e.data;r._topic=n,$(".ui-history",r.$el).hide(),$(".history-article",r.$el).show(),$(".topic-detail",r.$el).html(r._topicDetailTpl(n)),$(".history-article .content",r.$el).customScrollbar("resize"),r._isArticle&&$(".article-main h2",r.$el).html(n.topicName)}},e,arguments[1])},_search:function(e){e.preventDefault();var t=$.trim($(".search-text",this.$el).val());this.search({keyword:t})},search:function(e){var t=this;e=e||{};var n=e.pageIndex||0,r=e.keyword,i={keyword:r,pageNum:n,pageSize:t._pageNum};r===undefined&&delete i.keyword,t._HistoryModel.fetch({data:i,cache:!1,headers:{token:window.token}})},_keySearch:function(e){var t=this,n;window.event?n=e.keyCode:e.which&&(n=e.which),(n==13||e.keycode==108)&&t._search()},initTopic:function(e){var t=this;$(".history-article",t.$el).html(t._articleTpl({id:e})),t._HistoryModel.findAricleList({url:window.serviceBase+"/history/"+e}),t._HistoryModel.findTopic({url:window.serviceBase+"/topic/"+e}),setTimeout(function(){$(".history-article .content",t.$el).customScrollbar({updateOnWindowResize:!0,hScroll:!1})},100)},initArticle:function(e,t){var n=this;n._isArticle=!0,$(".history-article",n.$el).html(n._articleTpl({id:e})),n._HistoryModel.findTopic({url:window.serviceBase+"/topic/"+e}),n._HistoryModel.findArticle({url:window.serviceBase+"/history/"+e+"/"+t}),setTimeout(function(){$(".history-article .content",n.$el).customScrollbar({updateOnWindowResize:!0,hScroll:!1})},100)},resetUI:function(){$(".ui-history",this.$el).show(),$(".history-article",this.$el).hide()},_initScrollbar:function(){var e=this;$(".ui-history > .list",e.$el).customScrollbar({updateOnWindowResize:!0,hScroll:!1})},_edit:function(e){e.preventDefault();var t=this,n=$(e.target).closest("li"),r=$(".article-area",t.$el),i=r.data("topicid"),s=n.data("id");t._HistoryModel.findArticleToEdit({url:window.serviceBase+"/history/"+i+"/"+s})},_draftToEdit:function(e,n){var r=this;t.dealAjax(function(t){if(!t){var n=e.data,i=$(".article-area",r.$el).data("topicid");r._answerModel.score({topicId:i,answerContent:n.answerContent,costTime:0,answerWords:n.answerWords,submitStatus:0})}},e,arguments[1])},edit:function(e,n){var r=this;t.dealAjax(function(t){if(!t){var n=$(".article-area",r.$el).data("topicid"),i=e.data;r.trigger(c,n)}},e,arguments[1])},_showErrors:function(e,n){var r=this;t.dealAjax(function(t){if(!t){var n=e.data,i=$(".article-main",r.$el);n.overall||$(".score-area",r.$el).hide(),$(".article-content .score-num",r.$el).text(n.overall),new l({res:n,el:i})}},e,arguments[1])}});return h}),define("root-base/auto-domain",[],function(){var e="online",t=location.hostname,n=location.host,r="127.0.0.1",i="192.168.12.240",s="8086",o="http://",u=/localhost|debug.|127.0/;u.test(t)&&(e="dev"),t===i&&(e="test"),t==="www.lyced.com"&&(e="lyced"),t==="139.196.194.97"&&(evn="aliyun");try{e=="dev"?(window.staticsRoot=o+n+"/dist",window.serviceBase=o+i+":"+s+"/quickWriting"):e=="test"?(window.staticsRoot=o+n+"/ui",window.serviceBase=o+t+":"+s+"/quickWriting"):e=="lyced"?(window.staticsRoot=o+t+"/ui",window.serviceBase=o+t+"/quickWriting"):e=="aliyun"?(window.staticsRoot=o+"www.lyced.com"+"/ui",window.serviceBase=o+t+"/quickWriting"):(window.staticsRoot=o+t+"/ui",window.serviceBase=o+t+"/quickWriting")}catch(a){alert("自适应域名脚本执行错误!\n")}}),require.config(window.requireConfig),require(["root-base/router","root-common/util","./container","./p-data","./nav/score","./topic/detail","./article","./exception","./nav/history","root-base/model/correctionModel","root-base/auto-domain"],function(e,t,n,r,i,s,o,u,a,f){function p(){window.location.href="#",h="Score",d(),S()}function d(){v(h);try{w.clear()}catch(e){}}function v(e,t){e=="Score"&&!c&&!t?(container.hidePanel(),container.hidePanelIcon()):container.showPanel(),$(".left-panel .panel-item").hide(),$("#"+e).show(),$(".ui-navs .active").removeClass("active"),$("#"+e+"Btn").parent().addClass("active")}function S(){m.isLoad||m.init(),y.isLoad||y.init()}function x(e){E.fetch({url:E.url+"/"+e,cache:!1,headers:{token:window.token}})}var l=new e,c=0,h="";window.container=new n({el:".p-writing"}),$.extend($.ajaxSettings,{timeout:3e4}),$.support.cors=!0,$.browser.msie&&($.browser.version==6||$.browser.version==7)&&alert("请升级您的浏览器，由于版本太低可能无法正常显示！"),window.token=t.queryString("token")||111111,token||t.errorTip("token未获取，页面数据显示异常!"),l.bind({gotoHome:function(){p()},gotoHistory:function(){h="History",d(),S(),b.init()},gotoTopicHistory:function(e){h="History",d(),S(),b.init(),b.initTopic(e)},gotoArticleDetail:function(e,t){h="History",d(),S(),b.init(),b.initArticle(e,t)}});var m=new s({el:"#TopicDetail"}),g=new o({el:"#Article"}),y=new i({el:"#Score"}),b=new a({el:"#History",btn:"#HistoryBtn"}),w=new u({el:"#Exception"}),E=new f;m.bind({"get.topicId":function(e){g.loadAnswer(e)},"get.totalScore":function(e){y.setTotalScore(e)},"init.topic":function(e){try{y.setTopicId(e.topicId),container.hidePanelIcon(),container.hidePanel()}catch(t){}}}),g.bind({"answer.status":function(e,t){switch(e){case 0:case 1:y.setTopicId(t),h=="Score"&&container.hidePanelIcon(),c=0;break;case 2:case 3:container.showPanel(),c=1,y.loadScore(t),x(t)}},score:function(){var e=this.getTopicId();c=1,p(),y.loadScore(),x(e),w.clear()},"score.exception":function(e){w.render(e)}}),b.bind({edit:function(e){m.reset(),y.reset(),p()}}),E.bind({change:function(){var e=this,n=this.toJSON();t.dealAjax(function(e){if(!e){var t=n.data;g.setCorrection(t.sentenceList),g.initEditor(null,!0),y.renderCorrection(t.sentenceList);var r=!1;$.each(t.sentenceList||[],function(e,t){if(t.errors&&t.errors.length>0)return r=!0,!1}),r?y.hideSuggestion():y.loadSuggestion()}},n,arguments[1])}}),container.bind({show:function(){m.updateScollbar(),g.setMainHeight(),y.clientHeight()},hide:function(){m.updateScollbar(),g.setMainHeight(),y.clientHeight()}}),$(window).resize(function(){$(".ui-topic .demand .desc, .main-text").customScrollbar("resize"),g.setMainHeight(),y.clientHeight()}),$(window).bind("beforeunload",function(){return"当前处于写作状态"}),Backbone.history.start()}),define("main",function(){});